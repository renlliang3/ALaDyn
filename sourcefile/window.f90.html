<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A High-Accuracy PIC Code for the Maxwell-Vlasov Equations">
    
    <meta name="author" content="The ALaDyn Collaboration" >
    <link rel="icon" href="../favicon.png">

    <title>window.f90 &ndash; ALaDyn</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ALaDyn <small>3.0.1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/aladyn.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/aladyn.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>window.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.1% of total for source files.">271 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/window.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">window.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/window.html">window</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/window.f90.html#src">window.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~window.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilewindowf90EfferentGraph" width="641pt" height="341pt"
 viewBox="0.00 0.00 641.00 340.58" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~window.f90~~EfferentGraph" class="graph" transform="scale(.777 .777) rotate(0) translate(4 434.3404)">
<title>sourcefile~~window.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-434.3404 821,-434.3404 821,4 -4,4"/>
<!-- sourcefile~window.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~window.f90</title>
<polygon fill="none" stroke="#000000" points="817,-262.8213 745,-262.8213 745,-238.8213 817,-238.8213 817,-262.8213"/>
<text text-anchor="middle" x="781" y="-248.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">window.f90</text>
</g>
<!-- sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~mpi_field_interface.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/mpi_field_interface.f90.html" xlink:title="mpi_field_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="709,-322.8213 574,-322.8213 574,-298.8213 709,-298.8213 709,-322.8213"/>
<text text-anchor="middle" x="641.5" y="-308.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_field_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M756.544,-262.9175C742.7048,-269.624 725.0127,-277.9675 709,-284.8213 700.8635,-288.3038 692.0912,-291.8394 683.6497,-295.1349"/>
<polygon fill="#ff0000" stroke="#ff0000" points="682.3809,-291.8729 674.3112,-298.738 684.9007,-298.4037 682.3809,-291.8729"/>
</g>
<!-- sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~mpi_part_interface.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/mpi_part_interface.f90.html" xlink:title="mpi_part_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="708,-242.8213 575,-242.8213 575,-218.8213 708,-218.8213 708,-242.8213"/>
<text text-anchor="middle" x="641.5" y="-228.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_part_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.7122,-245.6187C736.4715,-244.4373 727.4142,-243.1387 718.1934,-241.8167"/>
<polygon fill="#ff0000" stroke="#ff0000" points="718.5501,-238.3322 708.1546,-240.3775 717.5566,-245.2613 718.5501,-238.3322"/>
</g>
<!-- sourcefile~common_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~common_param.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/common_param.f90.html" xlink:title="common_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="394,-85.8213 273,-85.8213 273,-61.8213 394,-61.8213 394,-85.8213"/>
<text text-anchor="middle" x="333.5" y="-71.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">common_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M771.5576,-238.7327C758.3156,-222.0712 733.1362,-191.4322 709,-167.8213 681.1353,-140.563 673.8194,-133.6137 641.5,-111.8213"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M641.5,-111.8213C588.7218,-76.2338 597.0768,-36.5263 538,-12.8213 497.5772,3.3987 479.788,4.8988 440,-12.8213 418.1513,-22.5518 424.2166,-40.0408 404,-52.8213 401.2473,-54.5614 398.3435,-56.1633 395.346,-57.6372"/>
<polygon fill="#ff0000" stroke="#ff0000" points="393.8782,-54.459 386.1298,-61.6849 396.6931,-60.8682 393.8782,-54.459"/>
</g>
<!-- sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~grid_param.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/grid_param.f90.html" xlink:title="grid_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="536,-319.8213 442,-319.8213 442,-295.8213 536,-295.8213 536,-319.8213"/>
<text text-anchor="middle" x="489" y="-305.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.6809,-257.4089C703.3099,-264.972 633.7056,-277.8766 574,-289.8213 564.9844,-291.6249 555.4432,-293.5901 546.1379,-295.5377"/>
<polygon fill="#ff0000" stroke="#ff0000" points="545.2341,-292.1511 536.1693,-297.6356 546.6758,-299.0011 545.2341,-292.1511"/>
</g>
<!-- sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~pstruct_data.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/pstruct_data.f90.html" xlink:title="pstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="383,-361.8213 284,-361.8213 284,-337.8213 383,-337.8213 383,-361.8213"/>
<text text-anchor="middle" x="333.5" y="-347.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M772.0194,-262.8563C738.5216,-306.1735 616.243,-450.4075 489,-427.8213"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M489,-427.8213C464.7539,-427.4027 460.032,-417.4876 440,-403.8213 422.0701,-391.589 422.882,-381.5255 404,-370.8213 400.3754,-368.7665 396.5296,-366.8943 392.5779,-365.1917"/>
<polygon fill="#ff0000" stroke="#ff0000" points="393.8067,-361.9141 383.2192,-361.5202 391.2502,-368.4306 393.8067,-361.9141"/>
</g>
<!-- sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~fstruct_data.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/fstruct_data.f90.html" xlink:title="fstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="381.5,-403.8213 285.5,-403.8213 285.5,-379.8213 381.5,-379.8213 381.5,-403.8213"/>
<text text-anchor="middle" x="333.5" y="-389.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M489,-427.8213C450.2489,-427.1522 407.4255,-416.4687 376.5462,-406.9129"/>
<polygon fill="#ff0000" stroke="#ff0000" points="377.551,-403.5598 366.9605,-403.8642 375.4293,-410.2305 377.551,-403.5598"/>
</g>
<!-- sourcefile~run_data_info.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~run_data_info.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/run_data_info.f90.html" xlink:title="run_data_info.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="694.5,-200.8213 588.5,-200.8213 588.5,-176.8213 694.5,-176.8213 694.5,-200.8213"/>
<text text-anchor="middle" x="641.5" y="-186.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">run_data_info.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~run_data_info.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~run_data_info.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M762.3279,-238.6969C748.123,-229.8468 727.8682,-218.0137 709,-209.8213 704.5217,-207.8768 699.8052,-206.0295 695.0327,-204.2962"/>
<polygon fill="#ff0000" stroke="#ff0000" points="695.811,-200.8622 685.2163,-200.9038 693.5246,-207.4782 695.811,-200.8622"/>
</g>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~util.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/util.f90.html" xlink:title="util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360.5,-127.8213 306.5,-127.8213 306.5,-103.8213 360.5,-103.8213 360.5,-127.8213"/>
<text text-anchor="middle" x="333.5" y="-113.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M641.5,-111.8213C597.9098,-83.4876 442.8582,-100.5015 370.8058,-110.323"/>
<polygon fill="#ff0000" stroke="#ff0000" points="370.2234,-106.8702 360.8005,-111.7136 371.1871,-113.8035 370.2234,-106.8702"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M573.7232,-309.4879C564.4756,-309.306 555.0598,-309.1208 546.0287,-308.9431"/>
<polygon fill="#ff0000" stroke="#ff0000" points="546.0923,-305.4438 536.0254,-308.7464 545.9546,-312.4425 546.0923,-305.4438"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M625.7721,-323.1061C599.3532,-342.7417 543.582,-379.9909 489,-389.8213"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M489,-389.8213C478.4281,-391.7253 424.2111,-376.8345 382.741,-364.6836"/>
<polygon fill="#ff0000" stroke="#ff0000" points="383.6236,-361.2949 373.042,-361.8241 381.644,-368.0092 383.6236,-361.2949"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M489,-389.8213C457.1498,-395.5576 421.0342,-396.3605 391.6305,-395.5924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="391.6374,-392.0908 381.5279,-395.2607 391.4077,-399.0871 391.6374,-392.0908"/>
</g>
<!-- sourcefile~parallel.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~parallel.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/parallel.f90.html" xlink:title="parallel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="527,-201.8213 451,-201.8213 451,-177.8213 527,-177.8213 527,-201.8213"/>
<text text-anchor="middle" x="489" y="-187.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M626.3202,-298.777C599.6252,-277.596 544.1099,-233.5478 512.4507,-208.428"/>
<polygon fill="#ff0000" stroke="#ff0000" points="514.5816,-205.6509 504.5725,-202.1771 510.2307,-211.1345 514.5816,-205.6509"/>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M605.4102,-242.8972C595.0429,-246.8505 583.8755,-251.5876 574,-256.8213 556.788,-265.9429 554.6332,-271.6825 538,-281.8213 532.9428,-284.9039 527.4875,-288.0059 522.1173,-290.9402"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="520.4115,-287.8833 513.2451,-295.6868 523.7136,-294.0555 520.4115,-287.8833"/>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M596.5698,-218.7417C577.7906,-213.6928 555.9438,-207.8193 536.8634,-202.6895"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="537.7344,-199.2994 527.1686,-200.083 535.917,-206.0594 537.7344,-199.2994"/>
</g>
<!-- sourcefile~code_util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~code_util.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/code_util.f90.html" xlink:title="code_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225,-165.8213 144,-165.8213 144,-141.8213 225,-141.8213 225,-165.8213"/>
<text text-anchor="middle" x="184.5" y="-151.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">code_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M574.9579,-230.4835C535.0978,-228.7488 483.821,-223.794 440,-210.8213 388.9187,-195.6992 386.4248,-161.8993 333.5,-155.8213"/>
</g>
<!-- sourcefile~array_alloc.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~array_alloc.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/array_alloc.f90.html" xlink:title="array_alloc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="535,-361.8213 443,-361.8213 443,-337.8213 535,-337.8213 535,-361.8213"/>
<text text-anchor="middle" x="489" y="-347.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">array_alloc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~array_alloc.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~array_alloc.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M626.6127,-243.044C612.6591,-254.6822 591.4,-272.8868 574,-289.8213 557.0954,-306.2736 557.2651,-315.2088 538,-328.8213 535.9166,-330.2934 533.7139,-331.6919 531.4416,-333.0156"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="529.6614,-329.9972 522.4381,-337.7481 532.9183,-336.1934 529.6614,-329.9972"/>
</g>
<!-- sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~precision_def.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/precision_def.f90.html" xlink:title="precision_def.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="106,-249.8213 0,-249.8213 0,-225.8213 106,-225.8213 106,-249.8213"/>
<text text-anchor="middle" x="53" y="-235.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision_def.F90</text>
</a>
</g>
</g>
<!-- sourcefile~common_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~common_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M293.3077,-61.8132C250.0561,-48.9913 187.0578,-30.6492 184.5,-31.8213"/>
</g>
<!-- sourcefile~grid_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~grid_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M441.814,-300.4328C411.0439,-296.3167 369.9725,-292.1416 333.5,-292.8213"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M333.5,-292.8213C249.4231,-294.388 153.7516,-269.7826 98.673,-252.9666"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="99.461,-249.5465 88.8729,-249.9254 97.3863,-256.232 99.461,-249.5465"/>
</g>
<!-- sourcefile~struct_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~struct_def.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/struct_def.f90.html" xlink:title="struct_def.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="227,-344.8213 142,-344.8213 142,-320.8213 227,-320.8213 227,-344.8213"/>
<text text-anchor="middle" x="184.5" y="-330.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">struct_def.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_param.f90&#45;&gt;sourcefile~struct_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~grid_param.f90&#45;&gt;sourcefile~struct_def.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M333.5,-292.8213C294.7641,-293.5431 252.2323,-306.2197 222.561,-317.1109"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="221.134,-313.9085 213.0157,-320.7162 223.6074,-320.457 221.134,-313.9085"/>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M289.3632,-361.8967C249.0374,-372.5057 194.2418,-385.6956 184.5,-381.8213"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M184.5,-381.8213C126.0895,-358.5913 83.2338,-293.3092 64.0955,-259.1939"/>
<polygon fill="#00ffff" stroke="#00ffff" points="66.985,-257.1814 59.1291,-250.0726 60.8372,-260.5288 66.985,-257.1814"/>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M283.8852,-344.1605C269.0279,-342.4654 252.6789,-340.6001 237.6064,-338.8804"/>
<polygon fill="#00ffff" stroke="#00ffff" points="237.7419,-335.3732 227.4096,-337.717 236.9483,-342.3281 237.7419,-335.3732"/>
</g>
<!-- sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M285.2138,-395.9483C255.2135,-396.7487 216.4205,-394.5161 184.5,-381.8213"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M489,-73.8213C462.7651,-63.0318 431.8692,-61.0995 404.5584,-62.5712"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="404.0151,-59.1006 394.284,-63.2905 404.504,-66.0835 404.0151,-59.1006"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M588.4395,-200.6507C583.2372,-203.1454 578.3019,-206.1655 574,-209.8213 546.7375,-232.9892 562.9904,-256.2189 538,-281.8213 534.85,-285.0484 531.2128,-287.9649 527.3721,-290.5765"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="525.4829,-287.6288 518.7491,-295.8085 529.1141,-293.6133 525.4829,-287.6288"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M596.1219,-200.8949C588.5845,-203.4764 580.9614,-206.4568 574,-209.8213 532.8224,-229.7225 528.4254,-244.6418 489,-267.8213"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M489,-267.8213C468.8646,-279.6595 461.0115,-276.6185 440,-286.8213 424.7879,-294.2079 388.0067,-316.3366 361.9394,-332.2811"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="359.914,-329.4174 353.2188,-337.6287 363.5733,-335.3848 359.914,-329.4174"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M489,-267.8213C468.8646,-279.6595 456.8027,-270.5963 440,-286.8213 410.7811,-315.0354 434.3292,-343.8043 404,-370.8213 400.1066,-374.2895 395.6618,-377.1856 390.9406,-379.6039"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="389.3539,-376.4777 381.5931,-383.6902 392.1578,-382.8916 389.3539,-376.4777"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M588.1629,-189.171C571.6757,-189.2791 553.6129,-189.3976 537.4733,-189.5034"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="537.1577,-186.0053 527.1809,-189.5709 537.2037,-193.0052 537.1577,-186.0053"/>
</g>
<!-- sourcefile~ionz_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~ionz_data.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/ionz_data.f90.html" xlink:title="ionz_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="226.5,-207.8213 142.5,-207.8213 142.5,-183.8213 226.5,-183.8213 226.5,-207.8213"/>
<text text-anchor="middle" x="184.5" y="-193.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ionz_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~ionz_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~ionz_data.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M489,-149.8213C450.2307,-148.0567 442.2201,-163.0835 404,-169.8213 347.2023,-179.8341 281.4404,-187.0515 236.8159,-191.3047"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="236.4167,-187.8267 226.7869,-192.2446 237.0699,-194.7962 236.4167,-187.8267"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M608.7506,-176.7664C578.2486,-166.4278 531.2568,-152.748 489,-149.8213"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M489,-149.8213C420.0028,-145.0424 402.2109,-163.7122 333.5,-155.8213"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M333.5,-155.8213C300.9957,-152.0884 264.2428,-151.5556 235.3718,-151.9722"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="235.0468,-148.4775 225.1142,-152.1644 235.1781,-155.4763 235.0468,-148.4775"/>
</g>
<!-- sourcefile~control_bunch_input.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~control_bunch_input.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/control_bunch_input.f90.html" xlink:title="control_bunch_input.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="404,-43.8213 263,-43.8213 263,-19.8213 404,-19.8213 404,-43.8213"/>
<text text-anchor="middle" x="333.5" y="-29.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">control_bunch_input.f90</text>
</a>
</g>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~control_bunch_input.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~control_bunch_input.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M629.8367,-176.5338C605.9822,-152.2667 548.8018,-98.4155 489,-73.8213"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M489,-73.8213C461.2446,-62.4065 429.432,-53.181 401.8419,-46.3154"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="402.4274,-42.8558 391.8835,-43.893 400.7728,-49.6575 402.4274,-42.8558"/>
</g>
<!-- sourcefile~phys_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~phys_param.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/phys_param.f90.html" xlink:title="phys_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="538,-45.8213 440,-45.8213 440,-21.8213 538,-21.8213 538,-45.8213"/>
<text text-anchor="middle" x="489" y="-31.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">phys_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~phys_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~phys_param.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M625.9428,-176.7659C611.316,-164.8984 589.4225,-145.709 574,-125.8213 553.5242,-99.417 561.7623,-83.3116 538,-59.8213 534.7533,-56.6117 531.0287,-53.6992 527.1146,-51.0839"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="528.7317,-47.9726 518.3551,-45.8331 525.1327,-53.9766 528.7317,-47.9726"/>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M306.4415,-110.3634C292.9119,-106.9965 276.5729,-101.9375 263,-94.8213 223.3802,-74.0486 225.1688,-13.1857 184.5,-31.8213"/>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M306.1711,-122.791C286.3229,-127.853 258.8861,-134.8503 235.09,-140.9191"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="233.9721,-137.5921 225.1472,-143.4549 235.702,-144.375 233.9721,-137.5921"/>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M459.3181,-177.7424C452.4205,-173.9915 445.4966,-169.3562 440,-163.8213 415.6265,-139.2778 430.6836,-116.831 404,-94.8213 402.4114,-93.5109 400.7431,-92.2823 399.0117,-91.1303"/>
<polygon fill="#ff0000" stroke="#ff0000" points="400.3313,-87.856 389.9028,-85.9857 396.8888,-93.9511 400.3313,-87.856"/>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M465.4136,-177.6766C457.301,-173.4017 448.1987,-168.4959 440,-163.8213 423.7106,-154.5336 420.8768,-149.9931 404,-141.8213 393.3924,-136.685 381.4915,-131.9358 370.5313,-127.9403"/>
<polygon fill="#ff0000" stroke="#ff0000" points="371.3891,-124.5311 360.7943,-124.4933 369.053,-131.1299 371.3891,-124.5311"/>
</g>
<!-- sourcefile~mpi_var.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~mpi_var.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/mpi_var.f90.html" xlink:title="mpi_var.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="222,-249.8213 147,-249.8213 147,-225.8213 222,-225.8213 222,-249.8213"/>
<text text-anchor="middle" x="184.5" y="-235.4213" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_var.f90</text>
</a>
</g>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~mpi_var.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~mpi_var.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M450.6096,-198.5707C436.0562,-201.7242 419.3068,-205.1582 404,-207.8213 345.1165,-218.0659 276.8409,-226.9272 232.2721,-232.3098"/>
<polygon fill="#ff0000" stroke="#ff0000" points="231.8172,-228.8392 222.3043,-233.5034 232.6495,-235.7896 231.8172,-228.8392"/>
</g>
<!-- sourcefile~ionz_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~ionz_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M146.8174,-207.8568C132.3737,-212.47 115.7054,-217.7937 100.4619,-222.6623"/>
<polygon fill="#7fff00" stroke="#7fff00" points="99.1492,-219.4073 90.6881,-225.784 101.279,-226.0755 99.1492,-219.4073"/>
</g>
<!-- sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M158.5332,-165.8439C152.9899,-168.6333 147.2316,-171.7033 142,-174.8213 118.9413,-188.5638 94.1217,-206.4108 76.5662,-219.5992"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="74.4252,-216.8302 68.5712,-225.6609 78.6544,-222.4083 74.4252,-216.8302"/>
</g>
<!-- sourcefile~array_alloc.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~array_alloc.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M442.7659,-349.8213C427.1968,-349.8213 409.5982,-349.8213 393.145,-349.8213"/>
<polygon fill="#00ffff" stroke="#00ffff" points="393.0769,-346.3214 383.0769,-349.8213 393.0769,-353.3214 393.0769,-346.3214"/>
</g>
<!-- sourcefile~array_alloc.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~array_alloc.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M444.4399,-361.8568C426.7908,-366.6237 406.3328,-372.1494 387.8273,-377.1476"/>
<polygon fill="#00ffff" stroke="#00ffff" points="386.808,-373.7975 378.0666,-379.784 388.6333,-380.5553 386.808,-373.7975"/>
</g>
<!-- sourcefile~control_bunch_input.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~control_bunch_input.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M262.6541,-19.8885C237.0135,-18.5971 208.487,-20.8298 184.5,-31.8213"/>
</g>
<!-- sourcefile~phys_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~phys_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M452.614,-21.7067C437.7248,-17.348 420.2152,-12.9763 404,-10.8213 306.8532,2.09 273.5929,9.0035 184.5,-31.8213"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M184.5,-31.8213C107.8639,-65.8803 71.1777,-170.1467 58.436,-215.9048"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="55.0147,-215.1517 55.825,-225.7155 61.7792,-216.9521 55.0147,-215.1517"/>
</g>
<!-- sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M163.4551,-320.5764C156.5182,-316.3747 148.8333,-311.539 142,-306.8213 118.7714,-290.7842 93.436,-270.8899 75.7581,-256.5898"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="77.7026,-253.6596 67.7378,-250.0605 73.2833,-259.0882 77.7026,-253.6596"/>
</g>
<!-- sourcefile~mpi_var.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~mpi_var.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M146.8174,-237.8213C137.3685,-237.8213 126.9676,-237.8213 116.6363,-237.8213"/>
<polygon fill="#ff0000" stroke="#ff0000" points="116.3661,-234.3214 106.3661,-237.8213 116.3661,-241.3214 116.3661,-234.3214"/>
</g>
</g>
</svg>
</div><script>var pansourcefilewindowf90EfferentGraph = svgPanZoom('#sourcefilewindowf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~window.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilewindowf90AfferentGraph" width="365pt" height="74pt"
 viewBox="0.00 0.00 365.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~window.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>sourcefile~~window.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-70 361,-70 361,4 -4,4"/>
<!-- sourcefile~window.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~window.f90</title>
<polygon fill="none" stroke="#000000" points="72,-45 0,-45 0,-21 72,-21 72,-45"/>
<text text-anchor="middle" x="36" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">window.f90</text>
</g>
<!-- sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~env_evolve_in_time.f90</title>
<g id="a_sourcefile~~window.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/env_evolve_in_time.f90.html" xlink:title="env_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="245,-66 108,-66 108,-42 245,-42 245,-66"/>
<text text-anchor="middle" x="176.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">env_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M107.8964,-43.7461C99.1782,-42.443 90.4261,-41.1349 82.1778,-39.902"/>
<polygon fill="#ff0000" stroke="#ff0000" points="82.4472,-36.4035 72.0397,-38.3867 81.4124,-43.3266 82.4472,-36.4035"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~pic_evolve_in_time.f90</title>
<g id="a_sourcefile~~window.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/pic_evolve_in_time.f90.html" xlink:title="pic_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="243,-24 110,-24 110,0 243,0 243,-24"/>
<text text-anchor="middle" x="176.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M109.9531,-21.9465C100.5729,-23.3485 91.1044,-24.7638 82.2191,-26.0918"/>
<polygon fill="#ff0000" stroke="#ff0000" points="81.4694,-22.6649 72.0967,-27.6048 82.5042,-29.588 81.4694,-22.6649"/>
</g>
<!-- sourcefile~aladyn.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~aladyn.f90</title>
<g id="a_sourcefile~~window.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/aladyn.f90.html" xlink:title="ALaDyn.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="357,-45 281,-45 281,-21 357,-21 357,-45"/>
<text text-anchor="middle" x="319" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ALaDyn.F90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M280.8126,-38.6276C272.7861,-39.8105 264.0404,-41.0993 255.1391,-42.4111"/>
<polygon fill="#ff0000" stroke="#ff0000" points="254.4361,-38.9768 245.0533,-43.8974 255.4567,-45.902 254.4361,-38.9768"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M280.8126,-27.3724C272.1852,-26.101 262.7268,-24.7071 253.1375,-23.2939"/>
<polygon fill="#00ffff" stroke="#00ffff" points="253.5298,-19.814 243.1264,-21.8186 252.5092,-26.7392 253.5298,-19.814"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/window.html">window</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/window.f90.html#src">window.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-2"></a><span class="c">!                            Copyright 2008-2020  The ALaDyn Collaboration                            !</span>
<a name="ln-3"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-6"></a><span class="c">!  This file is part of ALaDyn.                                                                       !</span>
<a name="ln-7"></a><span class="c">!                                                                                                     !</span>
<a name="ln-8"></a><span class="c">!  ALaDyn is free software: you can redistribute it and/or modify                                     !</span>
<a name="ln-9"></a><span class="c">!  it under the terms of the GNU General Public License as published by                               !</span>
<a name="ln-10"></a><span class="c">!  the Free Software Foundation, either version 3 of the License, or                                  !</span>
<a name="ln-11"></a><span class="c">!  (at your option) any later version.                                                                !</span>
<a name="ln-12"></a><span class="c">!                                                                                                     !</span>
<a name="ln-13"></a><span class="c">!  ALaDyn is distributed in the hope that it will be useful,                                          !</span>
<a name="ln-14"></a><span class="c">!  but WITHOUT ANY WARRANTY; without even the implied warranty of                                     !</span>
<a name="ln-15"></a><span class="c">!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                      !</span>
<a name="ln-16"></a><span class="c">!  GNU General Public License for more details.                                                       !</span>
<a name="ln-17"></a><span class="c">!                                                                                                     !</span>
<a name="ln-18"></a><span class="c">!  You should have received a copy of the GNU General Public License                                  !</span>
<a name="ln-19"></a><span class="c">!  along with ALaDyn.  If not, see &lt;http://www.gnu.org/licenses/&gt;.                                    !</span>
<a name="ln-20"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-21"></a>
<a name="ln-22"></a> <span class="k">module </span><span class="n">window</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">util</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">init_random_seed</span><span class="p">,</span> <span class="n">gasdev</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">pstruct_data</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">fstruct_data</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">common_param</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">grid_param</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">mpi_field_interface</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">mpi_part_interface</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">run_data_info</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">part_numbers</span>
<a name="ln-31"></a>
<a name="ln-32"></a>  <span class="k">implicit none</span>
<a name="ln-33"></a>  <span class="c">!===============================</span>
<a name="ln-34"></a>  <span class="c">! MOVING WINDOW SECTION</span>
<a name="ln-35"></a>  <span class="c">!=============================</span>
<a name="ln-36"></a> <span class="k">contains</span>
<a name="ln-37"></a>
<a name="ln-38"></a><span class="k">  subroutine </span><span class="n">add_particles</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-39"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-40"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">j2</span><span class="p">,</span> <span class="n">k2</span>
<a name="ln-41"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">u</span><span class="p">,</span> <span class="n">tmp0</span><span class="p">,</span> <span class="n">whz</span>
<a name="ln-42"></a>
<a name="ln-43"></a>   <span class="n">tmp0</span> <span class="o">=</span> <span class="n">t0_pl</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-44"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">np</span>
<a name="ln-45"></a>   <span class="n">charge</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">unit_charge</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span> <span class="n">hp_int</span><span class="p">)</span>
<a name="ln-46"></a>   <span class="n">part_ind</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-47"></a>   <span class="n">k2</span> <span class="o">=</span> <span class="n">loc_nptz</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-48"></a>   <span class="n">j2</span> <span class="o">=</span> <span class="n">loc_npty</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-49"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">curr_ndim</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-50"></a><span class="k">    do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k2</span>
<a name="ln-51"></a>     <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-52"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-53"></a>       <span class="n">whz</span> <span class="o">=</span> <span class="n">wghpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span><span class="o">*</span><span class="n">loc_wghyz</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-54"></a>       <span class="n">wgh</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">whz</span><span class="p">,</span> <span class="n">sp</span><span class="p">)</span>
<a name="ln-55"></a>       <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-56"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-57"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_ypt</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-58"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_zpt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-59"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero_dp</span>
<a name="ln-60"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">wgh_cmp</span>
<a name="ln-61"></a>      <span class="k">end do</span>
<a name="ln-62"></a><span class="k">     end do</span>
<a name="ln-63"></a><span class="k">    end do</span>
<a name="ln-64"></a><span class="k">   else</span>
<a name="ln-65"></a><span class="k">    do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-66"></a>     <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-67"></a>      <span class="n">wgh</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">loc_wghyz</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">*</span><span class="n">wghpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span><span class="n">ic</span><span class="p">),</span> <span class="n">sp</span><span class="p">)</span>
<a name="ln-68"></a>      <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-69"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-70"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_ypt</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-71"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero_dp</span>
<a name="ln-72"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">wgh_cmp</span>
<a name="ln-73"></a>     <span class="k">end do</span>
<a name="ln-74"></a><span class="k">    end do</span>
<a name="ln-75"></a><span class="k">   end if</span>
<a name="ln-76"></a><span class="k">   if</span> <span class="p">(</span><span class="n">tmp0</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-77"></a><span class="k">    </span><span class="n">n</span> <span class="o">=</span> <span class="n">np</span>
<a name="ln-78"></a>    <span class="k">call </span><span class="n">init_random_seed</span><span class="p">(</span><span class="n">mype</span><span class="p">)</span>
<a name="ln-79"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">curr_ndim</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-80"></a><span class="k">     do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k2</span>
<a name="ln-81"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-82"></a>       <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-83"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-84"></a>        <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="ln-85"></a>        <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-86"></a>        <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-87"></a>        <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-88"></a>       <span class="k">end do</span>
<a name="ln-89"></a><span class="k">      end do</span>
<a name="ln-90"></a><span class="k">     end do</span>
<a name="ln-91"></a><span class="k">    else</span>
<a name="ln-92"></a><span class="k">     do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-93"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-94"></a>       <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-95"></a>       <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="ln-96"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-97"></a>       <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="ln-98"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-99"></a>      <span class="k">end do</span>
<a name="ln-100"></a><span class="k">     end do</span>
<a name="ln-101"></a><span class="k">    end if</span>
<a name="ln-102"></a><span class="k">   end if</span>
<a name="ln-103"></a><span class="k">  end subroutine</span>
<a name="ln-104"></a>  <span class="c">!---------------------------</span>
<a name="ln-105"></a>  <span class="k">subroutine </span><span class="n">particles_inject</span><span class="p">(</span><span class="n">xmx</span><span class="p">)</span>
<a name="ln-106"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xmx</span>
<a name="ln-107"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ic</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">npt_inj</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">np_old</span><span class="p">,</span> <span class="n">np_new</span>
<a name="ln-108"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span>
<a name="ln-109"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j2</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">ndv</span>
<a name="ln-110"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-111"></a>
<a name="ln-112"></a>   <span class="c">!========== inject particles from the right </span>
<a name="ln-113"></a>   <span class="c">!   xmx is the box xmax grid value at current time after window move</span>
<a name="ln-114"></a>   <span class="c">!   in Comoving frame xmax is fixed and particles are left advected</span>
<a name="ln-115"></a>   <span class="c">!=================================</span>
<a name="ln-116"></a>   <span class="c">!  nptx(ic) is the max particle index inside the computational box</span>
<a name="ln-117"></a>   <span class="c">!  nptx(ic) is updated in the same way both for moving window xmax</span>
<a name="ln-118"></a>   <span class="c">!  or for left-advect particles with fixed xmax</span>
<a name="ln-119"></a>   <span class="c">!===============================================</span>
<a name="ln-120"></a>
<a name="ln-121"></a>   <span class="n">ndv</span> <span class="o">=</span> <span class="n">nd2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-122"></a>   <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsp</span>
<a name="ln-123"></a>    <span class="n">i1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">nptx</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-124"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">i1</span><span class="o">&lt;=</span><span class="n">sptx_max</span><span class="p">(</span><span class="n">ic</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-125"></a>    <span class="c">!while particle index is less then the max index</span>
<a name="ln-126"></a>     <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">sptx_max</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-127"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">xpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">&gt;</span><span class="n">xmx</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-128"></a><span class="k">     end do</span>
<a name="ln-129"></a><span class="k">     </span><span class="n">i2</span> <span class="o">=</span> <span class="n">ix</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-130"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">ix</span><span class="o">==</span><span class="n">sptx_max</span><span class="p">(</span><span class="n">ic</span><span class="p">))</span> <span class="n">i2</span> <span class="o">=</span> <span class="n">ix</span>
<a name="ln-131"></a>    <span class="k">else</span>
<a name="ln-132"></a><span class="k">     </span><span class="n">i2</span> <span class="o">=</span> <span class="n">i1</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-133"></a>    <span class="k">end if</span>
<a name="ln-134"></a><span class="k">    </span><span class="n">nptx</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">i2</span>
<a name="ln-135"></a>    <span class="c">! endif</span>
<a name="ln-136"></a>    <span class="c">!==========================</span>
<a name="ln-137"></a>    <span class="c">! Partcles to be injected have index ix [i1,i2]</span>
<a name="ln-138"></a>    <span class="c">!============================</span>
<a name="ln-139"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">i2</span> <span class="o">&gt;</span> <span class="n">i1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-140"></a>     <span class="c">!==========================</span>
<a name="ln-141"></a>     <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-142"></a>     <span class="c">!=========== injects particles with coordinates index i1&lt;= ix &lt;=i2</span>
<a name="ln-143"></a>     <span class="k">select case</span> <span class="p">(</span><span class="n">ndim</span><span class="p">)</span>
<a name="ln-144"></a>     <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-145"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-146"></a>       <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-147"></a>      <span class="k">end do</span>
<a name="ln-148"></a><span class="k">     case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-149"></a>      <span class="n">j2</span> <span class="o">=</span> <span class="n">loc_npty</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-150"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-151"></a>       <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-152"></a>        <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-153"></a>       <span class="k">end do</span>
<a name="ln-154"></a><span class="k">      end do</span>
<a name="ln-155"></a><span class="k">     case</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-156"></a>      <span class="n">k2</span> <span class="o">=</span> <span class="n">loc_nptz</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-157"></a>      <span class="n">j2</span> <span class="o">=</span> <span class="n">loc_npty</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-158"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-159"></a>       <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k2</span>
<a name="ln-160"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-161"></a>         <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-162"></a>        <span class="k">end do</span>
<a name="ln-163"></a><span class="k">       end do</span>
<a name="ln-164"></a><span class="k">      end do</span>
<a name="ln-165"></a><span class="k">     end select</span>
<a name="ln-166"></a><span class="k">     </span><span class="n">np_new</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-167"></a>     <span class="n">np_old</span> <span class="o">=</span> <span class="n">loc_npart</span><span class="p">(</span><span class="n">imody</span><span class="p">,</span> <span class="n">imodz</span><span class="p">,</span> <span class="n">imodx</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-168"></a>     <span class="n">np_new</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np_old</span><span class="o">+</span><span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span> <span class="n">np_new</span><span class="p">)</span>
<a name="ln-169"></a>     <span class="k">call </span><span class="n">v_realloc</span><span class="p">(</span> <span class="n">ebfp</span><span class="p">,</span> <span class="n">np_new</span><span class="p">,</span> <span class="n">ndv</span> <span class="p">)</span>
<a name="ln-170"></a>     <span class="c">!=========================</span>
<a name="ln-171"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">&lt;</span><span class="n">np_new</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-172"></a><span class="k">      </span><span class="n">ebfp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">np_old</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span> <span class="o">=</span> <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">np_old</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-173"></a>      <span class="k">deallocate</span> <span class="p">(</span><span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">)</span>
<a name="ln-174"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">np_new</span><span class="p">,</span> <span class="n">ndv</span><span class="p">))</span>
<a name="ln-175"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">np_old</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span> <span class="o">=</span> <span class="n">ebfp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">np_old</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-176"></a>     <span class="k">end if</span>
<a name="ln-177"></a><span class="k">     </span><span class="n">q</span> <span class="o">=</span> <span class="n">np_old</span>
<a name="ln-178"></a>     <span class="k">call </span><span class="n">add_particles</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-179"></a>     <span class="n">loc_npart</span><span class="p">(</span><span class="n">imody</span><span class="p">,</span> <span class="n">imodz</span><span class="p">,</span> <span class="n">imodx</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">np_new</span>
<a name="ln-180"></a>    <span class="k">end if</span>
<a name="ln-181"></a><span class="k">   end do</span>
<a name="ln-182"></a>   <span class="c">!=======================</span>
<a name="ln-183"></a>  <span class="k">end subroutine</span>
<a name="ln-184"></a>  <span class="c">!=======================</span>
<a name="ln-185"></a>  <span class="k">subroutine </span><span class="n">reset_loc_xgrid</span>
<a name="ln-186"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">n_loc</span>
<a name="ln-187"></a>
<a name="ln-188"></a>   <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-189"></a>   <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-190"></a>   <span class="n">loc_xg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">dx</span>
<a name="ln-191"></a>   <span class="n">loc_xg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">dx</span>
<a name="ln-192"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_loc</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-193"></a>    <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-194"></a>    <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-195"></a>   <span class="k">end do</span>
<a name="ln-196"></a><span class="k">   </span><span class="n">ip</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-197"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">npe_xloc</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-198"></a><span class="k">    do </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">npe_xloc</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-199"></a>     <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-200"></a>     <span class="n">loc_xg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_xg</span><span class="p">(</span><span class="n">n_loc</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-201"></a>     <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-202"></a>     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_loc</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-203"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">ip</span>
<a name="ln-204"></a>      <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-205"></a>      <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-206"></a>     <span class="k">end do</span>
<a name="ln-207"></a><span class="k">     </span><span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">gmin</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">gmax</span>
<a name="ln-208"></a>     <span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span> <span class="o">+</span> <span class="n">n_loc</span>
<a name="ln-209"></a>     <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">gmax</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-210"></a>    <span class="k">end do</span>
<a name="ln-211"></a><span class="k">   end if</span>
<a name="ln-212"></a><span class="k">   </span><span class="n">p</span> <span class="o">=</span> <span class="n">npe_xloc</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-213"></a>   <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-214"></a>   <span class="n">loc_xg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_xg</span><span class="p">(</span><span class="n">n_loc</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-215"></a>   <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-216"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_loc</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-217"></a>    <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">ip</span>
<a name="ln-218"></a>    <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-219"></a>    <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-220"></a>   <span class="k">end do</span>
<a name="ln-221"></a><span class="k">   </span><span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">gmin</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)%</span><span class="n">gmax</span>
<a name="ln-222"></a>   <span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span> <span class="o">+</span> <span class="n">n_loc</span>
<a name="ln-223"></a>   <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">gmax</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-224"></a>  <span class="k">end subroutine</span>
<a name="ln-225"></a>  <span class="c">!========================================</span>
<a name="ln-226"></a>  <span class="k">subroutine </span><span class="n">comoving_coordinate</span><span class="p">(</span><span class="n">vb</span><span class="p">,</span> <span class="n">w_nst</span><span class="p">,</span> <span class="n">loc_it</span><span class="p">)</span>
<a name="ln-227"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vb</span>
<a name="ln-228"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">w_nst</span><span class="p">,</span> <span class="n">loc_it</span>
<a name="ln-229"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">nshx</span>
<a name="ln-230"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dt_tot</span><span class="p">,</span> <span class="n">dt_step</span>
<a name="ln-231"></a>   <span class="kt">logical</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">mw</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-232"></a>   <span class="c">!======================</span>
<a name="ln-233"></a>   <span class="c">! In comoving x-coordinate the </span>
<a name="ln-234"></a>   <span class="c">! [xmin &lt;= x &lt;= xmax] computational box is stationaty</span>
<a name="ln-235"></a>   <span class="c">! xi= (x-vb*t) =&gt; xw is left-advected </span>
<a name="ln-236"></a>   <span class="c">! fields are left-advected in the x-grid directely in the maxw. equations</span>
<a name="ln-237"></a>   <span class="c">! particles are left-advected:</span>
<a name="ln-238"></a>   <span class="c">! xp=xp-vb*dt inside the computational box is added in the eq. of motion and</span>
<a name="ln-239"></a>   <span class="c">! for moving coordinates at each w_nst steps</span>
<a name="ln-240"></a>   <span class="c">! xpt(ix,ic)=xpt(ix,ic)-vb*w_nst*dt outside the computational box</span>
<a name="ln-241"></a>   <span class="c">! then targ_in=targ_in -vb*w_nst*dt   targ_out=targ_out-vb*w_nst*dt</span>
<a name="ln-242"></a>   <span class="c">! </span>
<a name="ln-243"></a>   <span class="c">!==================</span>
<a name="ln-244"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">loc_it</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-245"></a><span class="k">   </span><span class="n">dt_step</span> <span class="o">=</span> <span class="n">dt_loc</span>
<a name="ln-246"></a>   <span class="n">dt_tot</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-247"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w_nst</span>
<a name="ln-248"></a>    <span class="n">dt_tot</span> <span class="o">=</span> <span class="n">dt_tot</span> <span class="o">+</span> <span class="n">dt_step</span>
<a name="ln-249"></a>   <span class="k">end do</span>
<a name="ln-250"></a><span class="k">   </span><span class="n">nshx</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="n">dx_inv</span><span class="o">*</span><span class="n">dt_tot</span><span class="o">*</span><span class="n">vb</span><span class="p">)</span> <span class="c">!the number of grid points x-shift for each w_nst step </span>
<a name="ln-251"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-252"></a>    <span class="n">xw</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">xw</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span> <span class="c">!moves backwards the grid xw </span>
<a name="ln-253"></a>   <span class="k">end do</span>
<a name="ln-254"></a><span class="k">   </span><span class="n">xw_max</span> <span class="o">=</span> <span class="n">xw_max</span> <span class="o">-</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-255"></a>   <span class="n">xw_min</span> <span class="o">=</span> <span class="n">xw_min</span> <span class="o">-</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-256"></a>   <span class="c">!======================== xw(i) grid used only for diagnostics purposes</span>
<a name="ln-257"></a>   <span class="n">targ_in</span> <span class="o">=</span> <span class="n">targ_in</span> <span class="o">-</span> <span class="n">vb</span><span class="o">*</span><span class="n">dt_tot</span>
<a name="ln-258"></a>   <span class="n">targ_end</span> <span class="o">=</span> <span class="n">targ_end</span> <span class="o">-</span> <span class="n">vb</span><span class="o">*</span><span class="n">dt_tot</span>
<a name="ln-259"></a>   <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">part</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-260"></a>   <span class="c">!===========================</span>
<a name="ln-261"></a>   <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsp</span> <span class="c">!left-advects all particles of the target outside the computational box</span>
<a name="ln-262"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">nptx</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sptx_max</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-263"></a>     <span class="n">xpt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">xpt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="o">-</span> <span class="n">vb</span><span class="o">*</span><span class="n">dt_tot</span>
<a name="ln-264"></a>    <span class="k">end do</span>
<a name="ln-265"></a><span class="k">   end do</span>
<a name="ln-266"></a>   <span class="c">!======================</span>
<a name="ln-267"></a>   <span class="k">call </span><span class="n">cell_part_dist</span><span class="p">(</span><span class="n">mw</span><span class="p">)</span> <span class="c">!particles are redistributes along the</span>
<a name="ln-268"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">pex1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-269"></a><span class="k">    if</span> <span class="p">(</span><span class="n">targ_in</span><span class="o">&lt;=</span><span class="n">xmax</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">targ_end</span><span class="o">&gt;</span><span class="n">xmax</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-270"></a><span class="k">     call </span><span class="n">particles_inject</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>
<a name="ln-271"></a>    <span class="k">end if</span>
<a name="ln-272"></a><span class="k">   end if</span>
<a name="ln-273"></a><span class="k">  end subroutine</span>
<a name="ln-274"></a>  <span class="c">!====================================</span>
<a name="ln-275"></a>  <span class="k">subroutine </span><span class="n">lp_window_xshift</span><span class="p">(</span><span class="n">witr</span><span class="p">,</span> <span class="n">init_iter</span><span class="p">)</span>
<a name="ln-276"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">witr</span><span class="p">,</span> <span class="n">init_iter</span>
<a name="ln-277"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i1</span><span class="p">,</span> <span class="n">n1p</span><span class="p">,</span> <span class="n">nc_env</span>
<a name="ln-278"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ix</span><span class="p">,</span> <span class="n">nshx</span><span class="p">,</span> <span class="n">wi2</span>
<a name="ln-279"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">xlapse</span><span class="p">,</span> <span class="n">dt_step</span>
<a name="ln-280"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">wi1</span>
<a name="ln-281"></a>   <span class="kt">logical</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">mw</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-282"></a>
<a name="ln-283"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">init_iter</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-284"></a><span class="k">    </span><span class="n">xlapse</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-285"></a>    <span class="n">wi1</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-286"></a>    <span class="k">return</span>
<a name="ln-287"></a><span class="k">   end if</span>
<a name="ln-288"></a><span class="k">   </span><span class="n">dt_step</span> <span class="o">=</span> <span class="n">dt_loc</span>
<a name="ln-289"></a>   <span class="c">!==================</span>
<a name="ln-290"></a>   <span class="n">i1</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">p_ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-291"></a>   <span class="n">n1p</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">p_ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-292"></a>   <span class="c">!======================</span>
<a name="ln-293"></a>   <span class="n">xlapse</span> <span class="o">=</span> <span class="n">xlapse</span> <span class="o">+</span> <span class="n">w_speed</span><span class="o">*</span><span class="n">dt_step</span><span class="o">*</span><span class="n">witr</span>
<a name="ln-294"></a>   <span class="n">wi2</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="n">dx_inv</span><span class="o">*</span><span class="n">xlapse</span><span class="p">)</span>
<a name="ln-295"></a>   <span class="n">nshx</span> <span class="o">=</span> <span class="n">wi2</span> <span class="o">-</span> <span class="n">wi1</span>
<a name="ln-296"></a>   <span class="n">wi1</span> <span class="o">=</span> <span class="n">wi2</span>
<a name="ln-297"></a>   <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-298"></a>    <span class="n">x</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-299"></a>    <span class="n">xh</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-300"></a>   <span class="k">end do</span>
<a name="ln-301"></a><span class="k">   </span><span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-302"></a>   <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-303"></a>   <span class="n">xp0_out</span> <span class="o">=</span> <span class="n">xp0_out</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-304"></a>   <span class="n">xp1_out</span> <span class="o">=</span> <span class="n">xp1_out</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-305"></a>   <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">gmin</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">gmin</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-306"></a>   <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">gmax</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">gmax</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-307"></a>   <span class="n">xmn</span> <span class="o">=</span> <span class="n">xmn</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-308"></a>   <span class="n">wi2</span> <span class="o">=</span> <span class="n">n1p</span> <span class="o">-</span> <span class="n">nshx</span>
<a name="ln-309"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">wi2</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-310"></a><span class="k">    write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;(a37,3i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Error in window shifting for MPI proc&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-311"></a>      <span class="n">imody</span><span class="p">,</span> <span class="n">imodz</span><span class="p">,</span> <span class="n">imodx</span>
<a name="ln-312"></a>    <span class="n">ier</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-313"></a>    <span class="k">return</span>
<a name="ln-314"></a><span class="k">   end if</span>
<a name="ln-315"></a>   <span class="c">!===========================</span>
<a name="ln-316"></a>   <span class="k">call </span><span class="n">fields_left_xshift</span><span class="p">(</span><span class="n">ebf</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfield</span><span class="p">,</span> <span class="n">nshx</span><span class="p">)</span>
<a name="ln-317"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">hybrid</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-318"></a><span class="k">    do </span><span class="n">ix</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nxf</span> <span class="o">-</span> <span class="n">nshx</span>
<a name="ln-319"></a>     <span class="n">fluid_x_profile</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">=</span> <span class="n">fluid_x_profile</span><span class="p">(</span><span class="n">ix</span><span class="o">+</span><span class="n">nshx</span><span class="p">)</span>
<a name="ln-320"></a>    <span class="k">end do</span>
<a name="ln-321"></a><span class="k">    </span><span class="n">nxf</span> <span class="o">=</span> <span class="n">nxf</span> <span class="o">-</span> <span class="n">nshx</span>
<a name="ln-322"></a>    <span class="k">call </span><span class="n">fluid_left_xshift</span><span class="p">(</span><span class="n">up</span><span class="p">,</span> <span class="n">fluid_x_profile</span><span class="p">,</span> <span class="n">fluid_yz_profile</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-323"></a>      <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcomp</span><span class="p">,</span> <span class="n">nshx</span><span class="p">)</span>
<a name="ln-324"></a>    <span class="k">call </span><span class="n">fields_left_xshift</span><span class="p">(</span><span class="n">up0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcomp</span><span class="p">,</span> <span class="n">nshx</span><span class="p">)</span>
<a name="ln-325"></a>   <span class="k">end if</span>
<a name="ln-326"></a><span class="k">   if</span> <span class="p">(</span><span class="n">envelope</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-327"></a><span class="k">    </span><span class="n">nc_env</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-328"></a>    <span class="k">call </span><span class="n">fields_left_xshift</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nc_env</span><span class="p">,</span> <span class="n">nshx</span><span class="p">)</span>
<a name="ln-329"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">Two_color</span><span class="p">)</span> <span class="k">call </span><span class="n">fields_left_xshift</span><span class="p">(</span><span class="n">env1</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nc_env</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-330"></a>      <span class="n">nshx</span><span class="p">)</span>
<a name="ln-331"></a>   <span class="k">end if</span>
<a name="ln-332"></a>   <span class="c">!shifts fields data and inject right ebf(wi2+1:n1p) x-grid nshx new data</span>
<a name="ln-333"></a>   <span class="c">!===========================</span>
<a name="ln-334"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-335"></a><span class="k">    call </span><span class="n">cell_part_dist</span><span class="p">(</span><span class="n">mw</span><span class="p">)</span> <span class="c">!particles are redistributes along the</span>
<a name="ln-336"></a>    <span class="c">! right-shifted x-coordinate in MPI domains</span>
<a name="ln-337"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pex1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-338"></a><span class="k">     if</span> <span class="p">(</span><span class="n">targ_in</span><span class="o">&lt;=</span><span class="n">xmax</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-339"></a><span class="k">      if</span> <span class="p">(</span><span class="n">targ_end</span><span class="o">&gt;</span><span class="n">xmax</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-340"></a><span class="k">       call </span><span class="n">particles_inject</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>
<a name="ln-341"></a>      <span class="k">end if</span>
<a name="ln-342"></a><span class="k">     end if</span>
<a name="ln-343"></a><span class="k">    end if</span>
<a name="ln-344"></a><span class="k">    call </span><span class="n">part_numbers</span>
<a name="ln-345"></a>   <span class="k">end if</span>
<a name="ln-346"></a><span class="k">  end subroutine</span>
<a name="ln-347"></a>  <span class="c">!==============================</span>
<a name="ln-348"></a> <span class="k">end module</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-01-29 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ALaDyn was developed by The ALaDyn Collaboration</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>