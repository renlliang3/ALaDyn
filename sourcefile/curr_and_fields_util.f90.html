<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A High-Accuracy PIC Code for the Maxwell-Vlasov Equations">
    
    <meta name="author" content="The ALaDyn Collaboration" >
    <link rel="icon" href="../favicon.png">

    <title>curr_and_fields_util.f90 &ndash; ALaDyn</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ALaDyn <small>3.0.1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/aladyn.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/aladyn.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>curr_and_fields_util.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.0% of total for source files.">235 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/curr_and_fields_util.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">curr_and_fields_util.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/curr_and_fields_util.html">curr_and_fields_util</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/curr_and_fields_util.f90.html#src">curr_and_fields_util.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~curr_and_fields_util.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilecurr_and_fields_utilf90EfferentGraph" width="641pt" height="208pt"
 viewBox="0.00 0.00 641.00 207.90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph" class="graph" transform="scale(.5979 .5979) rotate(0) translate(4 343.682)">
<title>sourcefile~~curr_and_fields_util.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-343.682 1068,-343.682 1068,4 -4,4"/>
<!-- sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~curr_and_fields_util.f90</title>
<polygon fill="none" stroke="#000000" points="1064,-226.2918 928,-226.2918 928,-202.2918 1064,-202.2918 1064,-226.2918"/>
<text text-anchor="middle" x="996" y="-211.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">curr_and_fields_util.f90</text>
</g>
<!-- sourcefile~grid_part_connect.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~grid_part_connect.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/grid_part_connect.f90.html" xlink:title="grid_part_connect.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="892,-226.2918 763,-226.2918 763,-202.2918 892,-202.2918 892,-226.2918"/>
<text text-anchor="middle" x="827.5" y="-211.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_part_connect.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_part_connect.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_part_connect.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.9503,-214.2918C919.5736,-214.2918 910.9749,-214.2918 902.5025,-214.2918"/>
<polygon fill="#ff0000" stroke="#ff0000" points="902.254,-210.7919 892.254,-214.2918 902.2539,-217.7919 902.254,-210.7919"/>
</g>
<!-- sourcefile~grid_fields.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~grid_fields.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/grid_fields.f90.html" xlink:title="grid_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="703.5,-146.2918 615.5,-146.2918 615.5,-122.2918 703.5,-122.2918 703.5,-146.2918"/>
<text text-anchor="middle" x="659.5" y="-131.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-174.2918C789.4515,-165.1706 746.538,-154.9543 713.6068,-147.1297"/>
<polygon fill="#ff0000" stroke="#ff0000" points="714.2619,-143.688 703.7237,-144.782 712.6441,-150.4984 714.2619,-143.688"/>
</g>
<!-- sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~mpi_field_interface.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/mpi_field_interface.f90.html" xlink:title="mpi_field_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="727,-226.2918 592,-226.2918 592,-202.2918 727,-202.2918 727,-226.2918"/>
<text text-anchor="middle" x="659.5" y="-211.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_field_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M986.6283,-226.4492C963.4145,-255.1545 899.8606,-325.401 827.5,-334.2918"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-334.2918C765.2694,-341.938 780.7852,-267.5139 727,-235.2918 724.0143,-233.5031 720.8618,-231.853 717.616,-230.3327"/>
<polygon fill="#ff0000" stroke="#ff0000" points="718.8564,-227.0572 708.2829,-226.3848 716.1293,-233.5042 718.8564,-227.0572"/>
</g>
<!-- sourcefile~init_grid_fields.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~init_grid_fields.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/init_grid_fields.f90.html" xlink:title="init_grid_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="714,-104.2918 605,-104.2918 605,-80.2918 714,-80.2918 714,-104.2918"/>
<text text-anchor="middle" x="659.5" y="-89.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_grid_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~init_grid_fields.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~init_grid_fields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M945.1084,-202.2725C911.6712,-194.3603 866.9714,-183.7541 827.5,-174.2918"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-174.2918C776.689,-162.1111 774.633,-134.7678 727,-113.2918 722.6156,-111.315 717.9919,-109.4514 713.3047,-107.7126"/>
<polygon fill="#ff0000" stroke="#ff0000" points="714.246,-104.3336 703.6511,-104.3224 711.9265,-110.9382 714.246,-104.3336"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~mpi_curr_interface.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/mpi_curr_interface.f90.html" xlink:title="mpi_curr_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="726,-268.2918 593,-268.2918 593,-244.2918 726,-244.2918 726,-268.2918"/>
<text text-anchor="middle" x="659.5" y="-253.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_curr_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-334.2918C770.3188,-341.3176 710.8919,-300.3083 680.3677,-275.0557"/>
<polygon fill="#ff0000" stroke="#ff0000" points="682.4347,-272.219 672.5506,-268.404 677.8983,-277.5502 682.4347,-272.219"/>
</g>
<!-- sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~grid_param.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/grid_param.f90.html" xlink:title="grid_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="383.5,-227.2918 289.5,-227.2918 289.5,-203.2918 383.5,-203.2918 383.5,-227.2918"/>
<text text-anchor="middle" x="336.5" y="-212.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M659.5,-334.2918C558.6634,-328.2028 524.2493,-358.6352 433,-315.2918 430.51,-314.109 382.3656,-263.62 355.0413,-234.8482"/>
<polygon fill="#ff0000" stroke="#ff0000" points="357.3645,-232.2118 347.9417,-227.368 352.2872,-237.0307 357.3645,-232.2118"/>
</g>
<!-- sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~pstruct_data.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/pstruct_data.f90.html" xlink:title="pstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="544,-306.2918 445,-306.2918 445,-282.2918 544,-282.2918 544,-306.2918"/>
<text text-anchor="middle" x="494.5" y="-291.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-334.2918C753.3906,-343.3975 734.0309,-338.7924 659.5,-334.2918"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M659.5,-334.2918C617.638,-331.764 571.3405,-319.6901 538.4689,-309.4621"/>
<polygon fill="#ff0000" stroke="#ff0000" points="539.3086,-306.0565 528.7182,-306.3598 537.1863,-312.727 539.3086,-306.0565"/>
</g>
<!-- sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~fstruct_data.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/fstruct_data.f90.html" xlink:title="fstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="542.5,-184.2918 446.5,-184.2918 446.5,-160.2918 542.5,-160.2918 542.5,-184.2918"/>
<text text-anchor="middle" x="494.5" y="-169.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-174.2918C754.8906,-156.8855 734.0075,-179.1645 659.5,-174.2918"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M659.5,-174.2918C624.1852,-171.9823 584.5309,-171.436 552.9487,-171.489"/>
<polygon fill="#ff0000" stroke="#ff0000" points="552.5523,-167.9904 542.5657,-171.5283 552.5789,-174.9903 552.5523,-167.9904"/>
</g>
<!-- sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M813.334,-226.3685C794.85,-241.3318 760.8563,-266.2049 727,-277.2918 670.5626,-295.7733 602.4387,-298.6535 554.5667,-297.7453"/>
<polygon fill="#ff0000" stroke="#ff0000" points="554.4534,-294.2414 544.3686,-297.4888 554.2774,-301.2392 554.4534,-294.2414"/>
</g>
<!-- sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M792.3106,-202.2488C758.6819,-191.621 706.3218,-177.3539 659.5,-174.2918"/>
</g>
<!-- sourcefile~grid_part_lib.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~grid_part_lib.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/grid_part_lib.f90.html" xlink:title="grid_part_lib.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="709,-62.2918 610,-62.2918 610,-38.2918 709,-38.2918 709,-62.2918"/>
<text text-anchor="middle" x="659.5" y="-47.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_part_lib.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~grid_part_lib.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~grid_part_lib.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M782.5597,-202.2822C775.2895,-198.7303 768.391,-194.1598 763,-188.2918 726.192,-148.2272 765.4107,-109.8225 727,-71.2918 724.3302,-68.6137 721.3252,-66.276 718.1045,-64.2356"/>
<polygon fill="#ff0000" stroke="#ff0000" points="719.6324,-61.0844 709.1567,-59.4994 716.3576,-67.2711 719.6324,-61.0844"/>
</g>
<!-- sourcefile~parallel.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~parallel.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/parallel.f90.html" xlink:title="parallel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="532.5,-226.2918 456.5,-226.2918 456.5,-202.2918 532.5,-202.2918 532.5,-226.2918"/>
<text text-anchor="middle" x="494.5" y="-211.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_fields.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~grid_fields.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M640.6149,-146.5074C620.2903,-159.3045 586.7342,-179.4347 556,-193.2918 551.603,-195.2743 546.9596,-197.1802 542.2746,-198.98"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="540.8417,-195.7777 532.6652,-202.5154 543.2587,-202.3472 540.8417,-195.7777"/>
</g>
<!-- sourcefile~grid_field_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~grid_field_param.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/grid_field_param.f90.html" xlink:title="grid_field_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="556,-104.2918 433,-104.2918 433,-80.2918 556,-80.2918 556,-104.2918"/>
<text text-anchor="middle" x="494.5" y="-89.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_field_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_fields.f90&#45;&gt;sourcefile~grid_field_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~grid_fields.f90&#45;&gt;sourcefile~grid_field_param.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M615.283,-123.0366C595.6699,-118.0441 572.3477,-112.1076 551.4517,-106.7886"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="552.285,-103.3892 541.7306,-104.3141 550.5582,-110.1728 552.285,-103.3892"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M621.3438,-226.3361C580.6707,-238.6715 518.8416,-255.8439 494.5,-254.2918"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M494.5,-254.2918C454.9361,-251.7691 411.2765,-240.2956 379.8966,-230.441"/>
<polygon fill="#7fff00" stroke="#7fff00" points="380.7519,-227.0396 370.1606,-227.3117 378.6099,-233.7038 380.7519,-227.0396"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M611.5428,-226.3114C604.7749,-228.8299 598.0646,-231.8051 592,-235.2918 573.1832,-246.1102 574.2623,-256.5615 556,-268.2918 550.3644,-271.9117 544.1397,-275.222 537.879,-278.1782"/>
<polygon fill="#7fff00" stroke="#7fff00" points="536.4531,-274.9818 528.745,-282.2506 539.3036,-281.3751 536.4531,-274.9818"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M612.2176,-202.2563C593.3177,-197.4454 571.382,-191.8618 551.6039,-186.8273"/>
<polygon fill="#7fff00" stroke="#7fff00" points="552.3437,-183.4041 541.7893,-184.3291 550.6169,-190.1878 552.3437,-183.4041"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M591.9121,-214.2918C575.5698,-214.2918 558.4201,-214.2918 543.144,-214.2918"/>
<polygon fill="#7fff00" stroke="#7fff00" points="542.9006,-210.7919 532.9006,-214.2918 542.9005,-217.7919 542.9006,-210.7919"/>
</g>
<!-- sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M604.8589,-103.5051C600.0819,-106.1194 595.6757,-109.3359 592,-113.2918 543.8604,-165.1016 601.5346,-214.1782 556,-268.2918 553.2292,-271.5847 549.9686,-274.4693 546.4186,-276.9948"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="544.454,-274.0925 537.7043,-282.2591 548.0735,-280.0841 544.454,-274.0925"/>
</g>
<!-- sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M611.5428,-104.3114C604.7749,-106.8299 598.0646,-109.8051 592,-113.2918 573.1832,-124.1102 574.2623,-134.5615 556,-146.2918 550.3644,-149.9117 544.1397,-153.222 537.879,-156.1782"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="536.4531,-152.9818 528.745,-160.2506 539.3036,-159.3751 536.4531,-152.9818"/>
</g>
<!-- sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~grid_field_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~grid_field_param.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M604.5574,-92.2918C592.278,-92.2918 579.0783,-92.2918 566.233,-92.2918"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="566.0316,-88.7919 556.0315,-92.2918 566.0315,-95.7919 566.0316,-88.7919"/>
</g>
<!-- sourcefile~phys_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~phys_param.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/phys_param.f90.html" xlink:title="phys_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="240,-45.2918 142,-45.2918 142,-21.2918 240,-21.2918 240,-45.2918"/>
<text text-anchor="middle" x="191" y="-30.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">phys_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~phys_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~phys_param.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M609.3804,-80.2211C603.2822,-77.7484 597.3315,-74.7993 592,-71.2918 571.4608,-57.7794 578.3362,-39.565 556,-29.2918 454.2725,17.4962 319.0945,-2.2068 245.1001,-18.9057"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="244.0236,-15.5626 235.0751,-21.2349 245.6078,-22.3809 244.0236,-15.5626"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M592.806,-257.0451C562.741,-256.9828 526.8066,-256.3517 494.5,-254.2918"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M607.293,-268.3152C590.4032,-272.205 571.5464,-276.5478 554.159,-280.5522"/>
<polygon fill="#00ffff" stroke="#00ffff" points="553.0767,-277.2097 544.1173,-282.8648 554.6477,-284.0311 553.0767,-277.2097"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M609.3804,-244.2211C603.2822,-241.7484 597.3315,-238.7993 592,-235.2918 571.4608,-221.7794 576.352,-207.0846 556,-193.2918 553.5921,-191.66 551.0455,-190.1438 548.4125,-188.7366"/>
<polygon fill="#00ffff" stroke="#00ffff" points="549.7381,-185.4915 539.2036,-184.3621 546.7344,-191.8144 549.7381,-185.4915"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M612.2176,-244.2563C590.3336,-238.6858 564.3795,-232.0793 542.4176,-226.489"/>
<polygon fill="#00ffff" stroke="#00ffff" points="543.1912,-223.0744 532.6369,-223.9994 541.4644,-229.8581 543.1912,-223.0744"/>
</g>
<!-- sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~precision_def.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/precision_def.f90.html" xlink:title="precision_def.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="106,-205.2918 0,-205.2918 0,-181.2918 106,-181.2918 106,-205.2918"/>
<text text-anchor="middle" x="53" y="-190.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision_def.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~grid_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M289.3675,-211.6342C241.9849,-207.9573 168.644,-202.2659 116.2291,-198.1985"/>
<polygon fill="#003fff" stroke="#003fff" points="116.2798,-194.692 106.039,-197.4077 115.7382,-201.671 116.2798,-194.692"/>
</g>
<!-- sourcefile~struct_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~struct_def.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/struct_def.f90.html" xlink:title="struct_def.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="233.5,-265.2918 148.5,-265.2918 148.5,-241.2918 233.5,-241.2918 233.5,-265.2918"/>
<text text-anchor="middle" x="191" y="-250.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">struct_def.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_param.f90&#45;&gt;sourcefile~struct_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~grid_param.f90&#45;&gt;sourcefile~struct_def.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M290.4629,-227.3152C275.5744,-231.2036 258.9526,-235.5447 243.6244,-239.548"/>
<polygon fill="#003fff" stroke="#003fff" points="242.5608,-236.2083 233.7697,-242.1217 244.3297,-242.9811 242.5608,-236.2083"/>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M336.5,-293.2918C249.8658,-287.0899 221.3822,-309.5397 142,-274.2918 111.5609,-260.776 84.5206,-232.6849 68.4491,-213.4112"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="71.0689,-211.0846 62.0593,-205.5098 65.6259,-215.4863 71.0689,-211.0846"/>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M444.9762,-295.6302C413.8051,-296.0637 372.7534,-295.8871 336.5,-293.2918"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M336.5,-293.2918C299.8016,-290.6647 259.5788,-278.8816 230.7434,-268.7791"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="231.6377,-265.3814 221.0432,-265.2936 229.2706,-271.9691 231.6377,-265.3814"/>
</g>
<!-- sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M463.3141,-160.2292C407.6374,-140.4569 287.8864,-105.9502 191,-133.2918"/>
</g>
<!-- sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~common_param.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/common_param.f90.html" xlink:title="common_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="397,-63.2918 276,-63.2918 276,-39.2918 397,-39.2918 397,-63.2918"/>
<text text-anchor="middle" x="336.5" y="-48.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">common_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M456.4514,-207.5065C447.8139,-204.4034 439.332,-199.8814 433,-193.2918 394.1247,-152.8349 435.7731,-112.8467 397,-72.2918 395.9436,-71.1868 394.8261,-70.1399 393.6571,-69.1481"/>
<polygon fill="#ff0000" stroke="#ff0000" points="395.5136,-66.1766 385.2974,-63.3691 391.533,-71.9347 395.5136,-66.1766"/>
</g>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~util.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/util.f90.html" xlink:title="util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363.5,-185.2918 309.5,-185.2918 309.5,-161.2918 363.5,-161.2918 363.5,-185.2918"/>
<text text-anchor="middle" x="336.5" y="-170.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M456.2526,-204.3668C431.0479,-197.8264 398.2219,-189.3082 373.3136,-182.8447"/>
<polygon fill="#ff0000" stroke="#ff0000" points="374.0682,-179.4247 363.5097,-180.3006 372.3099,-186.2003 374.0682,-179.4247"/>
</g>
<!-- sourcefile~mpi_var.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~mpi_var.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/mpi_var.f90.html" xlink:title="mpi_var.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="374,-105.2918 299,-105.2918 299,-81.2918 374,-81.2918 374,-105.2918"/>
<text text-anchor="middle" x="336.5" y="-90.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_var.f90</text>
</a>
</g>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~mpi_var.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~mpi_var.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M456.29,-204.6995C448.2236,-201.7479 440.0329,-197.9971 433,-193.2918 412.8451,-179.8073 413.693,-169.8814 397,-152.2918 384.076,-138.6737 368.9553,-123.9276 357.0634,-112.584"/>
<polygon fill="#ff0000" stroke="#ff0000" points="359.4347,-110.0093 349.7705,-105.6671 354.6176,-115.0882 359.4347,-110.0093"/>
</g>
<!-- sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M609.7324,-62.2204C603.5113,-64.722 597.4341,-67.7168 592,-71.2918 571.4608,-84.8042 576.5526,-99.7998 556,-113.2918 508.1693,-144.6909 480.6477,-119.6157 433,-151.2918 412.2436,-165.0906 417.5156,-180.1375 397,-194.2918 394.6406,-195.9196 392.1429,-197.4325 389.5585,-198.8372"/>
<polygon fill="#00ff00" stroke="#00ff00" points="387.9962,-195.7048 380.5136,-203.2056 391.0406,-202.0082 387.9962,-195.7048"/>
</g>
<!-- sourcefile~stretched_grid.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~stretched_grid.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/stretched_grid.f90.html" xlink:title="stretched_grid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="549,-62.2918 440,-62.2918 440,-38.2918 549,-38.2918 549,-62.2918"/>
<text text-anchor="middle" x="494.5" y="-47.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">stretched_grid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~stretched_grid.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~stretched_grid.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M609.9946,-50.2918C594.1153,-50.2918 576.2836,-50.2918 559.4703,-50.2918"/>
<polygon fill="#00ff00" stroke="#00ff00" points="559.1598,-46.7919 549.1597,-50.2918 559.1597,-53.7919 559.1598,-46.7919"/>
</g>
<!-- sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M610.5817,-38.2754C593.4335,-34.6212 573.9695,-31.0964 556,-29.2918 501.6069,-23.8293 487.3237,-23.1779 433,-29.2918 418.8473,-30.8846 403.7436,-33.7521 389.7881,-36.902"/>
<polygon fill="#00ff00" stroke="#00ff00" points="388.7955,-33.5397 379.8593,-39.2312 390.3944,-40.3547 388.7955,-33.5397"/>
</g>
<!-- sourcefile~grid_field_param.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~grid_field_param.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M454.1961,-104.3282C446.5264,-107.9332 439.0255,-112.5165 433,-118.2918 406.0171,-144.1542 424.82,-169.3321 397,-194.2918 395.5104,-195.6283 393.9311,-196.8806 392.2822,-198.0541"/>
<polygon fill="#00ffff" stroke="#00ffff" points="390.3277,-195.145 383.5497,-203.288 393.9264,-201.1491 390.3277,-195.145"/>
</g>
<!-- sourcefile~grid_field_param.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~grid_field_param.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M447.9494,-80.2122C430.6683,-75.7279 410.88,-70.5929 392.8196,-65.9064"/>
<polygon fill="#00ffff" stroke="#00ffff" points="393.5493,-62.4799 382.9907,-63.3558 391.791,-69.2555 393.5493,-62.4799"/>
</g>
<!-- sourcefile~grid_field_param.f90&#45;&gt;sourcefile~mpi_var.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~grid_field_param.f90&#45;&gt;sourcefile~mpi_var.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M432.9607,-92.6813C416.9091,-92.7829 399.8452,-92.8909 384.6029,-92.9873"/>
<polygon fill="#00ffff" stroke="#00ffff" points="384.3539,-89.4888 374.3763,-93.0521 384.3983,-96.4886 384.3539,-89.4888"/>
</g>
<!-- sourcefile~phys_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~phys_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M180.6276,-45.3178C157.0511,-72.6529 99.2379,-139.6826 70.2133,-173.3343"/>
<polygon fill="#0000ff" stroke="#0000ff" points="67.3737,-171.2678 63.4928,-181.1262 72.6745,-175.8397 67.3737,-171.2678"/>
</g>
<!-- sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M163.0736,-241.1499C142.1241,-232.0414 113.2321,-219.4797 90.305,-209.5114"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="91.4511,-206.1932 80.8848,-205.4156 88.66,-212.6127 91.4511,-206.1932"/>
</g>
<!-- sourcefile~stretched_grid.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~stretched_grid.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M444.5874,-62.4328C440.3158,-64.8657 436.3536,-67.7862 433,-71.2918 393.6255,-112.4512 436.2705,-153.0332 397,-194.2918 395.5627,-195.8018 394.0115,-197.2033 392.3706,-198.504"/>
<polygon fill="#ff0000" stroke="#ff0000" points="390.0393,-195.8428 383.5326,-204.2043 393.8334,-201.7254 390.0393,-195.8428"/>
</g>
<!-- sourcefile~stretched_grid.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~stretched_grid.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.6827,-50.6387C429.281,-50.7046 418.2604,-50.7743 407.4433,-50.8428"/>
<polygon fill="#ff0000" stroke="#ff0000" points="407.1391,-47.3445 397.1615,-50.9079 407.1835,-54.3444 407.1391,-47.3445"/>
</g>
<!-- sourcefile~stretched_grid.f90&#45;&gt;sourcefile~mpi_var.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~stretched_grid.f90&#45;&gt;sourcefile~mpi_var.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M450.0677,-62.3841C429.4233,-68.0025 404.8559,-74.6886 383.8602,-80.4026"/>
<polygon fill="#ff0000" stroke="#ff0000" points="382.9133,-77.0329 374.1834,-83.0362 384.7516,-83.7873 382.9133,-77.0329"/>
</g>
<!-- sourcefile~common_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~common_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M296.4347,-63.3631C289.4741,-65.9746 282.4159,-68.9656 276,-72.2918 234.7187,-93.6933 235.7513,-120.6629 191,-133.2918"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M191,-133.2918C153.215,-143.9548 112.2359,-162.7754 84.834,-176.5013"/>
<polygon fill="#7fff00" stroke="#7fff00" points="83.0666,-173.4734 75.7353,-181.1222 86.2363,-179.7146 83.0666,-173.4734"/>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M309.2539,-162.1801C273.6386,-148.2847 213.1873,-127.0305 191,-133.2918"/>
</g>
<!-- sourcefile~code_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~code_util.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/code_util.f90.html" xlink:title="code_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="231.5,-185.2918 150.5,-185.2918 150.5,-161.2918 231.5,-161.2918 231.5,-185.2918"/>
<text text-anchor="middle" x="191" y="-170.8918" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">code_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M309.4736,-173.2918C290.5163,-173.2918 264.5932,-173.2918 241.8288,-173.2918"/>
<polygon fill="#00ffff" stroke="#00ffff" points="241.6281,-169.7919 231.6281,-173.2918 241.628,-176.7919 241.6281,-169.7919"/>
</g>
<!-- sourcefile~mpi_var.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~mpi_var.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M298.7774,-103.512C269.3819,-111.5124 227.5587,-122.9749 191,-133.2918"/>
</g>
<!-- sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M150.3418,-179.1843C139.6422,-180.735 127.8421,-182.4451 116.2592,-184.1238"/>
<polygon fill="#ff0000" stroke="#ff0000" points="115.5639,-180.6879 106.1693,-185.5861 116.568,-187.6155 115.5639,-180.6879"/>
</g>
</g>
</svg>
</div><script>var pansourcefilecurr_and_fields_utilf90EfferentGraph = svgPanZoom('#sourcefilecurr_and_fields_utilf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~curr_and_fields_util.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilecurr_and_fields_utilf90AfferentGraph" width="429pt" height="74pt"
 viewBox="0.00 0.00 429.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>sourcefile~~curr_and_fields_util.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-70 425,-70 425,4 -4,4"/>
<!-- sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~curr_and_fields_util.f90</title>
<polygon fill="none" stroke="#000000" points="136,-45 0,-45 0,-21 136,-21 136,-45"/>
<text text-anchor="middle" x="68" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">curr_and_fields_util.f90</text>
</g>
<!-- sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~env_evolve_in_time.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/env_evolve_in_time.f90.html" xlink:title="env_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="309,-66 172,-66 172,-42 309,-42 309,-66"/>
<text text-anchor="middle" x="240.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">env_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M171.8278,-45.6399C163.3866,-44.6123 154.7107,-43.5561 146.1426,-42.513"/>
<polygon fill="#ff0000" stroke="#ff0000" points="146.504,-39.0313 136.1543,-41.297 145.658,-45.98 146.504,-39.0313"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~pic_evolve_in_time.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/pic_evolve_in_time.f90.html" xlink:title="pic_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="307,-24 174,-24 174,0 307,0 307,-24"/>
<text text-anchor="middle" x="240.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M173.807,-20.1191C164.7558,-21.221 155.4014,-22.3598 146.1714,-23.4835"/>
<polygon fill="#ff0000" stroke="#ff0000" points="145.7287,-20.0114 136.2249,-24.6944 146.5747,-26.9601 145.7287,-20.0114"/>
</g>
<!-- sourcefile~aladyn.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~aladyn.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/aladyn.f90.html" xlink:title="ALaDyn.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="421,-45 345,-45 345,-21 421,-21 421,-45"/>
<text text-anchor="middle" x="383" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ALaDyn.F90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M344.8126,-38.6276C336.7861,-39.8105 328.0404,-41.0993 319.1391,-42.4111"/>
<polygon fill="#ff0000" stroke="#ff0000" points="318.4361,-38.9768 309.0533,-43.8974 319.4567,-45.902 318.4361,-38.9768"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M344.8126,-27.3724C336.1852,-26.101 326.7268,-24.7071 317.1375,-23.2939"/>
<polygon fill="#00ffff" stroke="#00ffff" points="317.5298,-19.814 307.1264,-21.8186 316.5092,-26.7392 317.5298,-19.814"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/curr_and_fields_util.html">curr_and_fields_util</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/curr_and_fields_util.f90.html#src">curr_and_fields_util.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-2"></a><span class="c">!                            Copyright 2008-2020  The ALaDyn Collaboration                            !</span>
<a name="ln-3"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-6"></a><span class="c">!  This file is part of ALaDyn.                                                                       !</span>
<a name="ln-7"></a><span class="c">!                                                                                                     !</span>
<a name="ln-8"></a><span class="c">!  ALaDyn is free software: you can redistribute it and/or modify                                     !</span>
<a name="ln-9"></a><span class="c">!  it under the terms of the GNU General Public License as published by                               !</span>
<a name="ln-10"></a><span class="c">!  the Free Software Foundation, either version 3 of the License, or                                  !</span>
<a name="ln-11"></a><span class="c">!  (at your option) any later version.                                                                !</span>
<a name="ln-12"></a><span class="c">!                                                                                                     !</span>
<a name="ln-13"></a><span class="c">!  ALaDyn is distributed in the hope that it will be useful,                                          !</span>
<a name="ln-14"></a><span class="c">!  but WITHOUT ANY WARRANTY; without even the implied warranty of                                     !</span>
<a name="ln-15"></a><span class="c">!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                      !</span>
<a name="ln-16"></a><span class="c">!  GNU General Public License for more details.                                                       !</span>
<a name="ln-17"></a><span class="c">!                                                                                                     !</span>
<a name="ln-18"></a><span class="c">!  You should have received a copy of the GNU General Public License                                  !</span>
<a name="ln-19"></a><span class="c">!  along with ALaDyn.  If not, see &lt;http://www.gnu.org/licenses/&gt;.                                    !</span>
<a name="ln-20"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-21"></a>
<a name="ln-22"></a> <span class="k">module </span><span class="n">curr_and_fields_util</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">pstruct_data</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">fstruct_data</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">grid_param</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">mpi_curr_interface</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">mpi_field_interface</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">grid_part_connect</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">grid_fields</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">init_grid_field</span>
<a name="ln-31"></a>
<a name="ln-32"></a>  <span class="k">implicit none</span>
<a name="ln-33"></a>  <span class="c">!===============================</span>
<a name="ln-34"></a>  <span class="c">! MOVING WINDOW SECTION</span>
<a name="ln-35"></a>  <span class="c">!=============================</span>
<a name="ln-36"></a> <span class="k">contains</span>
<a name="ln-37"></a>  <span class="c">!============================</span>
<a name="ln-38"></a>  <span class="k">subroutine </span><span class="n">set_lpf_acc</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<a name="ln-39"></a>
<a name="ln-40"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ef</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-41"></a>   <span class="k">type</span> <span class="p">(</span><span class="n">species</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sp_loc</span>
<a name="ln-42"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">apt</span><span class="p">(:,</span> <span class="p">:)</span>
<a name="ln-43"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span><span class="p">,</span> <span class="n">nf</span>
<a name="ln-44"></a>
<a name="ln-45"></a>   <span class="c">! Uses alternating order quadratic or linear shapes</span>
<a name="ln-46"></a>
<a name="ln-47"></a>   <span class="k">select case</span> <span class="p">(</span><span class="n">ndim</span><span class="p">)</span>
<a name="ln-48"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-49"></a>    <span class="k">call </span><span class="n">set_part1d_acc</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<a name="ln-50"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-51"></a>    <span class="k">call </span><span class="n">set_part2d_hcell_acc</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<a name="ln-52"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-53"></a>    <span class="k">call </span><span class="n">set_part3d_hcell_acc</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">)</span>
<a name="ln-54"></a>   <span class="k">end select</span>
<a name="ln-55"></a><span class="k">  end subroutine</span>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="k">  subroutine </span><span class="n">field_charge_multiply</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">ncmp</span><span class="p">)</span>
<a name="ln-58"></a>
<a name="ln-59"></a>   <span class="k">type</span> <span class="p">(</span><span class="n">species</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sp_loc</span>
<a name="ln-60"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">apt</span><span class="p">(:,</span> <span class="p">:)</span>
<a name="ln-61"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span><span class="p">,</span> <span class="n">ncmp</span>
<a name="ln-62"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">,</span> <span class="n">ch</span>
<a name="ln-63"></a>
<a name="ln-64"></a>   <span class="n">ch</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">apt</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-65"></a>   <span class="c">!==========================</span>
<a name="ln-66"></a>   <span class="k">do </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span>
<a name="ln-67"></a>    <span class="n">wgh_cmp</span> <span class="o">=</span> <span class="n">sp_loc</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ch</span><span class="p">)</span>
<a name="ln-68"></a>    <span class="n">apt</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ncmp</span><span class="p">)</span> <span class="o">=</span> <span class="n">charge</span><span class="o">*</span><span class="n">apt</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ncmp</span><span class="p">)</span>
<a name="ln-69"></a>   <span class="k">end do</span>
<a name="ln-70"></a>   <span class="c">! EXIT p-assigned (E,B) fields multiplied by charge</span>
<a name="ln-71"></a>  <span class="k">end subroutine</span>
<a name="ln-72"></a>
<a name="ln-73"></a><span class="k">  subroutine </span><span class="n">curr_accumulate</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-74"></a>   <span class="k">type</span> <span class="p">(</span><span class="n">species</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sp_loc</span>
<a name="ln-75"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pdata</span><span class="p">(:,</span> <span class="p">:),</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-76"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">npt</span>
<a name="ln-77"></a>   <span class="c">! real(dp),intent(in) :: dtloc</span>
<a name="ln-78"></a>   <span class="c">!=========================</span>
<a name="ln-79"></a>   <span class="c">! charge preserving for iform=0, 1</span>
<a name="ln-80"></a>   <span class="c">!iform=0 =&gt; (D_xJx,D_yJy,D_zJz) inverted on each particle=&gt; (Jx,Jy,Jz)</span>
<a name="ln-81"></a>   <span class="c">!iform=1    as iform=0</span>
<a name="ln-82"></a>   <span class="c">!iform=2    no charge preserving</span>
<a name="ln-83"></a>   <span class="c">!=========================</span>
<a name="ln-84"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">npt</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-85"></a><span class="k">   if</span> <span class="p">(</span><span class="n">ndim</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-86"></a><span class="k">    if</span> <span class="p">(</span><span class="n">iform</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-87"></a><span class="k">     call </span><span class="n">esirkepov_2d_curr</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-88"></a>    <span class="k">else</span>
<a name="ln-89"></a><span class="k">     call </span><span class="n">ncdef_2d_curr</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-90"></a>    <span class="k">end if</span>
<a name="ln-91"></a><span class="k">    return</span>
<a name="ln-92"></a><span class="k">   end if</span>
<a name="ln-93"></a><span class="k">   if</span> <span class="p">(</span><span class="n">iform</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-94"></a><span class="k">    call </span><span class="n">esirkepov_3d_curr</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-95"></a>   <span class="k">else</span>
<a name="ln-96"></a><span class="k">    call </span><span class="n">ncdef_3d_curr</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-97"></a>   <span class="k">end if</span>
<a name="ln-98"></a>   <span class="c">!========================</span>
<a name="ln-99"></a>   <span class="c">! accumulates for each species currents on curr(i1:n1p,j1:n2p,k1:n3p,1:compnent)</span>
<a name="ln-100"></a>   <span class="c">!============================</span>
<a name="ln-101"></a>  <span class="k">end subroutine</span>
<a name="ln-102"></a>  <span class="c">!==============================</span>
<a name="ln-103"></a>  <span class="k">subroutine </span><span class="n">curr_mpi_collect</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span>
<a name="ln-104"></a>
<a name="ln-105"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-106"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span>
<a name="ln-107"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dery</span><span class="p">,</span> <span class="n">derhy</span><span class="p">,</span> <span class="n">derz</span><span class="p">,</span> <span class="n">derhz</span>
<a name="ln-108"></a>   <span class="c">!============sums data on ghost points</span>
<a name="ln-109"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-110"></a><span class="k">    call </span><span class="n">fill_curr_yzxbdsdata</span><span class="p">(</span><span class="n">curr</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">)</span>
<a name="ln-111"></a>   <span class="k">end if</span>
<a name="ln-112"></a><span class="k">   call </span><span class="n">jc_xyzbd</span><span class="p">(</span><span class="n">curr</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">)</span>
<a name="ln-113"></a>   <span class="c">!=================</span>
<a name="ln-114"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">iform</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-115"></a><span class="k">    do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span>
<a name="ln-116"></a>     <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">djc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">)</span>
<a name="ln-117"></a>    <span class="k">end do</span>
<a name="ln-118"></a><span class="k">   end if</span>
<a name="ln-119"></a><span class="k">   if</span> <span class="p">(</span><span class="n">stretch</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-120"></a><span class="k">    select case</span> <span class="p">(</span><span class="n">curr_ndim</span><span class="p">)</span>
<a name="ln-121"></a>    <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-122"></a>     <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span>
<a name="ln-123"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span>
<a name="ln-124"></a>       <span class="n">jj</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-125"></a>       <span class="n">dery</span> <span class="o">=</span> <span class="n">loc_yg</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">imody</span><span class="p">)</span>
<a name="ln-126"></a>       <span class="n">derhy</span> <span class="o">=</span> <span class="n">loc_yg</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">imody</span><span class="p">)</span>
<a name="ln-127"></a>       <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span>
<a name="ln-128"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dery</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-129"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">derhy</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-130"></a>       <span class="k">end do</span>
<a name="ln-131"></a><span class="k">      end do</span>
<a name="ln-132"></a><span class="k">     end do</span>
<a name="ln-133"></a><span class="k">    case</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-134"></a>     <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span>
<a name="ln-135"></a>      <span class="n">kk</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-136"></a>      <span class="n">derz</span> <span class="o">=</span> <span class="n">loc_zg</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">imodz</span><span class="p">)</span>
<a name="ln-137"></a>      <span class="n">derhz</span> <span class="o">=</span> <span class="n">loc_zg</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">imodz</span><span class="p">)</span>
<a name="ln-138"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span>
<a name="ln-139"></a>       <span class="n">jj</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-140"></a>       <span class="n">dery</span> <span class="o">=</span> <span class="n">loc_yg</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">imody</span><span class="p">)</span>
<a name="ln-141"></a>       <span class="n">derhy</span> <span class="o">=</span> <span class="n">loc_yg</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">imody</span><span class="p">)</span>
<a name="ln-142"></a>       <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span>
<a name="ln-143"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dery</span><span class="o">*</span><span class="n">derz</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-144"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">derhy</span><span class="o">*</span><span class="n">derz</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-145"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">dery</span><span class="o">*</span><span class="n">derhz</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-146"></a>       <span class="k">end do</span>
<a name="ln-147"></a><span class="k">      end do</span>
<a name="ln-148"></a><span class="k">     end do</span>
<a name="ln-149"></a><span class="k">    end select</span>
<a name="ln-150"></a><span class="k">   end if</span>
<a name="ln-151"></a><span class="k">  end subroutine</span>
<a name="ln-152"></a>  <span class="c">!=================================</span>
<a name="ln-153"></a>  <span class="c">! END SECTION ON GRID DEFINED PARTICLE VARIABLES</span>
<a name="ln-154"></a>  <span class="c">!================================================</span>
<a name="ln-155"></a>  <span class="k">subroutine </span><span class="n">pfields_prepare</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">spr</span><span class="p">,</span> <span class="n">spl</span><span class="p">)</span>
<a name="ln-156"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ef</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-157"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nc</span><span class="p">,</span> <span class="n">spr</span><span class="p">,</span> <span class="n">spl</span>
<a name="ln-158"></a>   <span class="c">!===================</span>
<a name="ln-159"></a>   <span class="c">! Enter fields ef[i1:i2,j1,j2,k1,k2,1:nc)</span>
<a name="ln-160"></a>   <span class="c">! Exit fields ef[i1:i2,j1,j2,k1,k2,1:nc)</span>
<a name="ln-161"></a>   <span class="c">!===========================</span>
<a name="ln-162"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-163"></a><span class="k">    call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">spr</span><span class="p">,</span> <span class="n">spl</span><span class="p">)</span>
<a name="ln-164"></a>    <span class="c">!======================</span>
<a name="ln-165"></a>    <span class="c">! Adds point data =&gt; spl to the left spr to the right  </span>
<a name="ln-166"></a>    <span class="c">! Sets periodic BCs for</span>
<a name="ln-167"></a>    <span class="c">! iby,ibz,ibx =2</span>
<a name="ln-168"></a>    <span class="c">!==================</span>
<a name="ln-169"></a>   <span class="k">end if</span>
<a name="ln-170"></a><span class="k">   call </span><span class="n">field_xyzbd</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span>
<a name="ln-171"></a>   <span class="c">! extends for one point at the box boundaries</span>
<a name="ln-172"></a>   <span class="c">!==================================================</span>
<a name="ln-173"></a>  <span class="k">end subroutine</span>
<a name="ln-174"></a>  <span class="c">!================================</span>
<a name="ln-175"></a>  <span class="k">subroutine </span><span class="n">advance_lpf_fields</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">ibd</span><span class="p">)</span>
<a name="ln-176"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ef</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-177"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-178"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ibd</span>
<a name="ln-179"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">,</span> <span class="n">ik</span>
<a name="ln-180"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dth</span><span class="p">,</span> <span class="n">dt_lp</span>
<a name="ln-181"></a>
<a name="ln-182"></a>   <span class="n">dt_lp</span> <span class="o">=</span> <span class="n">dt_loc</span>
<a name="ln-183"></a>   <span class="n">dth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt_lp</span>
<a name="ln-184"></a>   <span class="c">!=======================</span>
<a name="ln-185"></a>   <span class="c">! A LPF order Lpf with time-centered source term</span>
<a name="ln-186"></a>   <span class="c">!=============================</span>
<a name="ln-187"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-188"></a><span class="k">    </span><span class="n">str</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-189"></a>    <span class="n">stl</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-190"></a>    <span class="k">call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">)</span>
<a name="ln-191"></a>    <span class="c">! To fill electric field data</span>
<a name="ln-192"></a>    <span class="c">! sends stl to the left,</span>
<a name="ln-193"></a>    <span class="c">! recvs stl points from right at (nyp+stl), (nzp+stl)</span>
<a name="ln-194"></a>   <span class="k">end if</span>
<a name="ln-195"></a>   <span class="c">!============== first substep dt/2 advance of B-field</span>
<a name="ln-196"></a>   <span class="k">call </span><span class="n">ef_bds</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">zero_dp</span><span class="p">,</span> <span class="n">ibd</span><span class="p">)</span>
<a name="ln-197"></a>   <span class="c">! Uses upper BCs of E fields: ibd=0 for inflow-outflow</span>
<a name="ln-198"></a>   <span class="c">!                             ibd=1 for symmetric</span>
<a name="ln-199"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-200"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">vbeam</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nfield</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-201"></a>    <span class="c">! Solves for one-half step backward advection B field explicit</span>
<a name="ln-202"></a>    <span class="c">! B^{n} =&gt; B^{n}+v_b*Dth[Dx]B^n  v_b &gt;0</span>
<a name="ln-203"></a>   <span class="k">end if</span>
<a name="ln-204"></a>   <span class="c">!==================================</span>
<a name="ln-205"></a>   <span class="c">! solves B^{n+1/2}= B^n -Dth[rot E]^n </span>
<a name="ln-206"></a>   <span class="c">!============================</span>
<a name="ln-207"></a>   <span class="k">call </span><span class="n">rote</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">)</span>
<a name="ln-208"></a>   <span class="c">!=============================</span>
<a name="ln-209"></a>   <span class="c">!============== central step for advance of E-field</span>
<a name="ln-210"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-211"></a><span class="k">    </span><span class="n">str</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-212"></a>    <span class="n">stl</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-213"></a>    <span class="k">call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nfield</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">)</span>
<a name="ln-214"></a>    <span class="c">! sends nyp+1-str to the right</span>
<a name="ln-215"></a>    <span class="c">! recvs str points from left at (1-str)</span>
<a name="ln-216"></a>   <span class="k">end if</span>
<a name="ln-217"></a>   <span class="c">!======================</span>
<a name="ln-218"></a>   <span class="k">call </span><span class="n">bf_bds</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dt_lp</span><span class="p">,</span> <span class="n">ibd</span><span class="p">)</span>
<a name="ln-219"></a>   <span class="c">! Uses lower BCs for B fields: ibd=0 for inflow-outflow</span>
<a name="ln-220"></a>   <span class="c">!                             ibd=1 for symmetric</span>
<a name="ln-221"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-222"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">vbeam</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-223"></a>    <span class="c">! Solves for half-step backward advection E field explicit</span>
<a name="ln-224"></a>    <span class="c">! E^{n} =&gt; E^{n}+v_b*Dth[Dx]E^n</span>
<a name="ln-225"></a>   <span class="k">end if</span>
<a name="ln-226"></a>   <span class="c">!=======================</span>
<a name="ln-227"></a>   <span class="c">! solves E^{n+1}= E^n +DT[rot B]^{n+1/2}- ompe*DT*J^{n+1/2} </span>
<a name="ln-228"></a>   <span class="c">!==================</span>
<a name="ln-229"></a>   <span class="k">call </span><span class="n">rotb</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dt_lp</span><span class="p">)</span>
<a name="ln-230"></a>   <span class="c">!===================</span>
<a name="ln-231"></a>   <span class="c">! adds currents</span>
<a name="ln-232"></a>   <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span>
<a name="ln-233"></a>    <span class="n">ef</span><span class="p">(</span><span class="n">ix1</span><span class="p">:</span><span class="n">ix2</span><span class="p">,</span> <span class="n">jy1</span><span class="p">:</span><span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">:</span><span class="n">kz2</span><span class="p">,</span> <span class="n">ik</span><span class="p">)</span> <span class="o">=</span> <span class="n">ef</span><span class="p">(</span><span class="n">ix1</span><span class="p">:</span><span class="n">ix2</span><span class="p">,</span> <span class="n">jy1</span><span class="p">:</span><span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">:</span><span class="n">kz2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-234"></a>      <span class="n">ik</span><span class="p">)</span> <span class="o">-</span> <span class="n">ompe</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">ix1</span><span class="p">:</span><span class="n">ix2</span><span class="p">,</span> <span class="n">jy1</span><span class="p">:</span><span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">:</span><span class="n">kz2</span><span class="p">,</span> <span class="n">ik</span><span class="p">)</span>
<a name="ln-235"></a>   <span class="k">end do</span>
<a name="ln-236"></a><span class="k">   if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-237"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">vbeam</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-238"></a>    <span class="c">! Solves for backward advection E field implicit</span>
<a name="ln-239"></a>    <span class="c">! E^{n+1} =&gt; E^{n}+v_b*Dth[Dx]E^{n+1}</span>
<a name="ln-240"></a>   <span class="k">end if</span>
<a name="ln-241"></a>   <span class="c">!============== second substep dt/2 advance of B-field</span>
<a name="ln-242"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-243"></a><span class="k">    </span><span class="n">str</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-244"></a>    <span class="n">stl</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-245"></a>    <span class="k">call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">)</span>
<a name="ln-246"></a>   <span class="k">end if</span>
<a name="ln-247"></a>   <span class="c">! E field gets stl points from right (nyp+stl), (nzp+stl)</span>
<a name="ln-248"></a>   <span class="k">call </span><span class="n">ef_bds</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dt_lp</span><span class="p">,</span> <span class="n">ibd</span><span class="p">)</span>
<a name="ln-249"></a>   <span class="c">! solves B^{n+1}= B^{n+1/2} -Dth[rot E]^{n+1} </span>
<a name="ln-250"></a>   <span class="c">!===================</span>
<a name="ln-251"></a>   <span class="k">call </span><span class="n">rote</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">)</span>
<a name="ln-252"></a>   <span class="c">!==============</span>
<a name="ln-253"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-254"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">vbeam</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nfield</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-255"></a>    <span class="c">! Solves for one-half step backward advection B field implicit</span>
<a name="ln-256"></a>    <span class="c">! B^{n+1} =&gt; B^{n+1/2}+v_b*Dth[Dx]B^{n+1}</span>
<a name="ln-257"></a>   <span class="k">end if</span>
<a name="ln-258"></a>   <span class="c">!===============</span>
<a name="ln-259"></a>  <span class="k">end subroutine</span>
<a name="ln-260"></a>  <span class="c">!======================</span>
<a name="ln-261"></a>  <span class="k">subroutine </span><span class="n">advance_lpf_envelope</span><span class="p">(</span><span class="n">curr</span><span class="p">,</span> <span class="n">evf</span><span class="p">,</span> <span class="n">omg</span><span class="p">)</span>
<a name="ln-262"></a>
<a name="ln-263"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="n">evf</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-264"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">omg</span>
<a name="ln-265"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-266"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">,</span> <span class="n">cind</span><span class="p">,</span> <span class="n">ib</span>
<a name="ln-267"></a>   <span class="c">!====== enter env(3:4)=A^{n-1} and env(1:2)= A^{n}</span>
<a name="ln-268"></a>   <span class="c">! enters jc(3)=&lt;wgh*n/gamp&gt; &gt;0</span>
<a name="ln-269"></a>   <span class="n">str</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-270"></a>   <span class="n">stl</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-271"></a>   <span class="c">!ord=2</span>
<a name="ln-272"></a>   <span class="n">cind</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">!cind=0 FFT cind=1 grid deriv</span>
<a name="ln-273"></a>   <span class="n">ib</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">!ib=1 implicit ib=2 optimazid explicit</span>
<a name="ln-274"></a>   <span class="c">!optimized advection scheme</span>
<a name="ln-275"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="n">ib</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-276"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-277"></a><span class="k">    call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">evf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">)</span>
<a name="ln-278"></a>   <span class="k">end if</span>
<a name="ln-279"></a><span class="k">   call </span><span class="n">env_bds</span><span class="p">(</span> <span class="n">evf</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span> <span class="p">)</span>
<a name="ln-280"></a>
<a name="ln-281"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span>
<a name="ln-282"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span>
<a name="ln-283"></a>     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span>
<a name="ln-284"></a>      <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">ompe</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">evf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-285"></a>      <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">ompe</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">evf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-286"></a>     <span class="k">end do</span>
<a name="ln-287"></a><span class="k">    end do</span>
<a name="ln-288"></a><span class="k">   end do</span>
<a name="ln-289"></a>   <span class="c">!  curr(1:2)=-ompe*chi*env(1:2)  the J_{env} source term</span>
<a name="ln-290"></a>   <span class="c">!==================================</span>
<a name="ln-291"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">ib</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-292"></a><span class="k">    call </span><span class="n">env_lpf_solve</span><span class="p">(</span><span class="n">jc</span><span class="p">,</span> <span class="n">evf</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">omg</span><span class="p">,</span> <span class="n">dt_loc</span><span class="p">)</span>
<a name="ln-293"></a>   <span class="k">else</span>
<a name="ln-294"></a>    <span class="c">!=================== second order in time full wave equation</span>
<a name="ln-295"></a>    <span class="k">call </span><span class="n">env_maxw_solve</span><span class="p">(</span><span class="n">jc</span><span class="p">,</span> <span class="n">evf</span><span class="p">,</span> <span class="n">omg</span><span class="p">,</span> <span class="n">dt_loc</span><span class="p">)</span>
<a name="ln-296"></a>   <span class="k">end if</span>
<a name="ln-297"></a>   <span class="c">! =================================</span>
<a name="ln-298"></a>  <span class="k">end subroutine</span>
<a name="ln-299"></a>  <span class="c">!========================================================</span>
<a name="ln-300"></a>
<a name="ln-301"></a>  <span class="k">subroutine </span><span class="n">wave_field_left_inject</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">x_left</span><span class="p">)</span>
<a name="ln-302"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ef</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-303"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x_left</span>
<a name="ln-304"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tnew</span><span class="p">,</span> <span class="n">xm</span>
<a name="ln-305"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">wmodel_id</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-306"></a>
<a name="ln-307"></a>   <span class="n">wmodel_id</span> <span class="o">=</span> <span class="n">model_id</span>
<a name="ln-308"></a>   <span class="n">xm</span> <span class="o">=</span> <span class="n">xmn</span>
<a name="ln-309"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">plane_wave</span><span class="p">)</span> <span class="n">wmodel_id</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-310"></a>   <span class="n">tnew</span> <span class="o">=</span> <span class="n">tnow</span> <span class="c">!Set inflow values [B_z{n}(i1-1/2) E_y{n}(i-1}</span>
<a name="ln-311"></a>   <span class="n">lp_inject</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-312"></a>   <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nb_laser</span>
<a name="ln-313"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lp_in</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">x_left</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-314"></a><span class="k">     if</span> <span class="p">(</span><span class="n">lp_end</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">xm</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-315"></a><span class="k">      </span><span class="n">lp_inject</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-316"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">model_id</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="k">call </span><span class="n">inflow_lp_fields</span><span class="p">(</span><span class="n">ebf</span><span class="p">,</span> <span class="n">lp_amp</span><span class="p">,</span> <span class="n">tnew</span><span class="p">,</span> <span class="n">t0_lp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-317"></a>        <span class="n">w0_x</span><span class="p">,</span> <span class="n">w0_y</span><span class="p">,</span> <span class="n">xf_loc</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span> <span class="n">oml</span><span class="p">,</span> <span class="n">wmodel_id</span><span class="p">,</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span><span class="p">)</span>
<a name="ln-318"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">model_id</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">call </span><span class="n">inflow_cp_fields</span><span class="p">(</span><span class="n">ebf</span><span class="p">,</span> <span class="n">lp_amp</span><span class="p">,</span> <span class="n">tnew</span><span class="p">,</span> <span class="n">t0_lp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-319"></a>        <span class="n">w0_x</span><span class="p">,</span> <span class="n">w0_y</span><span class="p">,</span> <span class="n">xf_loc</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span> <span class="n">wmodel_id</span><span class="p">,</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span><span class="p">)</span>
<a name="ln-320"></a>     <span class="k">end if</span>
<a name="ln-321"></a><span class="k">    end if</span>
<a name="ln-322"></a><span class="k">    </span><span class="n">lp_in</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">lp_in</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt_loc</span>
<a name="ln-323"></a>    <span class="n">lp_end</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">lp_end</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt_loc</span>
<a name="ln-324"></a>   <span class="k">end do</span>
<a name="ln-325"></a><span class="k">   if</span> <span class="p">(</span><span class="n">Two_color</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-326"></a><span class="k">    if</span> <span class="p">(</span><span class="n">lp_ionz_in</span> <span class="o">&lt;</span> <span class="n">x_left</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-327"></a><span class="k">     if</span> <span class="p">(</span><span class="n">lp_ionz_end</span> <span class="o">&gt;=</span> <span class="n">xm</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-328"></a><span class="k">      </span><span class="n">lp_inject</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-329"></a>      <span class="k">call </span><span class="n">inflow_lp_fields</span><span class="p">(</span><span class="n">ebf</span><span class="p">,</span> <span class="n">lp1_amp</span><span class="p">,</span> <span class="n">tnew</span><span class="p">,</span> <span class="n">t1_lp</span><span class="p">,</span> <span class="n">w1_x</span><span class="p">,</span> <span class="n">w1_y</span><span class="p">,</span> <span class="n">xf1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-330"></a>        <span class="n">om1</span><span class="p">,</span> <span class="n">model_id</span><span class="p">,</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span><span class="p">)</span>
<a name="ln-331"></a>     <span class="k">end if</span>
<a name="ln-332"></a><span class="k">    end if</span>
<a name="ln-333"></a><span class="k">    </span><span class="n">lp_ionz_in</span> <span class="o">=</span> <span class="n">lp_ionz_in</span> <span class="o">+</span> <span class="n">dt_loc</span>
<a name="ln-334"></a>    <span class="n">lp_ionz_end</span> <span class="o">=</span> <span class="n">lp_ionz_end</span> <span class="o">+</span> <span class="n">dt_loc</span>
<a name="ln-335"></a>   <span class="k">end if</span>
<a name="ln-336"></a><span class="k">  end subroutine</span>
<a name="ln-337"></a>  <span class="c">!===================================================</span>
<a name="ln-338"></a>  <span class="k">subroutine </span><span class="n">advect_bunch_fields</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">v_b</span><span class="p">)</span>
<a name="ln-339"></a>
<a name="ln-340"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fb</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-341"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v_b</span>
<a name="ln-342"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dth</span>
<a name="ln-343"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span>
<a name="ln-344"></a>
<a name="ln-345"></a>   <span class="n">dth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt_loc</span>
<a name="ln-346"></a>   <span class="c">!In 2D nfield=3 nbfield=4=nfield+1   in fb(4)=Jx[i+1/2,j,k] at t=0</span>
<a name="ln-347"></a>   <span class="c">!fb=[Ex,Ey,Ez,Jx,By,Bz]</span>
<a name="ln-348"></a>   <span class="c">!================================================</span>
<a name="ln-349"></a>   <span class="k">call </span><span class="n">fill_ebfield_xbdsdata</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nbfield</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-350"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">initial_time</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-351"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">v_b</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-352"></a>    <span class="n">fb</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">dt_loc</span><span class="o">*</span><span class="n">fb</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-353"></a>   <span class="k">end if</span>
<a name="ln-354"></a><span class="k">   call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="n">dt_loc</span><span class="p">,</span> <span class="n">v_b</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nbfield</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-355"></a>   <span class="k">do </span><span class="n">iz</span> <span class="o">=</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span>
<a name="ln-356"></a>    <span class="k">do </span><span class="n">iy</span> <span class="o">=</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span>
<a name="ln-357"></a>     <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span>
<a name="ln-358"></a>      <span class="n">curr</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">curr</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">fb</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-359"></a>     <span class="k">end do</span>
<a name="ln-360"></a><span class="k">    end do</span>
<a name="ln-361"></a><span class="k">   end do</span>
<a name="ln-362"></a>   <span class="c">! Subtracts from the longitudinal bunch current the advected initial bunch</span>
<a name="ln-363"></a>   <span class="c">! current  </span>
<a name="ln-364"></a>  <span class="k">end subroutine</span>
<a name="ln-365"></a>  <span class="c">!============================</span>
<a name="ln-366"></a> <span class="k">end module</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-01-29 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ALaDyn was developed by The ALaDyn Collaboration</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>