<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A High-Accuracy PIC Code for the Maxwell-Vlasov Equations">
    
    <meta name="author" content="The ALaDyn Collaboration" >
    <link rel="icon" href="../favicon.png">

    <title>util.f90 &ndash; ALaDyn</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ALaDyn <small>3.0.1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/aladyn.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/aladyn.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>util.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.4% of total for source files.">333 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/util.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">util.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/util.html">util</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/util.f90.html#src">util.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~util.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileutilf90EfferentGraph" width="321pt" height="52pt"
 viewBox="0.00 0.00 321.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~util.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~util.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 317,-48 317,4 -4,4"/>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~util.f90</title>
<polygon fill="none" stroke="#000000" points="313,-44 259,-44 259,-20 313,-20 313,-44"/>
<text text-anchor="middle" x="286" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">util.f90</text>
</g>
<!-- sourcefile~precision_def.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~precision_def.f90</title>
<g id="a_sourcefile~~util.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/precision_def.f90.html" xlink:title="precision_def.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="106,-44 0,-44 0,-20 106,-20 106,-44"/>
<text text-anchor="middle" x="53" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision_def.F90</text>
</a>
</g>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M258.7124,-32.5275C247.6304,-32.7172 234.7042,-32.9071 223,-33 187.0011,-33.2857 177.9994,-33.2022 142,-33 133.6703,-32.9532 124.9024,-32.8818 116.25,-32.7982"/>
<polygon fill="#ff0000" stroke="#ff0000" points="116.2145,-29.2977 106.1792,-32.6952 116.1429,-36.2974 116.2145,-29.2977"/>
</g>
<!-- sourcefile~code_util.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~code_util.f90</title>
<g id="a_sourcefile~~util.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/code_util.f90.html" xlink:title="code_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="223,-24 142,-24 142,0 223,0 223,-24"/>
<text text-anchor="middle" x="182.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">code_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M258.8066,-26.7452C250.8867,-25.2148 241.9678,-23.4914 233.0942,-21.7767"/>
<polygon fill="#ff0000" stroke="#ff0000" points="233.6331,-18.3161 223.1506,-19.8552 232.3049,-25.189 233.6331,-18.3161"/>
</g>
<!-- sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M141.8807,-18.2733C133.777,-19.5248 125.0848,-20.8672 116.4242,-22.2048"/>
<polygon fill="#00ffff" stroke="#00ffff" points="115.6578,-18.7815 106.3092,-23.7669 116.7263,-25.6995 115.6578,-18.7815"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~util.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileutilf90AfferentGraph" width="641pt" height="429pt"
 viewBox="0.00 0.00 641.00 429.14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~util.f90~~AfferentGraph" class="graph" transform="scale(.6468 .6468) rotate(0) translate(4 659.4593)">
<title>sourcefile~~util.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-659.4593 987,-659.4593 987,4 -4,4"/>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~util.f90</title>
<polygon fill="none" stroke="#000000" points="54,-325.9385 0,-325.9385 0,-301.9385 54,-301.9385 54,-325.9385"/>
<text text-anchor="middle" x="27" y="-311.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">util.f90</text>
</g>
<!-- sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~parallel.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/parallel.f90.html" xlink:title="parallel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="185.5,-345.9385 109.5,-345.9385 109.5,-321.9385 185.5,-321.9385 185.5,-345.9385"/>
<text text-anchor="middle" x="147.5" y="-331.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M109.373,-327.6104C94.9473,-325.2161 78.5566,-322.4956 64.2156,-320.1154"/>
<polygon fill="#ff0000" stroke="#ff0000" points="64.6309,-316.6365 54.1928,-318.4518 63.4847,-323.542 64.6309,-316.6365"/>
</g>
<!-- sourcefile~init_beam_part_distrib.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~init_beam_part_distrib.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/init_beam_part_distrib.f90.html" xlink:title="init_beam_part_distrib.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="690,-623.9385 539,-623.9385 539,-599.9385 690,-599.9385 690,-623.9385"/>
<text text-anchor="middle" x="614.5" y="-609.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_beam_part_distrib.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M578.2589,-623.9467C509.1113,-644.686 355.0829,-680.3101 241,-628.9385 185.8153,-604.0888 196.2696,-565.7769 147.5,-529.9385"/>
</g>
<!-- sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~mpi_field_interface.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/mpi_field_interface.f90.html" xlink:title="mpi_field_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="500,-501.9385 365,-501.9385 365,-477.9385 500,-477.9385 500,-501.9385"/>
<text text-anchor="middle" x="432.5" y="-487.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_field_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M554.1869,-599.8648C547.8086,-597.4136 541.6115,-594.4706 536,-590.9385 515.1932,-577.8419 517.3002,-566.407 500,-548.9385 485.851,-534.6519 468.7927,-519.7595 455.3646,-508.5109"/>
<polygon fill="#27ff00" stroke="#27ff00" points="457.4633,-505.7045 447.5313,-502.016 452.9954,-511.0931 457.4633,-505.7045"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~mpi_curr_interface.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/mpi_curr_interface.f90.html" xlink:title="mpi_curr_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="499,-581.9385 366,-581.9385 366,-557.9385 499,-557.9385 499,-581.9385"/>
<text text-anchor="middle" x="432.5" y="-567.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_curr_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~mpi_curr_interface.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M562.3461,-599.903C541.2133,-595.0262 516.6396,-589.3553 494.5922,-584.2675"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="495.1925,-580.8141 484.6615,-581.9758 493.6184,-587.6348 495.1925,-580.8141"/>
</g>
<!-- sourcefile~psolve.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~psolve.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node25"><a xlink:href=".././sourcefile/psolve.f90.html" xlink:title="psolve.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="466,-623.9385 399,-623.9385 399,-599.9385 466,-599.9385 466,-623.9385"/>
<text text-anchor="middle" x="432.5" y="-609.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psolve.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~psolve.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~psolve.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M538.8967,-611.9385C517.6364,-611.9385 495.2212,-611.9385 476.4765,-611.9385"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="476.471,-608.4386 466.471,-611.9385 476.471,-615.4386 476.471,-608.4386"/>
</g>
<!-- sourcefile~window.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~window.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/window.f90.html" xlink:title="window.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.5,-362.9385 578.5,-362.9385 578.5,-338.9385 650.5,-338.9385 650.5,-362.9385"/>
<text text-anchor="middle" x="614.5" y="-348.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">window.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M589.6725,-363.071C498.8705,-407.0867 187.9997,-554.5194 147.5,-529.9385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M147.5,-529.9385C79.7305,-480.1379 45.1265,-380.1132 32.6069,-335.8598"/>
<polygon fill="#ff0000" stroke="#ff0000" points="35.9569,-334.8406 29.9543,-326.1103 29.2025,-336.6784 35.9569,-334.8406"/>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M598.2146,-363.0785C582.3044,-374.9622 557.4232,-393.6094 536,-409.9385 508.5364,-430.8717 477.1845,-455.1604 456.2517,-471.4339"/>
<polygon fill="#27ff00" stroke="#27ff00" points="453.9741,-468.7713 448.2303,-477.6741 458.2723,-474.2964 453.9741,-468.7713"/>
</g>
<!-- sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~mpi_part_interface.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/mpi_part_interface.f90.html" xlink:title="mpi_part_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="499,-345.9385 366,-345.9385 366,-321.9385 499,-321.9385 499,-345.9385"/>
<text text-anchor="middle" x="432.5" y="-331.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_part_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M578.107,-347.5392C558.3196,-345.6909 533.0659,-343.332 509.1654,-341.0996"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="509.3073,-337.5977 499.0251,-340.1524 508.6562,-344.5673 509.3073,-337.5977"/>
</g>
<!-- sourcefile~run_data_info.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~run_data_info.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/run_data_info.f90.html" xlink:title="run_data_info.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="485.5,-265.9385 379.5,-265.9385 379.5,-241.9385 485.5,-241.9385 485.5,-265.9385"/>
<text text-anchor="middle" x="432.5" y="-251.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">run_data_info.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~run_data_info.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~run_data_info.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M591.8176,-338.8495C559.715,-321.7399 500.8811,-290.3833 464.3932,-270.9365"/>
<polygon fill="#ff0075" stroke="#ff0075" points="465.6528,-267.6418 455.1817,-266.0271 462.3604,-273.8192 465.6528,-267.6418"/>
</g>
<!-- sourcefile~ionize.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~ionize.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/ionize.f90.html" xlink:title="ionize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="646.5,-282.9385 582.5,-282.9385 582.5,-258.9385 646.5,-258.9385 646.5,-282.9385"/>
<text text-anchor="middle" x="614.5" y="-268.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ionize.f90</text>
</a>
</g>
</g>
<!-- sourcefile~ionize.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~ionize.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.4962,-273.2809C481.8083,-280.6504 171.8206,-303.3389 64.2372,-311.2131"/>
<polygon fill="#ff0000" stroke="#ff0000" points="63.896,-307.7286 54.1782,-311.9493 64.4071,-314.7099 63.896,-307.7286"/>
</g>
<!-- sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~env_evolve_in_time.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/env_evolve_in_time.f90.html" xlink:title="env_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="868.5,-402.9385 731.5,-402.9385 731.5,-378.9385 868.5,-378.9385 868.5,-402.9385"/>
<text text-anchor="middle" x="800" y="-388.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">env_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M791.7299,-403.1871C775.7171,-425.7473 738.0592,-473.4311 693,-493.9385 609.5176,-531.9331 193.0369,-562.7517 147.5,-529.9385"/>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M744.3439,-378.9372C717.612,-373.1729 685.9582,-366.3473 660.5968,-360.8785"/>
<polygon fill="#00ff00" stroke="#00ff00" points="661.0148,-357.3883 650.5017,-358.7017 659.5392,-364.231 661.0148,-357.3883"/>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M777.2903,-378.8742C763.191,-371.2056 744.8083,-360.8815 729,-350.9385 697.1469,-330.9038 661.8396,-305.7634 638.9692,-289.0683"/>
<polygon fill="#00ffff" stroke="#00ffff" points="640.9799,-286.2025 630.846,-283.1115 636.8404,-291.8475 640.9799,-286.2025"/>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M731.4369,-391.2328C677.709,-390.2131 601.3651,-385.9976 536,-371.9385 512.9472,-366.9802 488.1146,-357.9947 468.553,-350.0059"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="469.7,-346.6919 459.1236,-346.0664 467.0014,-353.1509 469.7,-346.6919"/>
</g>
<!-- sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~curr_and_fields_util.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node22"><a xlink:href=".././sourcefile/curr_and_fields_util.f90.html" xlink:title="curr_and_fields_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="682.5,-484.9385 546.5,-484.9385 546.5,-460.9385 682.5,-460.9385 682.5,-484.9385"/>
<text text-anchor="middle" x="614.5" y="-470.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">curr_and_fields_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M782.1716,-403.0104C761.5013,-416.5453 726.0314,-438.3698 693,-451.9385 687.8617,-454.0492 682.447,-456.0074 676.9624,-457.8101"/>
<polygon fill="#cbff00" stroke="#cbff00" points="675.5708,-454.5774 667.0593,-460.8864 677.6475,-461.2623 675.5708,-454.5774"/>
</g>
<!-- sourcefile~fluid_density_momenta.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~fluid_density_momenta.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node24"><a xlink:href=".././sourcefile/fluid_density_momenta.f90.html" xlink:title="fluid_density_momenta.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="693,-442.9385 536,-442.9385 536,-418.9385 693,-418.9385 693,-442.9385"/>
<text text-anchor="middle" x="614.5" y="-428.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fluid_density_momenta.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~fluid_density_momenta.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~fluid_density_momenta.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M744.3439,-402.9398C724.1677,-407.2905 701.1877,-412.2457 680.2256,-416.7659"/>
<polygon fill="#0066ff" stroke="#0066ff" points="679.4747,-413.3473 670.4372,-418.8766 680.9503,-420.19 679.4747,-413.3473"/>
</g>
<!-- sourcefile~init_part_distrib.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~init_part_distrib.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/init_part_distrib.f90.html" xlink:title="init_part_distrib.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="205,-206.9385 90,-206.9385 90,-182.9385 205,-182.9385 205,-206.9385"/>
<text text-anchor="middle" x="147.5" y="-192.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_part_distrib.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_part_distrib.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~init_part_distrib.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M135.0582,-207.2254C114.0233,-227.9984 71.2901,-270.1997 46.3274,-294.8517"/>
<polygon fill="#ff0000" stroke="#ff0000" points="43.8505,-292.3787 39.1946,-301.8957 48.7692,-297.3593 43.8505,-292.3787"/>
</g>
<!-- sourcefile~pic_dump.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~pic_dump.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/pic_dump.f90.html" xlink:title="pic_dump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="327.5,-226.9385 242.5,-226.9385 242.5,-202.9385 327.5,-202.9385 327.5,-226.9385"/>
<text text-anchor="middle" x="285" y="-212.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_dump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_dump.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~pic_dump.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.8633,-227.183C255.6584,-231.5149 247.7767,-236.6372 241,-241.9385 212.3084,-264.3837 182.9669,-294.6992 164.9899,-314.2862"/>
<polygon fill="#ff0000" stroke="#ff0000" points="162.369,-311.9661 158.238,-321.7225 167.5515,-316.6716 162.369,-311.9661"/>
</g>
<!-- sourcefile~start_all.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~start_all.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/start_all.f90.html" xlink:title="start_all.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="838.5,-225.9385 761.5,-225.9385 761.5,-201.9385 838.5,-201.9385 838.5,-225.9385"/>
<text text-anchor="middle" x="800" y="-211.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_all.F90</text>
</a>
</g>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~ionize.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~ionize.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M761.1131,-225.8876C730.4365,-235.3138 687.7297,-248.4366 656.3188,-258.0885"/>
<polygon fill="#00ffff" stroke="#00ffff" points="655.0778,-254.8083 646.547,-261.0912 657.134,-261.4995 655.0778,-254.8083"/>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~pic_dump.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~pic_dump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.2402,-212.7063C723.6885,-211.8035 665.1467,-211.1641 614.5,-213.9385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M614.5,-213.9385C516.906,-219.2847 402.8089,-217.94 337.7108,-216.4543"/>
<polygon fill="#ff0000" stroke="#ff0000" points="337.7743,-212.9549 327.6937,-216.2156 337.6075,-219.9529 337.7743,-212.9549"/>
</g>
<!-- sourcefile~pic_in.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~pic_in.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/pic_in.f90.html" xlink:title="pic_in.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="646.5,-185.9385 582.5,-185.9385 582.5,-161.9385 646.5,-161.9385 646.5,-185.9385"/>
<text text-anchor="middle" x="614.5" y="-171.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_in.f90</text>
</a>
</g>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~pic_in.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~pic_in.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M761.1131,-205.5532C730.5693,-198.9669 688.0993,-189.809 656.7274,-183.0441"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="657.0601,-179.5355 646.547,-180.8489 655.5845,-186.3782 657.0601,-179.5355"/>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~run_data_info.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~run_data_info.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M614.5,-213.9385C568.1428,-216.478 516.5662,-228.7402 480.1896,-239.0264"/>
<polygon fill="#ff0075" stroke="#ff0075" points="478.9874,-235.7304 470.3496,-241.8655 480.928,-242.4561 478.9874,-235.7304"/>
</g>
<!-- sourcefile~prl_fft.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~prl_fft.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/prl_fft.f90.html" xlink:title="prl_fft.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="317,-619.9385 253,-619.9385 253,-595.9385 317,-595.9385 317,-619.9385"/>
<text text-anchor="middle" x="285" y="-605.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">prl_fft.f90</text>
</a>
</g>
</g>
<!-- sourcefile~prl_fft.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~prl_fft.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257.6801,-595.6747C251.5757,-591.95 245.5664,-587.373 241,-581.9385 210.8143,-546.0143 169.3812,-409.926 153.7805,-356.0713"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.0614,-354.8158 150.9361,-346.1711 150.3336,-356.7488 157.0614,-354.8158"/>
</g>
<!-- sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~grid_fields.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/grid_fields.f90.html" xlink:title="grid_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="329,-385.9385 241,-385.9385 241,-361.9385 329,-361.9385 329,-385.9385"/>
<text text-anchor="middle" x="285" y="-371.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_fields.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~grid_fields.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M243.7455,-361.9372C228.6909,-357.5577 211.5304,-352.5655 195.9095,-348.0213"/>
<polygon fill="#ff0000" stroke="#ff0000" points="196.4839,-344.5433 185.9042,-345.1106 194.5285,-351.2647 196.4839,-344.5433"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M405.6564,-477.8404C368.1372,-460.6584 298.1909,-427.6297 241,-394.9385 217.4294,-381.4652 191.6591,-364.4728 173.1535,-351.8464"/>
<polygon fill="#ff0000" stroke="#ff0000" points="174.9179,-348.8122 164.694,-346.0333 170.9535,-354.5813 174.9179,-348.8122"/>
</g>
<!-- sourcefile~pic_in.f90&#45;&gt;sourcefile~init_part_distrib.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~pic_in.f90&#45;&gt;sourcefile~init_part_distrib.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M582.1427,-166.383C559.3286,-161.4553 527.9765,-155.4828 500,-152.9385 440.2466,-147.5043 424.7273,-147.2245 365,-152.9385 310.3044,-158.1711 248.9154,-170.6447 205.3398,-180.6473"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="204.4411,-177.2627 195.4927,-182.9351 206.0253,-184.0811 204.4411,-177.2627"/>
</g>
<!-- sourcefile~init_laser_field.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~init_laser_field.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node23"><a xlink:href=".././sourcefile/init_laser_field.f90.html" xlink:title="init_laser_field.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="487,-185.9385 378,-185.9385 378,-161.9385 487,-161.9385 487,-185.9385"/>
<text text-anchor="middle" x="432.5" y="-171.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_laser_field.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_in.f90&#45;&gt;sourcefile~init_laser_field.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~pic_in.f90&#45;&gt;sourcefile~init_laser_field.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M582.381,-173.9385C558.8294,-173.9385 526.0566,-173.9385 497.1609,-173.9385"/>
<polygon fill="#00ff66" stroke="#00ff66" points="497.1234,-170.4386 487.1233,-173.9385 497.1233,-177.4386 497.1234,-170.4386"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M413.7739,-557.783C378.5741,-534.6072 300.7106,-481.7758 241,-429.9385 212.7428,-405.4072 183.0846,-373.8063 164.9401,-353.7025"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.4078,-351.2118 158.1297,-346.0963 162.1927,-355.8811 167.4078,-351.2118"/>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M365.6802,-333.9385C313.6745,-333.9385 242.7237,-333.9385 196.042,-333.9385"/>
<polygon fill="#ff0000" stroke="#ff0000" points="195.8855,-330.4386 185.8855,-333.9385 195.8854,-337.4386 195.8855,-330.4386"/>
</g>
<!-- sourcefile~aladyn.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~aladyn.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/aladyn.f90.html" xlink:title="ALaDyn.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="983,-225.9385 907,-225.9385 907,-201.9385 983,-201.9385 983,-225.9385"/>
<text text-anchor="middle" x="945" y="-211.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ALaDyn.F90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~init_beam_part_distrib.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~init_beam_part_distrib.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M800,-590.9385C771.3091,-610.6434 734.046,-617.5116 700.4517,-618.8453"/>
<polygon fill="#ffff00" stroke="#ffff00" points="700.0713,-615.3533 690.1572,-619.0897 700.2375,-622.3513 700.0713,-615.3533"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M941.1019,-225.969C932.2635,-251.6826 908.5091,-312.7553 871,-350.9385 861.8468,-360.2562 850.0617,-368.0556 838.7334,-374.2199"/>
<polygon fill="#0000ff" stroke="#0000ff" points="837.0979,-371.1252 829.8052,-378.8108 840.299,-377.3504 837.0979,-371.1252"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~start_all.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~start_all.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M906.903,-213.9385C889.1328,-213.9385 867.7729,-213.9385 848.8333,-213.9385"/>
<polygon fill="#ff7500" stroke="#ff7500" points="848.5985,-210.4386 838.5985,-213.9385 848.5984,-217.4386 848.5985,-210.4386"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~pic_evolve_in_time.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/pic_evolve_in_time.f90.html" xlink:title="pic_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="866.5,-341.9385 733.5,-341.9385 733.5,-317.9385 866.5,-317.9385 866.5,-341.9385"/>
<text text-anchor="middle" x="800" y="-327.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M929.7565,-226.1333C904.2348,-246.5506 852.7235,-287.7597 822.8513,-311.6574"/>
<polygon fill="#2700ff" stroke="#2700ff" points="820.6615,-308.9271 815.0392,-317.9071 825.0344,-314.3932 820.6615,-308.9271"/>
</g>
<!-- sourcefile~pic_out.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~pic_out.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/pic_out.f90.html" xlink:title="pic_out.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="320.5,-107.9385 249.5,-107.9385 249.5,-83.9385 320.5,-83.9385 320.5,-107.9385"/>
<text text-anchor="middle" x="285" y="-93.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_out.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_out.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_out.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M906.7018,-202.6331C895.2535,-199.3719 882.649,-195.8979 871,-192.9385 792.4123,-172.9738 772.7751,-167.4491 693,-152.9385 562.285,-129.1622 406.4418,-109.8786 330.7657,-101.0869"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="330.966,-97.5868 320.6305,-99.9166 330.163,-104.5406 330.966,-97.5868"/>
</g>
<!-- sourcefile~diag_part_and_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~diag_part_and_fields.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/diag_part_and_fields.f90.html" xlink:title="diag_part_and_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="871,-67.9385 729,-67.9385 729,-43.9385 871,-43.9385 871,-67.9385"/>
<text text-anchor="middle" x="800" y="-53.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">diag_part_and_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~diag_part_and_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~diag_part_and_fields.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M941.4244,-201.8755C933.2125,-176.1843 910.6033,-115.6658 871,-81.9385 866.7526,-78.3213 861.9586,-75.1885 856.9166,-72.4791"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="858.1696,-69.1988 847.6377,-68.0459 855.1519,-75.5149 858.1696,-69.1988"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~run_data_info.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~run_data_info.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M944.3032,-201.52C941.6554,-167.6862 929.1435,-73.8177 871,-34.9385 818.5371,.1422 789.7503,-17.8386 729,-34.9385 632.2211,-62.1797 612.542,-87.7498 536,-152.9385 517.2828,-168.8794 517.3002,-177.47 500,-194.9385 485.851,-209.2251 468.7927,-224.1175 455.3646,-235.3661"/>
<polygon fill="#ff0075" stroke="#ff0075" points="452.9954,-232.7839 447.5313,-241.861 457.4633,-238.1725 452.9954,-232.7839"/>
</g>
<!-- sourcefile~pic_out_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~pic_out_util.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/pic_out_util.f90.html" xlink:title="pic_out_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="661,-581.9385 568,-581.9385 568,-557.9385 661,-557.9385 661,-581.9385"/>
<text text-anchor="middle" x="614.5" y="-567.5385" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_out_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_out_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_out_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M942.2753,-226.0121C928.595,-285.457 865.4645,-545.9775 800,-590.9385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M800,-590.9385C779.5901,-604.956 717.4661,-594.7609 670.6907,-584.2618"/>
<polygon fill="#ff0000" stroke="#ff0000" points="671.1949,-580.7864 660.6647,-581.9552 669.6254,-587.6082 671.1949,-580.7864"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M733.2923,-337.4903C709.2612,-340.2108 682.692,-343.2187 660.7853,-345.6987"/>
<polygon fill="#00ff00" stroke="#00ff00" points="660.2994,-342.2312 650.7566,-346.834 661.0869,-349.1868 660.2994,-342.2312"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M762.0137,-317.8566C731.3114,-308.0915 688.136,-294.3591 656.4264,-284.2736"/>
<polygon fill="#00ffff" stroke="#00ffff" points="657.1548,-280.8325 646.5643,-281.1369 655.0331,-287.5033 657.1548,-280.8325"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M733.2654,-329.2267C679.8873,-328.8291 603.1333,-328.6417 536,-329.9385 527.3133,-330.1063 518.2188,-330.3532 509.1798,-330.6435"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="508.8985,-327.1509 499.0228,-330.9876 509.1356,-334.1469 508.8985,-327.1509"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M769.0477,-341.9976C755.3558,-348.5796 739.9192,-357.8766 729,-369.9385 702.2882,-399.4458 723.2037,-426.0168 693,-451.9385 691.4744,-453.2478 689.8755,-454.4764 688.2161,-455.6292"/>
<polygon fill="#cbff00" stroke="#cbff00" points="686.31,-452.6899 679.4744,-460.7847 689.866,-458.7194 686.31,-452.6899"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~fluid_density_momenta.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~fluid_density_momenta.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M777.6244,-342.1215C744.6671,-360.0659 682.9508,-393.6688 645.6038,-414.0033"/>
<polygon fill="#0066ff" stroke="#0066ff" points="643.7751,-411.0137 636.6662,-418.8696 647.1225,-417.1615 643.7751,-411.0137"/>
</g>
<!-- sourcefile~pic_out.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~pic_out.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.9923,-108.0682C255.8795,-146.3434 187.3967,-264.881 159.5049,-313.159"/>
<polygon fill="#ff0000" stroke="#ff0000" points="156.4655,-311.4235 154.4936,-321.8333 162.5267,-314.9253 156.4655,-311.4235"/>
</g>
<!-- sourcefile~diag_part_and_fields.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~diag_part_and_fields.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M763.6153,-43.9135C666.4458,-14.2875 397.6257,51.0458 241,-74.9385 190.6033,-115.4759 227.281,-155.2206 205,-215.9385 192.0856,-251.1315 172.0261,-289.819 159.3365,-312.9786"/>
<polygon fill="#ff0000" stroke="#ff0000" points="156.1793,-311.455 154.3916,-321.898 162.3014,-314.8491 156.1793,-311.455"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M389.524,-266.0019C337.4088,-280.6308 249.8213,-305.2167 195.5293,-320.4566"/>
<polygon fill="#ff0000" stroke="#ff0000" points="194.4773,-317.1165 185.7953,-323.1889 196.3691,-323.8561 194.4773,-317.1165"/>
</g>
<!-- sourcefile~pic_out_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~pic_out_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M586.8581,-557.7882C555.4083,-543.9641 503.9149,-521.3297 469.1401,-506.044"/>
<polygon fill="#27ff00" stroke="#27ff00" points="470.3688,-502.7609 459.8057,-501.941 467.5519,-509.1692 470.3688,-502.7609"/>
</g>
<!-- sourcefile~pic_out_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~pic_out_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M567.6305,-569.9385C549.8721,-569.9385 529.1552,-569.9385 509.3542,-569.9385"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="509.1037,-566.4386 499.1036,-569.9385 509.1036,-573.4386 509.1037,-566.4386"/>
</g>
<!-- sourcefile~pic_out_util.f90&#45;&gt;sourcefile~psolve.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~pic_out_util.f90&#45;&gt;sourcefile~psolve.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M567.6305,-580.7545C539.3957,-587.2703 503.6823,-595.5118 476.0622,-601.8857"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="475.2382,-598.4838 466.2813,-604.1428 476.8123,-605.3045 475.2382,-598.4838"/>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M546.2867,-461.2339C495.4273,-451.451 424.7317,-435.6021 365,-413.9385 347.8761,-407.728 329.6479,-398.8104 314.9229,-390.9706"/>
<polygon fill="#9cff00" stroke="#9cff00" points="316.257,-387.7122 305.7992,-386.0136 312.9152,-393.863 316.257,-387.7122"/>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M546.4711,-479.2928C534.6392,-480.398 522.2529,-481.555 510.1858,-482.6821"/>
<polygon fill="#27ff00" stroke="#27ff00" points="509.7749,-479.2052 500.1438,-483.6201 510.426,-486.1748 509.7749,-479.2052"/>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M591.8176,-485.0275C559.715,-502.1371 500.8811,-533.4937 464.3932,-552.9405"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="462.3604,-550.0578 455.1817,-557.8499 465.6528,-556.2352 462.3604,-550.0578"/>
</g>
<!-- sourcefile~init_laser_field.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~init_laser_field.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M415.8223,-185.9446C401.2235,-197.0158 380.053,-214.4862 365,-232.9385 333.6483,-271.3701 307.5515,-323.7047 294.3311,-352.5905"/>
<polygon fill="#9cff00" stroke="#9cff00" points="291.113,-351.2128 290.2043,-361.7686 297.4974,-354.0834 291.113,-351.2128"/>
</g>
<!-- sourcefile~fluid_density_momenta.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~fluid_density_momenta.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M545.0241,-418.9199C483.7009,-408.3117 395.5456,-393.0617 339.276,-383.3277"/>
<polygon fill="#9cff00" stroke="#9cff00" points="339.6042,-379.8325 329.154,-381.5767 338.411,-386.7301 339.6042,-379.8325"/>
</g>
<!-- sourcefile~fluid_density_momenta.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~fluid_density_momenta.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M566.5605,-443.024C556.4202,-445.7865 545.8182,-448.8299 536,-451.9385 514.8657,-458.63 491.6712,-467.0442 472.6059,-474.2529"/>
<polygon fill="#27ff00" stroke="#27ff00" points="471.1426,-471.0649 463.0451,-477.8972 473.6359,-477.6059 471.1426,-471.0649"/>
</g>
<!-- sourcefile~psolve.f90&#45;&gt;sourcefile~prl_fft.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~psolve.f90&#45;&gt;sourcefile~prl_fft.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M398.6605,-611.0208C377.4186,-610.4448 349.8554,-609.6973 327.1922,-609.0827"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="327.2557,-605.5832 317.1645,-608.8108 327.0659,-612.5807 327.2557,-605.5832"/>
</g>
<!-- sourcefile~psolve.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~psolve.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M398.8102,-607.7296C386.8832,-604.7432 374.1661,-599.6435 365,-590.9385 308.3534,-537.1412 291.6015,-439.7736 286.8236,-396.1381"/>
<polygon fill="#9cff00" stroke="#9cff00" points="290.2914,-395.6381 285.8296,-386.0285 283.3249,-396.3231 290.2914,-395.6381"/>
</g>
</g>
</svg>
</div><script>var pansourcefileutilf90AfferentGraph = svgPanZoom('#sourcefileutilf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/util.html">util</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/util.f90.html#src">util.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-2"></a><span class="c">!                            Copyright 2008-2020  The ALaDyn Collaboration                            !</span>
<a name="ln-3"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-6"></a><span class="c">!  This file is part of ALaDyn.                                                                       !</span>
<a name="ln-7"></a><span class="c">!                                                                                                     !</span>
<a name="ln-8"></a><span class="c">!  ALaDyn is free software: you can redistribute it and/or modify                                     !</span>
<a name="ln-9"></a><span class="c">!  it under the terms of the GNU General Public License as published by                               !</span>
<a name="ln-10"></a><span class="c">!  the Free Software Foundation, either version 3 of the License, or                                  !</span>
<a name="ln-11"></a><span class="c">!  (at your option) any later version.                                                                !</span>
<a name="ln-12"></a><span class="c">!                                                                                                     !</span>
<a name="ln-13"></a><span class="c">!  ALaDyn is distributed in the hope that it will be useful,                                          !</span>
<a name="ln-14"></a><span class="c">!  but WITHOUT ANY WARRANTY; without even the implied warranty of                                     !</span>
<a name="ln-15"></a><span class="c">!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                      !</span>
<a name="ln-16"></a><span class="c">!  GNU General Public License for more details.                                                       !</span>
<a name="ln-17"></a><span class="c">!                                                                                                     !</span>
<a name="ln-18"></a><span class="c">!  You should have received a copy of the GNU General Public License                                  !</span>
<a name="ln-19"></a><span class="c">!  along with ALaDyn.  If not, see &lt;http://www.gnu.org/licenses/&gt;.                                    !</span>
<a name="ln-20"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-21"></a>
<a name="ln-22"></a> <span class="k">module </span><span class="n">util</span>
<a name="ln-23"></a>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">precision_def</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">code_util</span>
<a name="ln-26"></a>
<a name="ln-27"></a>  <span class="k">implicit none</span>
<a name="ln-28"></a><span class="k">  private</span>
<a name="ln-29"></a><span class="k">  public</span> <span class="kd">::</span> <span class="n">gasdev</span><span class="p">,</span> <span class="n">init_random_seed</span><span class="p">,</span> <span class="n">bunch_gen</span>
<a name="ln-30"></a>
<a name="ln-31"></a> <span class="k">contains</span>
<a name="ln-32"></a>
<a name="ln-33"></a><span class="k">  subroutine </span><span class="n">init_random_seed</span><span class="p">(</span><span class="n">myrank</span><span class="p">)</span>
<a name="ln-34"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myrank</span>
<a name="ln-35"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">seed</span><span class="p">(:)</span>
<a name="ln-36"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">un</span><span class="p">,</span> <span class="n">istat</span><span class="p">,</span> <span class="n">dt</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">pid</span><span class="p">,</span> <span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">s</span>
<a name="ln-37"></a>   <span class="kt">integer</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">count</span><span class="p">,</span> <span class="n">tms</span>
<a name="ln-38"></a>
<a name="ln-39"></a>   <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-40"></a>   <span class="k">call </span><span class="nb">random_seed</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<a name="ln-41"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">seed</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a name="ln-42"></a>
<a name="ln-43"></a>   <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">l_disable_rng_seed</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-44"></a><span class="k">    </span><span class="n">un</span> <span class="o">=</span> <span class="mi">123</span>
<a name="ln-45"></a>    <span class="c">! First try if the OS provides a random number generator</span>
<a name="ln-46"></a>    <span class="k">open</span> <span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">un</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;/dev/urandom&#39;</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-47"></a>      <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>
<a name="ln-48"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">istat</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-49"></a><span class="k">     read</span> <span class="p">(</span><span class="n">un</span><span class="p">)</span> <span class="n">seed</span>
<a name="ln-50"></a>     <span class="k">close</span> <span class="p">(</span><span class="n">un</span><span class="p">)</span>
<a name="ln-51"></a>    <span class="k">else</span>
<a name="ln-52"></a>     <span class="c">! Fallback to XOR:ing the current time and pid. The PID is</span>
<a name="ln-53"></a>     <span class="c">! useful in case one launches multiple instances of the same</span>
<a name="ln-54"></a>     <span class="c">! program in parallel.</span>
<a name="ln-55"></a>     <span class="k">call </span><span class="nb">system_clock</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span>
<a name="ln-56"></a>     <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-57"></a><span class="k">      </span><span class="n">t</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="nb">count</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-58"></a>     <span class="k">else</span>
<a name="ln-59"></a><span class="k">      call </span><span class="nb">date_and_time</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-60"></a>      <span class="n">tms</span> <span class="o">=</span> <span class="p">(</span><span class="n">dt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1970</span><span class="p">)</span><span class="o">*</span><span class="mi">365</span><span class="err">_</span><span class="mi">8</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">31</span><span class="err">_</span><span class="mi">8</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="p">&amp;</span>
<a name="ln-61"></a>        <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-62"></a>        <span class="n">dt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-63"></a>      <span class="n">t</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">tms</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-64"></a>     <span class="k">end if</span>
<a name="ln-65"></a><span class="k">     </span><span class="n">s</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-66"></a>     <span class="n">pid</span> <span class="o">=</span> <span class="n">myrank</span> <span class="o">+</span> <span class="mi">1099279</span> <span class="c">! Add a prime</span>
<a name="ln-67"></a>     <span class="n">s</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
<a name="ln-68"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-69"></a><span class="k">      </span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">36269</span>
<a name="ln-70"></a>      <span class="n">seed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">72551</span>
<a name="ln-71"></a>      <span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">pid</span>
<a name="ln-72"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-73"></a><span class="k">       </span><span class="n">seed</span><span class="p">(</span><span class="mi">4</span><span class="p">:)</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="mi">37</span><span class="o">*</span> <span class="p">[</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="p">]</span>
<a name="ln-74"></a>      <span class="k">end if</span>
<a name="ln-75"></a><span class="k">     else</span>
<a name="ln-76"></a><span class="k">      </span><span class="n">seed</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="mi">37</span><span class="o">*</span> <span class="p">[</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">]</span>
<a name="ln-77"></a>     <span class="k">end if</span>
<a name="ln-78"></a><span class="k">    end if</span>
<a name="ln-79"></a><span class="k">   else</span>
<a name="ln-80"></a><span class="k">    </span><span class="n">seed</span> <span class="o">=</span> <span class="n">myrank</span>
<a name="ln-81"></a>   <span class="k">end if</span>
<a name="ln-82"></a><span class="k">   call </span><span class="nb">random_seed</span><span class="p">(</span><span class="n">put</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
<a name="ln-83"></a>  <span class="k">end subroutine</span>
<a name="ln-84"></a>  <span class="c">!========================</span>
<a name="ln-85"></a>
<a name="ln-86"></a>  <span class="k">subroutine </span><span class="n">gasdev</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<a name="ln-87"></a>
<a name="ln-88"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dev</span>
<a name="ln-89"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">rsq</span>
<a name="ln-90"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">g</span>
<a name="ln-91"></a>   <span class="kt">logical</span><span class="p">,</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">gaus_store</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-92"></a>
<a name="ln-93"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">gaus_store</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-94"></a><span class="k">    </span><span class="n">dev</span> <span class="o">=</span> <span class="n">g</span>
<a name="ln-95"></a>    <span class="n">gaus_store</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-96"></a>   <span class="k">else</span>
<a name="ln-97"></a><span class="k">    do</span>
<a name="ln-98"></a><span class="k">     call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<a name="ln-99"></a>     <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<a name="ln-100"></a>     <span class="n">v1</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v1</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-101"></a>     <span class="n">v2</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v2</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-102"></a>     <span class="n">rsq</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span><span class="o">*</span><span class="n">v2</span>
<a name="ln-103"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">rsq</span><span class="o">&lt;</span><span class="mf">1.0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-104"></a><span class="k">    end do</span>
<a name="ln-105"></a><span class="k">    </span><span class="n">rsq</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">rsq</span><span class="p">)</span><span class="o">/</span><span class="n">rsq</span><span class="p">)</span>
<a name="ln-106"></a>    <span class="n">dev</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">rsq</span>
<a name="ln-107"></a>    <span class="n">g</span> <span class="o">=</span> <span class="n">v2</span><span class="o">*</span><span class="n">rsq</span>
<a name="ln-108"></a>    <span class="n">gaus_store</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-109"></a>   <span class="k">end if</span>
<a name="ln-110"></a><span class="k">  end subroutine</span>
<a name="ln-111"></a>
<a name="ln-112"></a>  <span class="c">!===============================</span>
<a name="ln-113"></a>
<a name="ln-114"></a>  <span class="k">subroutine </span><span class="n">sort</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">np</span><span class="p">)</span>
<a name="ln-115"></a>
<a name="ln-116"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">part</span><span class="p">(:)</span>
<a name="ln-117"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span>
<a name="ln-118"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ir</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">jstack</span>
<a name="ln-119"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">nstack</span> <span class="o">=</span> <span class="mi">50</span>
<a name="ln-120"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
<a name="ln-121"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istack</span><span class="p">(</span><span class="n">nstack</span><span class="p">)</span>
<a name="ln-122"></a>
<a name="ln-123"></a>   <span class="n">jstack</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-124"></a>   <span class="n">ir</span> <span class="o">=</span> <span class="n">np</span>
<a name="ln-125"></a>   <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-126"></a>   <span class="k">do</span>
<a name="ln-127"></a><span class="k">    if</span> <span class="p">(</span><span class="n">ir</span><span class="o">-</span><span class="n">l</span><span class="o">&lt;</span><span class="n">m</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-128"></a><span class="k">     do </span><span class="n">j</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ir</span>
<a name="ln-129"></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-130"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-131"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">a</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-132"></a><span class="k">       </span><span class="n">part</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-133"></a>      <span class="k">end do</span>
<a name="ln-134"></a><span class="k">      </span><span class="n">part</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-135"></a>     <span class="k">end do</span>
<a name="ln-136"></a><span class="k">     if</span> <span class="p">(</span><span class="n">jstack</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-137"></a><span class="k">     </span><span class="n">ir</span> <span class="o">=</span> <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span>
<a name="ln-138"></a>     <span class="n">l</span> <span class="o">=</span> <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-139"></a>     <span class="n">jstack</span> <span class="o">=</span> <span class="n">jstack</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-140"></a>    <span class="k">else</span>
<a name="ln-141"></a><span class="k">     </span><span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">ir</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-142"></a>     <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-143"></a>
<a name="ln-144"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">&gt;</span><span class="n">part</span><span class="p">(</span><span class="n">ir</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ir</span><span class="p">)</span>
<a name="ln-145"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">part</span><span class="p">(</span><span class="n">ir</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ir</span><span class="p">)</span>
<a name="ln-146"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">&gt;</span><span class="n">part</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-147"></a>
<a name="ln-148"></a>     <span class="n">i</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-149"></a>     <span class="n">j</span> <span class="o">=</span> <span class="n">ir</span>
<a name="ln-150"></a>     <span class="n">a</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-151"></a>     <span class="k">do</span>
<a name="ln-152"></a><span class="k">      do</span>
<a name="ln-153"></a><span class="k">       </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-154"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">a</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-155"></a><span class="k">      end do</span>
<a name="ln-156"></a><span class="k">      do</span>
<a name="ln-157"></a><span class="k">       </span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-158"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">a</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-159"></a><span class="k">      end do</span>
<a name="ln-160"></a><span class="k">      if</span> <span class="p">(</span><span class="n">j</span><span class="o">&lt;</span><span class="n">i</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-161"></a><span class="k">      call </span><span class="n">swap</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-162"></a>     <span class="k">end do</span>
<a name="ln-163"></a><span class="k">     </span><span class="n">part</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-164"></a>     <span class="n">part</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-165"></a>     <span class="n">jstack</span> <span class="o">=</span> <span class="n">jstack</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-166"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">jstack</span><span class="o">&gt;</span><span class="n">nstack</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-167"></a><span class="k">     if</span> <span class="p">(</span><span class="n">ir</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;=</span><span class="n">j</span><span class="o">-</span><span class="n">l</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-168"></a><span class="k">      </span><span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span> <span class="o">=</span> <span class="n">ir</span>
<a name="ln-169"></a>      <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-170"></a>      <span class="n">ir</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-171"></a>     <span class="k">else</span>
<a name="ln-172"></a><span class="k">      </span><span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-173"></a>      <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-174"></a>      <span class="n">l</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-175"></a>     <span class="k">end if</span>
<a name="ln-176"></a><span class="k">    end if</span>
<a name="ln-177"></a><span class="k">   end do</span>
<a name="ln-178"></a>
<a name="ln-179"></a><span class="k">  contains</span>
<a name="ln-180"></a>
<a name="ln-181"></a><span class="k">   subroutine </span><span class="n">swap</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">)</span>
<a name="ln-182"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-183"></a>    <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-184"></a>
<a name="ln-185"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
<a name="ln-186"></a>    <span class="n">part</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span>
<a name="ln-187"></a>    <span class="n">part</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span>
<a name="ln-188"></a>
<a name="ln-189"></a>   <span class="k">end subroutine</span>
<a name="ln-190"></a>
<a name="ln-191"></a><span class="k">  end subroutine</span>
<a name="ln-192"></a>
<a name="ln-193"></a>  <span class="c">!=========================</span>
<a name="ln-194"></a>
<a name="ln-195"></a>  <span class="k">subroutine </span><span class="n">vsort</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">ndv</span><span class="p">,</span> <span class="n">dir</span><span class="p">)</span>
<a name="ln-196"></a>
<a name="ln-197"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">part</span><span class="p">(:,</span> <span class="p">:)</span>
<a name="ln-198"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span><span class="p">,</span> <span class="n">ndv</span><span class="p">,</span> <span class="n">dir</span>
<a name="ln-199"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ir</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">jstack</span>
<a name="ln-200"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">nstack</span> <span class="o">=</span> <span class="mi">50</span>
<a name="ln-201"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">(</span><span class="n">ndv</span><span class="p">),</span> <span class="n">temp</span><span class="p">(</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-202"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istack</span><span class="p">(</span><span class="n">nstack</span><span class="p">)</span>
<a name="ln-203"></a>
<a name="ln-204"></a>   <span class="n">jstack</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-205"></a>   <span class="n">ir</span> <span class="o">=</span> <span class="n">np</span>
<a name="ln-206"></a>   <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-207"></a>   <span class="k">do</span>
<a name="ln-208"></a><span class="k">    if</span> <span class="p">(</span><span class="n">ir</span><span class="o">-</span><span class="n">l</span><span class="o">&lt;</span><span class="n">m</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-209"></a><span class="k">     do </span><span class="n">j</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ir</span>
<a name="ln-210"></a>      <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-211"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-212"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">a</span><span class="p">(</span><span class="n">dir</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-213"></a><span class="k">       </span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a name="ln-214"></a>      <span class="k">end do</span>
<a name="ln-215"></a><span class="k">      </span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-216"></a>     <span class="k">end do</span>
<a name="ln-217"></a><span class="k">     if</span> <span class="p">(</span><span class="n">jstack</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-218"></a><span class="k">     </span><span class="n">ir</span> <span class="o">=</span> <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span>
<a name="ln-219"></a>     <span class="n">l</span> <span class="o">=</span> <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-220"></a>     <span class="n">jstack</span> <span class="o">=</span> <span class="n">jstack</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-221"></a>    <span class="k">else</span>
<a name="ln-222"></a><span class="k">     </span><span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">ir</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-223"></a>     <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-224"></a>
<a name="ln-225"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="o">&gt;</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="n">ir</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-226"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="n">ir</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-227"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="o">&gt;</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-228"></a>
<a name="ln-229"></a>     <span class="n">i</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-230"></a>     <span class="n">j</span> <span class="o">=</span> <span class="n">ir</span>
<a name="ln-231"></a>     <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-232"></a>     <span class="k">do</span>
<a name="ln-233"></a><span class="k">      do</span>
<a name="ln-234"></a><span class="k">       </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-235"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">a</span><span class="p">(</span><span class="n">dir</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-236"></a><span class="k">      end do</span>
<a name="ln-237"></a><span class="k">      do</span>
<a name="ln-238"></a><span class="k">       </span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-239"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">a</span><span class="p">(</span><span class="n">dir</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-240"></a><span class="k">      end do</span>
<a name="ln-241"></a><span class="k">      if</span> <span class="p">(</span><span class="n">j</span><span class="o">&lt;</span><span class="n">i</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-242"></a><span class="k">      call </span><span class="n">swap</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-243"></a>     <span class="k">end do</span>
<a name="ln-244"></a><span class="k">     </span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-245"></a>     <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-246"></a>     <span class="n">jstack</span> <span class="o">=</span> <span class="n">jstack</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-247"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">jstack</span><span class="o">&gt;</span><span class="n">nstack</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-248"></a><span class="k">     if</span> <span class="p">(</span><span class="n">ir</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;=</span><span class="n">j</span><span class="o">-</span><span class="n">l</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-249"></a><span class="k">      </span><span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span> <span class="o">=</span> <span class="n">ir</span>
<a name="ln-250"></a>      <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-251"></a>      <span class="n">ir</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-252"></a>     <span class="k">else</span>
<a name="ln-253"></a><span class="k">      </span><span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-254"></a>      <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-255"></a>      <span class="n">l</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-256"></a>     <span class="k">end if</span>
<a name="ln-257"></a><span class="k">    end if</span>
<a name="ln-258"></a><span class="k">   end do</span>
<a name="ln-259"></a>
<a name="ln-260"></a><span class="k">  contains</span>
<a name="ln-261"></a>
<a name="ln-262"></a><span class="k">   subroutine </span><span class="n">swap</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">nd</span><span class="p">)</span>
<a name="ln-263"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">nd</span>
<a name="ln-264"></a>
<a name="ln-265"></a>    <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span>
<a name="ln-266"></a>    <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">,</span> <span class="n">i2</span><span class="p">)</span>
<a name="ln-267"></a>    <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">,</span> <span class="n">i2</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">)</span>
<a name="ln-268"></a>
<a name="ln-269"></a>   <span class="k">end subroutine</span>
<a name="ln-270"></a>
<a name="ln-271"></a><span class="k">  end subroutine</span>
<a name="ln-272"></a>
<a name="ln-273"></a>  <span class="c">!===========================</span>
<a name="ln-274"></a>  <span class="k">subroutine </span><span class="n">bunch_gen</span><span class="p">(</span><span class="n">ndm</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">gm</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">ez</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="n">dg</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-275"></a>    <span class="n">bunch</span><span class="p">)</span>
<a name="ln-276"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ndm</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-277"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">gm</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">ez</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="n">dg</span>
<a name="ln-278"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bunch</span><span class="p">(:,</span> <span class="p">:)</span>
<a name="ln-279"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">np</span>
<a name="ln-280"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sigs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-281"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xm</span><span class="p">,</span> <span class="n">ym</span><span class="p">,</span> <span class="n">zm</span><span class="p">,</span> <span class="n">pxm</span><span class="p">,</span> <span class="n">pym</span><span class="p">,</span> <span class="n">pzm</span>
<a name="ln-282"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">rnd</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">np_norm</span>
<a name="ln-283"></a>
<a name="ln-284"></a>   <span class="c">!============= ey,ez are emittances (in mm-microns)</span>
<a name="ln-285"></a>   <span class="c">! FIX emittances are ALWAYS a dimension times an angle...</span>
<a name="ln-286"></a>   <span class="c">! so this (in mm-micron) doesn&#39;t make any sense</span>
<a name="ln-287"></a>   <span class="c">! dg=d(gamma)/gamma (%)</span>
<a name="ln-288"></a>   <span class="c">! dp_y=ey/s_y dp_z=ez/s_z dp_x=d(gamma)</span>
<a name="ln-289"></a>   <span class="c">!=============================================</span>
<a name="ln-290"></a>
<a name="ln-291"></a>   <span class="c">!Distribute (x,y,z,px,py,pz) centered on 0; px=&gt; px+gamma</span>
<a name="ln-292"></a>
<a name="ln-293"></a>   <span class="k">select case</span> <span class="p">(</span><span class="n">ndm</span><span class="p">)</span>
<a name="ln-294"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-295"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sx</span>
<a name="ln-296"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">sy</span>
<a name="ln-297"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="n">dg</span><span class="o">*</span><span class="n">gm</span> <span class="c">!dpz</span>
<a name="ln-298"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ey</span><span class="o">/</span><span class="n">sy</span>
<a name="ln-299"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-300"></a>     <span class="k">do</span>
<a name="ln-301"></a><span class="k">      call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<a name="ln-302"></a>      <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<a name="ln-303"></a>      <span class="n">v1</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v1</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-304"></a>      <span class="n">v2</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v2</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-305"></a>      <span class="n">rnd</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span><span class="o">*</span><span class="n">v2</span>
<a name="ln-306"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">rnd</span><span class="o">&lt;</span><span class="mf">1.0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-307"></a><span class="k">     end do</span>
<a name="ln-308"></a><span class="k">     </span><span class="n">rnd</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span><span class="o">/</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-309"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-310"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">v2</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-311"></a>     <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-312"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rnd</span>
<a name="ln-313"></a>     <span class="k">do</span>
<a name="ln-314"></a><span class="k">      call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-315"></a>      <span class="n">rnd</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">rnd</span> <span class="o">-</span> <span class="mf">1.</span>
<a name="ln-316"></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">cut</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-317"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-318"></a><span class="k">     end do</span>
<a name="ln-319"></a><span class="k">     </span><span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-320"></a>    <span class="k">end do</span>
<a name="ln-321"></a><span class="k">    do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-322"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">sigs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-323"></a>    <span class="k">end do</span>
<a name="ln-324"></a><span class="k">    </span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">gm</span>
<a name="ln-325"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-326"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-327"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-328"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-329"></a>    <span class="c">! Reset centering</span>
<a name="ln-330"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-331"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-332"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-333"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-334"></a>
<a name="ln-335"></a>    <span class="n">np</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n1</span>
<a name="ln-336"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="n">xm</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-337"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="n">ym</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-338"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="n">pxm</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-339"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="n">pym</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-340"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-341"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">xm</span>
<a name="ln-342"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">ym</span>
<a name="ln-343"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">pxm</span> <span class="o">-</span> <span class="n">gm</span><span class="p">)</span>
<a name="ln-344"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">pym</span>
<a name="ln-345"></a>    <span class="k">end do</span>
<a name="ln-346"></a><span class="k">   case</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-347"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sx</span>
<a name="ln-348"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">sy</span>
<a name="ln-349"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">sz</span>
<a name="ln-350"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="n">dg</span><span class="o">*</span><span class="n">gm</span> <span class="c">!dpz</span>
<a name="ln-351"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">ey</span><span class="o">/</span><span class="n">sy</span>
<a name="ln-352"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">ez</span><span class="o">/</span><span class="n">sz</span>
<a name="ln-353"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span>
<a name="ln-354"></a>     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-355"></a>      <span class="k">do</span>
<a name="ln-356"></a><span class="k">       call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<a name="ln-357"></a>       <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<a name="ln-358"></a>       <span class="n">v1</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v1</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-359"></a>       <span class="n">v2</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v2</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-360"></a>       <span class="n">rnd</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span><span class="o">*</span><span class="n">v2</span>
<a name="ln-361"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">rnd</span><span class="o">&lt;</span><span class="mf">1.0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-362"></a><span class="k">      end do</span>
<a name="ln-363"></a><span class="k">      </span><span class="n">rnd</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span><span class="o">/</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-364"></a>      <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-365"></a>      <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v2</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-366"></a>     <span class="k">end do</span>
<a name="ln-367"></a><span class="k">    </span><span class="n">enddo</span>
<a name="ln-368"></a>    <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-369"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-370"></a>     <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-371"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">rnd</span>
<a name="ln-372"></a>     <span class="k">do</span>
<a name="ln-373"></a><span class="k">      call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-374"></a>      <span class="n">rnd</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">rnd</span> <span class="o">-</span> <span class="mf">1.</span>
<a name="ln-375"></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">cut</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-376"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-377"></a><span class="k">     end do</span>
<a name="ln-378"></a><span class="k">     </span><span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-379"></a>    <span class="k">end do</span>
<a name="ln-380"></a><span class="c">!======================</span>
<a name="ln-381"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span>
<a name="ln-382"></a>     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-383"></a>      <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">sigs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-384"></a>     <span class="k">end do</span>
<a name="ln-385"></a><span class="k">    end do</span>
<a name="ln-386"></a><span class="k">    </span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">gm</span>
<a name="ln-387"></a>
<a name="ln-388"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-389"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-390"></a>    <span class="n">zm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-391"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-392"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-393"></a>    <span class="n">pzm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-394"></a>
<a name="ln-395"></a>    <span class="c">! Reset centering</span>
<a name="ln-396"></a>    <span class="n">np</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n1</span>
<a name="ln-397"></a>    <span class="n">np_norm</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-398"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-399"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-400"></a>    <span class="n">zm</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="ln-401"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-402"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a name="ln-403"></a>    <span class="n">pzm</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<a name="ln-404"></a>
<a name="ln-405"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-406"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">xm</span>
<a name="ln-407"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">ym</span>
<a name="ln-408"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">zm</span>
<a name="ln-409"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">pxm</span> <span class="o">-</span> <span class="n">gm</span><span class="p">)</span>
<a name="ln-410"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">pym</span>
<a name="ln-411"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">pzm</span>
<a name="ln-412"></a>    <span class="k">end do</span>
<a name="ln-413"></a><span class="k">   end select</span>
<a name="ln-414"></a><span class="k">  end subroutine</span>
<a name="ln-415"></a>
<a name="ln-416"></a><span class="k"> end module</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-01-29 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ALaDyn was developed by The ALaDyn Collaboration</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>