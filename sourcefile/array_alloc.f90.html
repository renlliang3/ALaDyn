<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A High-Accuracy PIC Code for the Maxwell-Vlasov Equations">
    
    <meta name="author" content="The ALaDyn Collaboration" >
    <link rel="icon" href="../favicon.png">

    <title>array_alloc.f90 &ndash; ALaDyn</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ALaDyn <small>3.0.1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/aladyn.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/aladyn.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>array_alloc.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.8% of total for source files.">201 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/array_alloc.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">array_alloc.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/array_alloc.html">array_alloc</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/array_alloc.f90.html#src">array_alloc.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~array_alloc.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilearray_allocf90EfferentGraph" width="509pt" height="112pt"
 viewBox="0.00 0.00 509.00 112.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~array_alloc.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 108)">
<title>sourcefile~~array_alloc.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-108 505,-108 505,4 -4,4"/>
<!-- sourcefile~array_alloc.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~array_alloc.f90</title>
<polygon fill="none" stroke="#000000" points="501,-84 409,-84 409,-60 501,-60 501,-84"/>
<text text-anchor="middle" x="455" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">array_alloc.f90</text>
</g>
<!-- sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~fstruct_data.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/fstruct_data.f90.html" xlink:title="fstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="238,-104 142,-104 142,-80 238,-80 238,-104"/>
<text text-anchor="middle" x="190" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~array_alloc.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~array_alloc.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M408.8405,-75.4837C364.2621,-78.8481 296.5891,-83.9555 248.309,-87.5993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="248.0244,-84.1108 238.3162,-88.3535 248.5513,-91.0909 248.0244,-84.1108"/>
</g>
<!-- sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~pstruct_data.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/pstruct_data.f90.html" xlink:title="pstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-64 274,-64 274,-40 373,-40 373,-64"/>
<text text-anchor="middle" x="323.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~array_alloc.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~array_alloc.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M408.638,-64.9487C400.347,-63.6878 391.6042,-62.3581 383.0052,-61.0502"/>
<polygon fill="#ff0000" stroke="#ff0000" points="383.4251,-57.5739 373.0125,-59.5304 382.3725,-64.4943 383.4251,-57.5739"/>
</g>
<!-- sourcefile~precision_def.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~precision_def.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/precision_def.f90.html" xlink:title="precision_def.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="106,-64 0,-64 0,-40 106,-40 106,-64"/>
<text text-anchor="middle" x="53" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision_def.F90</text>
</a>
</g>
</g>
<!-- sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M148.8955,-79.9987C134.9351,-75.9226 119.157,-71.3159 104.4898,-67.0335"/>
<polygon fill="#ff0000" stroke="#ff0000" points="105.1292,-63.5741 94.549,-64.1311 103.1673,-70.2936 105.1292,-63.5741"/>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M273.8861,-52C229.6945,-52 164.7819,-52 116.7523,-52"/>
<polygon fill="#00ffff" stroke="#00ffff" points="116.4674,-48.5001 106.4673,-52 116.4673,-55.5001 116.4674,-48.5001"/>
</g>
<!-- sourcefile~struct_def.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~struct_def.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/struct_def.f90.html" xlink:title="struct_def.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="232.5,-24 147.5,-24 147.5,0 232.5,0 232.5,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">struct_def.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M283.4456,-39.9987C269.8418,-35.9226 254.4669,-31.3159 240.1744,-27.0335"/>
<polygon fill="#00ffff" stroke="#00ffff" points="241.0714,-23.6486 230.4875,-24.1311 239.0622,-30.3541 241.0714,-23.6486"/>
</g>
<!-- sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~array_alloc.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M148.8955,-24.0013C134.9351,-28.0774 119.157,-32.6841 104.4898,-36.9665"/>
<polygon fill="#00ffff" stroke="#00ffff" points="103.1673,-33.7064 94.549,-39.8689 105.1292,-40.4259 103.1673,-33.7064"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~array_alloc.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilearray_allocf90AfferentGraph" width="641pt" height="255pt"
 viewBox="0.00 0.00 641.00 254.64" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~array_alloc.f90~~AfferentGraph" class="graph" transform="scale(.865 .865) rotate(0) translate(4 290.3645)">
<title>sourcefile~~array_alloc.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-290.3645 737,-290.3645 737,4 -4,4"/>
<!-- sourcefile~array_alloc.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~array_alloc.f90</title>
<polygon fill="none" stroke="#000000" points="92,-206.3645 0,-206.3645 0,-182.3645 92,-182.3645 92,-206.3645"/>
<text text-anchor="middle" x="46" y="-191.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">array_alloc.f90</text>
</g>
<!-- sourcefile~pic_dump.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~pic_dump.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/pic_dump.f90.html" xlink:title="pic_dump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="237,-286.3645 152,-286.3645 152,-262.3645 237,-262.3645 237,-286.3645"/>
<text text-anchor="middle" x="194.5" y="-271.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_dump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_dump.f90&#45;&gt;sourcefile~array_alloc.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~pic_dump.f90&#45;&gt;sourcefile~array_alloc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M159.7204,-262.3459C149.3174,-258.3328 138.0186,-253.5489 128,-248.3645 107.6902,-237.8547 86.1477,-223.5304 70.242,-212.2758"/>
<polygon fill="#ff0000" stroke="#ff0000" points="72.1944,-209.3689 62.0291,-206.3827 68.1135,-215.0563 72.1944,-209.3689"/>
</g>
<!-- sourcefile~start_all.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~start_all.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/start_all.f90.html" xlink:title="start_all.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="591,-202.3645 514,-202.3645 514,-178.3645 591,-178.3645 591,-202.3645"/>
<text text-anchor="middle" x="552.5" y="-187.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_all.F90</text>
</a>
</g>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~array_alloc.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~array_alloc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M513.8301,-201.3382C477.5846,-211.2602 421.7533,-225.6146 372.5,-234.3645"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M372.5,-234.3645C274.2952,-251.8107 158.1163,-226.8329 94.2,-209.1981"/>
<polygon fill="#ff0000" stroke="#ff0000" points="94.9757,-205.7804 84.4013,-206.4384 93.078,-212.5183 94.9757,-205.7804"/>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~pic_dump.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~pic_dump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M372.5,-234.3645C330.0669,-241.9028 282.4547,-252.728 247.1569,-261.2164"/>
<polygon fill="#ff0000" stroke="#ff0000" points="245.976,-257.9012 237.0807,-263.6565 247.6235,-264.7045 245.976,-257.9012"/>
</g>
<!-- sourcefile~ionize.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~ionize.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/ionize.f90.html" xlink:title="ionize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="404.5,-122.3645 340.5,-122.3645 340.5,-98.3645 404.5,-98.3645 404.5,-122.3645"/>
<text text-anchor="middle" x="372.5" y="-107.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ionize.f90</text>
</a>
</g>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~ionize.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~ionize.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M534.3139,-178.2853C513.9912,-165.2254 479.7606,-144.5177 448,-131.3645 437.4138,-126.9804 425.6217,-123.208 414.5628,-120.1194"/>
<polygon fill="#00ffff" stroke="#00ffff" points="415.233,-116.6758 404.6685,-117.4773 413.4269,-123.4388 415.233,-116.6758"/>
</g>
<!-- sourcefile~pic_in.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~pic_in.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/pic_in.f90.html" xlink:title="pic_in.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="404.5,-206.3645 340.5,-206.3645 340.5,-182.3645 404.5,-182.3645 404.5,-206.3645"/>
<text text-anchor="middle" x="372.5" y="-191.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_in.f90</text>
</a>
</g>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~pic_in.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~pic_in.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M513.8855,-191.2226C484.7777,-191.8694 444.8857,-192.7559 414.8957,-193.4224"/>
<polygon fill="#cbff00" stroke="#cbff00" points="414.6545,-189.9268 404.7348,-193.6482 414.8101,-196.925 414.6545,-189.9268"/>
</g>
<!-- sourcefile~init_beam_part_distrib.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~init_beam_part_distrib.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/init_beam_part_distrib.f90.html" xlink:title="init_beam_part_distrib.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="448,-164.3645 297,-164.3645 297,-140.3645 448,-140.3645 448,-164.3645"/>
<text text-anchor="middle" x="372.5" y="-149.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_beam_part_distrib.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~array_alloc.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~array_alloc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M296.9446,-145.8727C265.05,-144.8019 227.6871,-145.7569 194.5,-152.3645"/>
</g>
<!-- sourcefile~ionize.f90&#45;&gt;sourcefile~array_alloc.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~ionize.f90&#45;&gt;sourcefile~array_alloc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M340.4923,-118.6347C304.9737,-127.6439 245.8813,-142.1344 194.5,-152.3645"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M194.5,-152.3645C159.8295,-159.2675 121.4499,-170.2117 92.3945,-179.1978"/>
<polygon fill="#ff0000" stroke="#ff0000" points="91.0263,-175.9585 82.5275,-182.2847 93.1164,-182.6392 91.0263,-175.9585"/>
</g>
<!-- sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~mpi_part_interface.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/mpi_part_interface.f90.html" xlink:title="mpi_part_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="261,-62.3645 128,-62.3645 128,-38.3645 261,-38.3645 261,-62.3645"/>
<text text-anchor="middle" x="194.5" y="-47.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_part_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~array_alloc.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~array_alloc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M182.0944,-62.3942C156.3896,-87.32 97.1173,-144.7962 65.9625,-175.007"/>
<polygon fill="#ff0000" stroke="#ff0000" points="63.4276,-172.5897 58.6851,-182.0638 68.3006,-177.615 63.4276,-172.5897"/>
</g>
<!-- sourcefile~init_part_distrib.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~init_part_distrib.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/init_part_distrib.f90.html" xlink:title="init_part_distrib.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="252,-206.3645 137,-206.3645 137,-182.3645 252,-182.3645 252,-206.3645"/>
<text text-anchor="middle" x="194.5" y="-191.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_part_distrib.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_part_distrib.f90&#45;&gt;sourcefile~array_alloc.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~init_part_distrib.f90&#45;&gt;sourcefile~array_alloc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M136.6608,-194.3645C125.4376,-194.3645 113.6878,-194.3645 102.5081,-194.3645"/>
<polygon fill="#ff0000" stroke="#ff0000" points="102.4327,-190.8646 92.4327,-194.3645 102.4326,-197.8646 102.4327,-190.8646"/>
</g>
<!-- sourcefile~window.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~window.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/window.f90.html" xlink:title="window.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="408.5,-42.3645 336.5,-42.3645 336.5,-18.3645 408.5,-18.3645 408.5,-42.3645"/>
<text text-anchor="middle" x="372.5" y="-27.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">window.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M336.479,-34.4118C317.6304,-36.5296 293.7974,-39.2075 271.0678,-41.7614"/>
<polygon fill="#0000ff" stroke="#0000ff" points="270.616,-38.29 261.0694,-42.8848 271.3977,-45.2463 270.616,-38.29"/>
</g>
<!-- sourcefile~pic_in.f90&#45;&gt;sourcefile~init_part_distrib.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~pic_in.f90&#45;&gt;sourcefile~init_part_distrib.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M340.2655,-194.3645C318.5007,-194.3645 288.9626,-194.3645 262.1662,-194.3645"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="262.0524,-190.8646 252.0524,-194.3645 262.0524,-197.8646 262.0524,-190.8646"/>
</g>
<!-- sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~env_evolve_in_time.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/env_evolve_in_time.f90.html" xlink:title="env_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="621,-61.3645 484,-61.3645 484,-37.3645 621,-37.3645 621,-61.3645"/>
<text text-anchor="middle" x="552.5" y="-46.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">env_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M516.9378,-61.4161C487.4461,-71.4106 445.4623,-85.6384 414.3541,-96.1806"/>
<polygon fill="#00ffff" stroke="#00ffff" points="413.0133,-92.9394 404.6658,-99.4639 415.2601,-99.569 413.0133,-92.9394"/>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M528.3259,-37.1942C507.606,-27.4836 476.6536,-14.6611 448,-9.3645 382.0069,2.8342 362.9002,3.3267 297,-9.3645 272.4162,-14.0989 246.2336,-24.6765 226.4843,-33.9017"/>
<polygon fill="#0000ff" stroke="#0000ff" points="224.842,-30.8076 217.3412,-38.2902 227.8711,-37.1183 224.842,-30.8076"/>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.9362,-42.1272C462.1084,-39.8232 438.4944,-37.3306 418.6464,-35.2355"/>
<polygon fill="#ff0000" stroke="#ff0000" points="418.9521,-31.7484 408.6399,-34.1793 418.2172,-38.7097 418.9521,-31.7484"/>
</g>
<!-- sourcefile~aladyn.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~aladyn.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/aladyn.f90.html" xlink:title="ALaDyn.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="733,-132.3645 657,-132.3645 657,-108.3645 733,-108.3645 733,-132.3645"/>
<text text-anchor="middle" x="695" y="-117.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ALaDyn.F90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~start_all.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~start_all.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M673.8705,-132.3899C659.1991,-140.59 639.1104,-151.5228 621,-160.3645 611.2747,-165.1125 600.6199,-169.9493 590.6721,-174.3136"/>
<polygon fill="#ffff00" stroke="#ffff00" points="589.185,-171.1435 581.4046,-178.3349 591.9714,-177.5651 589.185,-171.1435"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~init_beam_part_distrib.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~init_beam_part_distrib.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M656.7386,-124.161C608.117,-128.9855 522.7651,-137.4545 458.2444,-143.8565"/>
<polygon fill="#00ff00" stroke="#00ff00" points="457.6824,-140.395 448.0769,-144.8654 458.3737,-147.3608 457.6824,-140.395"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M674.5405,-108.3546C659.8341,-99.8888 639.4306,-88.4815 621,-79.3645 611.3877,-74.6096 600.8468,-69.7998 590.9774,-65.4656"/>
<polygon fill="#00ff66" stroke="#00ff66" points="592.3399,-62.2416 581.7729,-61.4732 589.5543,-68.6635 592.3399,-62.2416"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~pic_evolve_in_time.f90</title>
<g id="a_sourcefile~~array_alloc.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/pic_evolve_in_time.f90.html" xlink:title="pic_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="619,-112.3645 486,-112.3645 486,-88.3645 619,-88.3645 619,-112.3645"/>
<text text-anchor="middle" x="552.5" y="-97.9645" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M656.8126,-115.0049C648.1852,-113.794 638.7268,-112.4665 629.1375,-111.1206"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="629.5158,-107.6395 619.1264,-109.7156 628.5428,-114.5716 629.5158,-107.6395"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M485.9861,-104.0597C462.0603,-105.3889 435.7536,-106.8504 414.4972,-108.0313"/>
<polygon fill="#00ffff" stroke="#00ffff" points="414.2909,-104.5373 404.5005,-108.5867 414.6793,-111.5265 414.2909,-104.5373"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M485.5829,-91.0185C424.6865,-82.5135 334.8303,-69.9637 271.0866,-61.061"/>
<polygon fill="#0000ff" stroke="#0000ff" points="271.4769,-57.5816 261.0888,-59.6646 270.5085,-64.5143 271.4769,-57.5816"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~array_alloc.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.2001,-88.2794C504.2328,-79.1418 474.4781,-66.485 448,-56.3645 438.4822,-52.7266 428.2061,-49.0344 418.3917,-45.619"/>
<polygon fill="#ff0000" stroke="#ff0000" points="419.3711,-42.2546 408.7763,-42.3081 417.092,-48.8732 419.3711,-42.2546"/>
</g>
</g>
</svg>
</div><script>var pansourcefilearray_allocf90AfferentGraph = svgPanZoom('#sourcefilearray_allocf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/array_alloc.html">array_alloc</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/array_alloc.f90.html#src">array_alloc.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-2"></a><span class="c">!                            Copyright 2008-2020  The ALaDyn Collaboration                            !</span>
<a name="ln-3"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-6"></a><span class="c">!  This file is part of ALaDyn.                                                                       !</span>
<a name="ln-7"></a><span class="c">!                                                                                                     !</span>
<a name="ln-8"></a><span class="c">!  ALaDyn is free software: you can redistribute it and/or modify                                     !</span>
<a name="ln-9"></a><span class="c">!  it under the terms of the GNU General Public License as published by                               !</span>
<a name="ln-10"></a><span class="c">!  the Free Software Foundation, either version 3 of the License, or                                  !</span>
<a name="ln-11"></a><span class="c">!  (at your option) any later version.                                                                !</span>
<a name="ln-12"></a><span class="c">!                                                                                                     !</span>
<a name="ln-13"></a><span class="c">!  ALaDyn is distributed in the hope that it will be useful,                                          !</span>
<a name="ln-14"></a><span class="c">!  but WITHOUT ANY WARRANTY; without even the implied warranty of                                     !</span>
<a name="ln-15"></a><span class="c">!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                      !</span>
<a name="ln-16"></a><span class="c">!  GNU General Public License for more details.                                                       !</span>
<a name="ln-17"></a><span class="c">!                                                                                                     !</span>
<a name="ln-18"></a><span class="c">!  You should have received a copy of the GNU General Public License                                  !</span>
<a name="ln-19"></a><span class="c">!  along with ALaDyn.  If not, see &lt;http://www.gnu.org/licenses/&gt;.                                    !</span>
<a name="ln-20"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-21"></a><span class="c">!     Local grid structure under mpi domain decomposition</span>
<a name="ln-22"></a><span class="c">!============== </span>
<a name="ln-23"></a><span class="c">! grid [1:n]   np=n+2  extended domain [1:np+2]</span>
<a name="ln-24"></a><span class="c">! interior [3,np]   ghost [1:2], [np+1:np+2]  </span>
<a name="ln-25"></a><span class="c">! overlapping grid  structure:</span>
<a name="ln-26"></a><span class="c">!             </span>
<a name="ln-27"></a><span class="c">!====================================================================</span>
<a name="ln-28"></a><span class="c">!                                     1-----2---- 3--- 4   |      pey+1</span>
<a name="ln-29"></a><span class="c">!                 1-----2----[3-------np-1--np]--np+1--np+2|    pey</span>
<a name="ln-30"></a><span class="c">!1-2--------------np-1--np---np+1                          |pey-1</span>
<a name="ln-31"></a><span class="c">!======================================================================</span>
<a name="ln-32"></a><span class="c">!      Right(pey+1)     [1:4]     overlap pey [np-1:np+2]</span>
<a name="ln-33"></a><span class="c">!      Left(pey-1)      [np-1:np+2]overlap pey [1:4]</span>
<a name="ln-34"></a><span class="c">!===================================</span>
<a name="ln-35"></a> <span class="k">module </span><span class="n">array_alloc</span>
<a name="ln-36"></a>
<a name="ln-37"></a>  <span class="k">use </span><span class="n">pstruct_data</span>
<a name="ln-38"></a>  <span class="k">use </span><span class="n">fstruct_data</span>
<a name="ln-39"></a>  <span class="k">implicit none</span>
<a name="ln-40"></a>
<a name="ln-41"></a><span class="k"> contains</span>
<a name="ln-42"></a>
<a name="ln-43"></a><span class="k">  subroutine </span><span class="n">mpi_buffer_alloc</span><span class="p">(</span><span class="n">n1_loc</span><span class="p">,</span> <span class="n">n2_loc</span><span class="p">,</span> <span class="n">n3_loc</span><span class="p">,</span> <span class="n">nvd</span><span class="p">)</span>
<a name="ln-44"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n1_loc</span><span class="p">,</span> <span class="n">n2_loc</span><span class="p">,</span> <span class="n">n3_loc</span><span class="p">,</span> <span class="n">nvd</span>
<a name="ln-45"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lenw</span><span class="p">,</span> <span class="n">n3m</span><span class="p">,</span> <span class="n">stl</span>
<a name="ln-46"></a>
<a name="ln-47"></a>   <span class="n">stl</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-48"></a>   <span class="n">n3m</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n2_loc</span><span class="p">,</span> <span class="n">n3_loc</span><span class="p">)</span>
<a name="ln-49"></a>   <span class="n">lenw</span> <span class="o">=</span> <span class="n">nvd</span><span class="o">*</span><span class="p">(</span><span class="n">n1_loc</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">n3m</span><span class="o">*</span><span class="n">stl</span>
<a name="ln-50"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">aux1</span><span class="p">(</span><span class="n">lenw</span><span class="p">),</span> <span class="n">aux2</span><span class="p">(</span><span class="n">lenw</span><span class="p">))</span>
<a name="ln-51"></a>   <span class="n">aux1</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-52"></a>   <span class="n">aux2</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-53"></a>
<a name="ln-54"></a>  <span class="k">end subroutine</span>
<a name="ln-55"></a>
<a name="ln-56"></a><span class="k">  subroutine </span><span class="n">v_alloc</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">ncomp</span><span class="p">,</span> <span class="n">njc</span><span class="p">,</span> <span class="n">ndm</span><span class="p">,</span> <span class="n">ifluid</span><span class="p">,</span> <span class="n">lp</span><span class="p">,</span> <span class="n">oder</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-57"></a>    <span class="n">envlp</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">comv</span><span class="p">,</span> <span class="n">fsize</span><span class="p">)</span>
<a name="ln-58"></a>
<a name="ln-59"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">ncomp</span><span class="p">,</span> <span class="n">njc</span><span class="p">,</span> <span class="n">ndm</span><span class="p">,</span> <span class="n">ifluid</span><span class="p">,</span> <span class="n">lp</span><span class="p">,</span> <span class="n">oder</span>
<a name="ln-60"></a>   <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">envlp</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">comv</span>
<a name="ln-61"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fsize</span>
<a name="ln-62"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">njdim</span><span class="p">,</span> <span class="n">ng</span><span class="p">,</span> <span class="n">ng0</span><span class="p">,</span> <span class="n">n1p</span><span class="p">,</span> <span class="n">n2p</span><span class="p">,</span> <span class="n">n3p</span><span class="p">,</span> <span class="n">allocstatus</span><span class="p">,</span> <span class="n">fsize_loc</span>
<a name="ln-63"></a>
<a name="ln-64"></a>   <span class="n">n1p</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">ihx</span>
<a name="ln-65"></a>   <span class="n">n2p</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="n">ihx</span>
<a name="ln-66"></a>   <span class="n">n3p</span> <span class="o">=</span> <span class="n">n3</span>
<a name="ln-67"></a>   <span class="n">ng0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">n1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-68"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">ndm</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-69"></a><span class="k">    </span><span class="n">ng0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">n1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-70"></a>    <span class="n">n3p</span> <span class="o">=</span> <span class="n">n3</span> <span class="o">+</span> <span class="n">ihx</span>
<a name="ln-71"></a>   <span class="k">end if</span>
<a name="ln-72"></a><span class="k">   </span><span class="n">ng</span> <span class="o">=</span> <span class="n">n1p</span><span class="o">*</span><span class="n">n2p</span><span class="o">*</span><span class="n">n3p</span>
<a name="ln-73"></a>   <span class="n">fsize_loc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-74"></a>
<a name="ln-75"></a>   <span class="c">! allocates common arrays</span>
<a name="ln-76"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">ebf</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">ncomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-77"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">jc</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">njc</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-78"></a>   <span class="n">fsize_loc</span> <span class="o">=</span> <span class="n">fsize_loc</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="n">ncomp</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="n">njc</span>
<a name="ln-79"></a>   <span class="n">ebf</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-80"></a>   <span class="n">jc</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-81"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">comv</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-82"></a><span class="k">    if</span> <span class="p">(</span><span class="n">lp</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span> <span class="c">!to handle backward advected fields</span>
<a name="ln-83"></a>     <span class="k">allocate</span> <span class="p">(</span><span class="n">ebf0</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">ncomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-84"></a>     <span class="n">fsize_loc</span> <span class="o">=</span> <span class="n">fsize_loc</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="n">ncomp</span>
<a name="ln-85"></a>     <span class="n">ebf0</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-86"></a>    <span class="k">end if</span>
<a name="ln-87"></a><span class="k">   end if</span>
<a name="ln-88"></a><span class="k">   if</span> <span class="p">(</span><span class="n">ifluid</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-89"></a><span class="k">    if</span> <span class="p">(</span><span class="n">lp</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span> <span class="c">!for 2th order lpf in fluid variables</span>
<a name="ln-90"></a>     <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">ebf0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-91"></a><span class="k">      allocate</span> <span class="p">(</span><span class="n">ebf0</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">ncomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-92"></a>      <span class="n">fsize_loc</span> <span class="o">=</span> <span class="n">fsize_loc</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="n">ncomp</span>
<a name="ln-93"></a>      <span class="n">ebf0</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-94"></a>     <span class="k">end if</span>
<a name="ln-95"></a><span class="k">    end if</span>
<a name="ln-96"></a><span class="k">   end if</span>
<a name="ln-97"></a><span class="k">   if</span> <span class="p">(</span><span class="n">lp</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-98"></a><span class="k">    allocate</span> <span class="p">(</span><span class="n">ebf0</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">ncomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-99"></a>    <span class="n">ebf0</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-100"></a>    <span class="n">fsize_loc</span> <span class="o">=</span> <span class="n">fsize_loc</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="n">ncomp</span>
<a name="ln-101"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lp</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-102"></a><span class="k">     allocate</span> <span class="p">(</span><span class="n">ebf1</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">ncomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-103"></a>     <span class="n">fsize_loc</span> <span class="o">=</span> <span class="n">fsize_loc</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="n">ncomp</span>
<a name="ln-104"></a>     <span class="n">ebf1</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-105"></a>    <span class="k">end if</span>
<a name="ln-106"></a><span class="k">   end if</span>
<a name="ln-107"></a>   <span class="c">!=============ENV allocation section</span>
<a name="ln-108"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">envlp</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-109"></a><span class="k">    </span><span class="n">njdim</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-110"></a>    <span class="k">allocate</span> <span class="p">(</span><span class="n">env</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">njdim</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-111"></a>    <span class="n">env</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-112"></a>    <span class="n">fsize_loc</span> <span class="o">=</span> <span class="n">fsize_loc</span> <span class="o">+</span> <span class="n">njdim</span><span class="o">*</span><span class="n">ng</span>
<a name="ln-113"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lp</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">then</span> <span class="c">!RK4 for env solver</span>
<a name="ln-114"></a>     <span class="k">allocate</span> <span class="p">(</span><span class="n">env0</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">njdim</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-115"></a>     <span class="n">env0</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-116"></a>     <span class="n">fsize_loc</span> <span class="o">=</span> <span class="n">fsize_loc</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">njdim</span><span class="o">*</span><span class="n">ng</span>
<a name="ln-117"></a>    <span class="k">end if</span>
<a name="ln-118"></a><span class="k">    if</span> <span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-119"></a><span class="k">     allocate</span> <span class="p">(</span><span class="n">env1</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">njdim</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-120"></a>     <span class="n">env1</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-121"></a>     <span class="n">fsize_loc</span> <span class="o">=</span> <span class="n">fsize_loc</span> <span class="o">+</span> <span class="n">njdim</span><span class="o">*</span><span class="n">ng</span>
<a name="ln-122"></a>    <span class="k">end if</span>
<a name="ln-123"></a><span class="k">   end if</span>
<a name="ln-124"></a><span class="k">   </span><span class="n">fsize</span> <span class="o">=</span> <span class="n">fsize</span> <span class="o">+</span> <span class="n">fsize_loc</span> <span class="c">!sums all over memory alloc</span>
<a name="ln-125"></a>  <span class="k">end subroutine</span>
<a name="ln-126"></a>
<a name="ln-127"></a>  <span class="c">!--------------------------</span>
<a name="ln-128"></a>
<a name="ln-129"></a>  <span class="k">subroutine </span><span class="n">bv_alloc</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">bcomp</span><span class="p">,</span> <span class="n">ndm</span><span class="p">,</span> <span class="n">ibch</span><span class="p">,</span> <span class="n">fsize</span><span class="p">)</span>
<a name="ln-130"></a>
<a name="ln-131"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">bcomp</span><span class="p">,</span> <span class="n">ndm</span><span class="p">,</span> <span class="n">ibch</span>
<a name="ln-132"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fsize</span>
<a name="ln-133"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ng</span><span class="p">,</span> <span class="n">n1p</span><span class="p">,</span> <span class="n">n2p</span><span class="p">,</span> <span class="n">n3p</span><span class="p">,</span> <span class="n">allocstatus</span>
<a name="ln-134"></a>
<a name="ln-135"></a>   <span class="n">n1p</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">ihx</span> <span class="c">!x-grid ix=1,2 bd, 3:nx+2=n1p data n1p+1 bd</span>
<a name="ln-136"></a>   <span class="n">n2p</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="n">ihx</span>
<a name="ln-137"></a>   <span class="n">n3p</span> <span class="o">=</span> <span class="n">n3</span>
<a name="ln-138"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">ndm</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="n">n3p</span> <span class="o">=</span> <span class="n">n3</span> <span class="o">+</span> <span class="n">ihx</span>
<a name="ln-139"></a>   <span class="n">ng</span> <span class="o">=</span> <span class="n">n1p</span><span class="o">*</span><span class="n">n2p</span><span class="o">*</span><span class="n">n3p</span>
<a name="ln-140"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">ebf_bunch</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">bcomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-141"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">jb</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">ndm</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-142"></a>   <span class="n">ebf_bunch</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-143"></a>   <span class="n">jb</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-144"></a>
<a name="ln-145"></a>   <span class="n">fsize</span> <span class="o">=</span> <span class="n">fsize</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="p">(</span><span class="n">bcomp</span><span class="o">+</span><span class="n">ndm</span><span class="p">)</span>
<a name="ln-146"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">ibch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-147"></a><span class="k">    allocate</span> <span class="p">(</span><span class="n">ebf1_bunch</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">bcomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-148"></a>    <span class="n">ebf1_bunch</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-149"></a>    <span class="n">fsize</span> <span class="o">=</span> <span class="n">fsize</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="n">bcomp</span>
<a name="ln-150"></a>   <span class="k">end if</span>
<a name="ln-151"></a>   <span class="c">! In 3D  nbcomp=6    in 2D nbcomp=nfield+1=4</span>
<a name="ln-152"></a>  <span class="k">end subroutine</span>
<a name="ln-153"></a>  <span class="c">!==================</span>
<a name="ln-154"></a>  <span class="k">subroutine </span><span class="n">fluid_alloc</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">fcomp</span><span class="p">,</span> <span class="n">ndm</span><span class="p">,</span> <span class="n">lp</span><span class="p">,</span> <span class="n">fsize</span><span class="p">)</span>
<a name="ln-155"></a>
<a name="ln-156"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">fcomp</span><span class="p">,</span> <span class="n">ndm</span><span class="p">,</span> <span class="n">lp</span>
<a name="ln-157"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fsize</span>
<a name="ln-158"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ng</span><span class="p">,</span> <span class="n">n1p</span><span class="p">,</span> <span class="n">n2p</span><span class="p">,</span> <span class="n">n3p</span><span class="p">,</span> <span class="n">flcomp</span><span class="p">,</span> <span class="n">allocstatus</span>
<a name="ln-159"></a>
<a name="ln-160"></a>   <span class="n">n1p</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">ihx</span> <span class="c">!x-grid ix=1,2 bd, 3:n1+2=n1p data n1+1 bd</span>
<a name="ln-161"></a>   <span class="n">n2p</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="n">ihx</span> <span class="c">!overlapping grid y=1,3 = n2-1,n2+1  y=n2+1=ihx</span>
<a name="ln-162"></a>   <span class="n">n3p</span> <span class="o">=</span> <span class="n">n3</span>
<a name="ln-163"></a>   <span class="n">flcomp</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">fcomp</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-164"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">ndm</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="n">n3p</span> <span class="o">=</span> <span class="n">n3</span> <span class="o">+</span> <span class="n">ihx</span>
<a name="ln-165"></a>   <span class="n">ng</span> <span class="o">=</span> <span class="n">n1p</span><span class="o">*</span><span class="n">n2p</span><span class="o">*</span><span class="n">n3p</span>
<a name="ln-166"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">up</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">fcomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-167"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">up0</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">fcomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-168"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">flux</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">flcomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-169"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">fluid_yz_profile</span><span class="p">(</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-170"></a>   <span class="n">up</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-171"></a>   <span class="n">flux</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-172"></a>   <span class="n">up0</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-173"></a>   <span class="n">fluid_yz_profile</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-174"></a>   <span class="n">fsize</span> <span class="o">=</span> <span class="n">fsize</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">fcomp</span><span class="o">+</span><span class="n">flcomp</span><span class="p">)</span> <span class="o">+</span> <span class="n">n2p</span><span class="o">*</span><span class="n">n3p</span>
<a name="ln-175"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">lp</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-176"></a><span class="k">    allocate</span> <span class="p">(</span><span class="n">up1</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">fcomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-177"></a>    <span class="n">up1</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-178"></a>    <span class="n">fsize</span> <span class="o">=</span> <span class="n">fsize</span> <span class="o">+</span> <span class="n">ng</span><span class="o">*</span><span class="n">fcomp</span>
<a name="ln-179"></a>   <span class="k">end if</span>
<a name="ln-180"></a><span class="k">  end subroutine</span>
<a name="ln-181"></a>  <span class="c">!============ external B-field allocated</span>
<a name="ln-182"></a>  <span class="k">subroutine </span><span class="n">bext_alloc</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">bcomp</span><span class="p">,</span> <span class="n">fsize</span><span class="p">)</span>
<a name="ln-183"></a>
<a name="ln-184"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">,</span> <span class="n">bcomp</span>
<a name="ln-185"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fsize</span>
<a name="ln-186"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ng</span><span class="p">,</span> <span class="n">n1p</span><span class="p">,</span> <span class="n">n2p</span><span class="p">,</span> <span class="n">n3p</span><span class="p">,</span> <span class="n">allocstatus</span>
<a name="ln-187"></a>
<a name="ln-188"></a>   <span class="n">n1p</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">ihx</span> <span class="c">!x-grid ix=1,2 bd, 3:n1+2=n1p data n1+1 bd</span>
<a name="ln-189"></a>   <span class="n">n2p</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="n">ihx</span> <span class="c">!overlapping grid y=1,3 = n2-1,n2+1  y=n2+1=ihx</span>
<a name="ln-190"></a>   <span class="n">n3p</span> <span class="o">=</span> <span class="n">n3</span>
<a name="ln-191"></a>   <span class="n">ng</span> <span class="o">=</span> <span class="n">n1p</span><span class="o">*</span><span class="n">n2p</span><span class="o">*</span><span class="n">n3p</span>
<a name="ln-192"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">ebf0_bunch</span><span class="p">(</span><span class="n">n1p</span><span class="p">,</span><span class="n">n2p</span><span class="p">,</span><span class="n">n3p</span><span class="p">,</span><span class="n">bcomp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-193"></a>   <span class="n">ebf0_bunch</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-194"></a>   <span class="n">fsize</span> <span class="o">=</span> <span class="n">fsize</span> <span class="o">+</span> <span class="n">bcomp</span><span class="o">*</span><span class="n">ng</span>
<a name="ln-195"></a>  <span class="k">end subroutine</span>
<a name="ln-196"></a>  <span class="c">!===========================</span>
<a name="ln-197"></a>  <span class="k">subroutine </span><span class="n">p_alloc</span><span class="p">(</span><span class="n">npt_max</span><span class="p">,</span> <span class="n">ncmp</span><span class="p">,</span> <span class="n">np_s</span><span class="p">,</span> <span class="n">ns</span><span class="p">,</span> <span class="n">lp</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">r_type</span><span class="p">,</span> <span class="n">msize</span><span class="p">)</span>
<a name="ln-198"></a>
<a name="ln-199"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">npt_max</span><span class="p">,</span> <span class="n">ncmp</span><span class="p">,</span> <span class="n">np_s</span><span class="p">(:),</span> <span class="n">ns</span><span class="p">,</span> <span class="n">lp</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">r_type</span>
<a name="ln-200"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msize</span>
<a name="ln-201"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nsize</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">npt</span><span class="p">,</span> <span class="n">allocstatus</span>
<a name="ln-202"></a>
<a name="ln-203"></a>   <span class="n">npt</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-204"></a>   <span class="k">select case</span> <span class="p">(</span><span class="n">r_type</span><span class="p">)</span>
<a name="ln-205"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">!Plasma particles</span>
<a name="ln-206"></a>    <span class="n">nsize</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-207"></a>    <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ns</span>
<a name="ln-208"></a>     <span class="n">npt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np_s</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-209"></a>     <span class="k">allocate</span> <span class="p">(</span><span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">npt</span><span class="p">,</span><span class="n">ncmp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-210"></a>     <span class="n">nsize</span> <span class="o">=</span> <span class="n">nsize</span> <span class="o">+</span> <span class="n">ncmp</span><span class="o">*</span><span class="n">npt</span>
<a name="ln-211"></a>     <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npt</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ncmp</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-212"></a>    <span class="k">end do</span>
<a name="ln-213"></a><span class="k">    if</span> <span class="p">(</span><span class="n">mid</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-214"></a><span class="k">     allocate</span> <span class="p">(</span><span class="n">ebfp</span><span class="p">(</span><span class="n">npt_max</span><span class="p">,</span><span class="n">ncmp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-215"></a>     <span class="n">nsize</span> <span class="o">=</span> <span class="n">nsize</span> <span class="o">+</span> <span class="n">ncmp</span><span class="o">*</span><span class="n">npt_max</span>
<a name="ln-216"></a>     <span class="n">ebfp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npt_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ncmp</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-217"></a>    <span class="k">end if</span>
<a name="ln-218"></a><span class="k">    if</span> <span class="p">(</span><span class="n">lp</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-219"></a><span class="k">     allocate</span> <span class="p">(</span><span class="n">ebfp0</span><span class="p">(</span><span class="n">npt_max</span><span class="p">,</span><span class="n">ncmp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-220"></a>     <span class="n">nsize</span> <span class="o">=</span> <span class="n">nsize</span> <span class="o">+</span> <span class="n">ncmp</span><span class="o">*</span><span class="n">npt</span>
<a name="ln-221"></a>     <span class="n">ebfp0</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npt_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ncmp</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-222"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">lp</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-223"></a><span class="k">      allocate</span> <span class="p">(</span><span class="n">ebfp1</span><span class="p">(</span><span class="n">npt_max</span><span class="p">,</span><span class="n">ncmp</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-224"></a>      <span class="n">nsize</span> <span class="o">=</span> <span class="n">nsize</span> <span class="o">+</span> <span class="n">ncmp</span><span class="o">*</span><span class="n">npt</span>
<a name="ln-225"></a>      <span class="n">ebfp1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npt_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ncmp</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-226"></a>     <span class="k">end if</span>
<a name="ln-227"></a><span class="k">    end if</span>
<a name="ln-228"></a><span class="k">    </span><span class="n">msize</span> <span class="o">=</span> <span class="n">msize</span> <span class="o">+</span> <span class="n">nsize</span>
<a name="ln-229"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c">!bunch particles are inside spec(1)%npart</span>
<a name="ln-230"></a>    <span class="n">nsize</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-231"></a>    <span class="n">msize</span> <span class="o">=</span> <span class="n">msize</span> <span class="o">+</span> <span class="n">nsize</span>
<a name="ln-232"></a>    <span class="k">return</span>
<a name="ln-233"></a><span class="k">   end select</span>
<a name="ln-234"></a><span class="k">  end subroutine</span>
<a name="ln-235"></a>  <span class="c">!============================</span>
<a name="ln-236"></a>  <span class="c">!DIR$ ATTRIBUTES INLINE :: p_realloc</span>
<a name="ln-237"></a>  <span class="k">subroutine </span><span class="n">p_realloc</span><span class="p">(</span><span class="n">pdata</span><span class="p">,</span> <span class="n">npt_new</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-238"></a>   <span class="k">type</span> <span class="p">(</span><span class="n">species</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pdata</span>
<a name="ln-239"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">npt_new</span><span class="p">,</span> <span class="n">ndv</span>
<a name="ln-240"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">allocstatus</span><span class="p">,</span> <span class="n">deallocstatus</span>
<a name="ln-241"></a>
<a name="ln-242"></a>   <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">pdata</span><span class="p">%</span><span class="n">part</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-243"></a><span class="k">    if</span> <span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pdata</span><span class="p">%</span><span class="n">part</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">npt_new</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-244"></a><span class="k">     deallocate</span> <span class="p">(</span><span class="n">pdata</span><span class="p">%</span><span class="n">part</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">deallocstatus</span><span class="p">)</span>
<a name="ln-245"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">deallocstatus</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">allocate</span> <span class="p">(</span><span class="n">pdata</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npt_new</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-246"></a>       <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-247"></a>    <span class="k">end if</span>
<a name="ln-248"></a><span class="k">   else</span>
<a name="ln-249"></a><span class="k">    allocate</span> <span class="p">(</span><span class="n">pdata</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npt_new</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-250"></a>   <span class="k">end if</span>
<a name="ln-251"></a><span class="k">   </span><span class="n">pdata</span><span class="p">%</span><span class="n">part</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-252"></a>  <span class="k">end subroutine</span>
<a name="ln-253"></a>  <span class="c">!========================</span>
<a name="ln-254"></a>  <span class="k">subroutine </span><span class="n">v_realloc</span><span class="p">(</span><span class="n">vdata</span><span class="p">,</span> <span class="n">npt_new</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-255"></a>   <span class="kt">real</span> <span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vdata</span><span class="p">(:,</span> <span class="p">:)</span>
<a name="ln-256"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">npt_new</span><span class="p">,</span> <span class="n">ndv</span>
<a name="ln-257"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">allocstatus</span><span class="p">,</span> <span class="n">deallocstatus</span>
<a name="ln-258"></a>
<a name="ln-259"></a>   <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">vdata</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-260"></a><span class="k">    if</span> <span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">vdata</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">npt_new</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-261"></a><span class="k">     deallocate</span> <span class="p">(</span><span class="n">vdata</span><span class="p">,</span> <span class="nb">stat</span><span class="o">=</span><span class="n">deallocstatus</span><span class="p">)</span>
<a name="ln-262"></a>     <span class="k">allocate</span> <span class="p">(</span><span class="n">vdata</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npt_new</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-263"></a>    <span class="k">end if</span>
<a name="ln-264"></a><span class="k">   else</span>
<a name="ln-265"></a><span class="k">    allocate</span> <span class="p">(</span><span class="n">vdata</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npt_new</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">allocstatus</span><span class="p">)</span>
<a name="ln-266"></a>   <span class="k">end if</span>
<a name="ln-267"></a><span class="k">   </span><span class="n">vdata</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-268"></a>  <span class="k">end subroutine</span>
<a name="ln-269"></a>  <span class="c">!===========================</span>
<a name="ln-270"></a> <span class="k">end module</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-01-29 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ALaDyn was developed by The ALaDyn Collaboration</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>